import{c as Q}from"./_commonjsHelpers-de833af9.js";import{_ as he,D as le,z as ce,a9 as de,o as _e,a as ue}from"./index-ab9da3ee.js";var ee={exports:{}};(function(J,Z){(function(K,j){J.exports=j()})(self,function(){return(()=>{var K={4567:(A,i,l)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.AccessibilityManager=void 0;const _=l(9042),v=l(6114),c=l(9924),n=l(3656),f=l(844),d=l(5596),a=l(9631);class e extends f.Disposable{constructor(r,t){super(),this._terminal=r,this._renderService=t,this._liveRegionLineCount=0,this._charsToConsume=[],this._charsToAnnounce="",this._accessibilityTreeRoot=document.createElement("div"),this._accessibilityTreeRoot.classList.add("xterm-accessibility"),this._accessibilityTreeRoot.tabIndex=0,this._rowContainer=document.createElement("div"),this._rowContainer.setAttribute("role","list"),this._rowContainer.classList.add("xterm-accessibility-tree"),this._rowElements=[];for(let o=0;o<this._terminal.rows;o++)this._rowElements[o]=this._createAccessibilityTreeNode(),this._rowContainer.appendChild(this._rowElements[o]);if(this._topBoundaryFocusListener=o=>this._handleBoundaryFocus(o,0),this._bottomBoundaryFocusListener=o=>this._handleBoundaryFocus(o,1),this._rowElements[0].addEventListener("focus",this._topBoundaryFocusListener),this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._refreshRowsDimensions(),this._accessibilityTreeRoot.appendChild(this._rowContainer),this._renderRowsDebouncer=new c.TimeBasedDebouncer(this._renderRows.bind(this)),this._refreshRows(),this._liveRegion=document.createElement("div"),this._liveRegion.classList.add("live-region"),this._liveRegion.setAttribute("aria-live","assertive"),this._accessibilityTreeRoot.appendChild(this._liveRegion),!this._terminal.element)throw new Error("Cannot enable accessibility before Terminal.open");this._terminal.element.insertAdjacentElement("afterbegin",this._accessibilityTreeRoot),this.register(this._renderRowsDebouncer),this.register(this._terminal.onResize(o=>this._handleResize(o.rows))),this.register(this._terminal.onRender(o=>this._refreshRows(o.start,o.end))),this.register(this._terminal.onScroll(()=>this._refreshRows())),this.register(this._terminal.onA11yChar(o=>this._handleChar(o))),this.register(this._terminal.onLineFeed(()=>this._handleChar(`
`))),this.register(this._terminal.onA11yTab(o=>this._handleTab(o))),this.register(this._terminal.onKey(o=>this._handleKey(o.key))),this.register(this._terminal.onBlur(()=>this._clearLiveRegion())),this.register(this._renderService.onDimensionsChange(()=>this._refreshRowsDimensions())),this._screenDprMonitor=new d.ScreenDprMonitor(window),this.register(this._screenDprMonitor),this._screenDprMonitor.setListener(()=>this._refreshRowsDimensions()),this.register((0,n.addDisposableDomListener)(window,"resize",()=>this._refreshRowsDimensions())),this.register((0,f.toDisposable)(()=>{(0,a.removeElementFromParent)(this._accessibilityTreeRoot),this._rowElements.length=0}))}_handleBoundaryFocus(r,t){const o=r.target,u=this._rowElements[t===0?1:this._rowElements.length-2];if(o.getAttribute("aria-posinset")===(t===0?"1":`${this._terminal.buffer.lines.length}`)||r.relatedTarget!==u)return;let g,m;if(t===0?(g=o,m=this._rowElements.pop(),this._rowContainer.removeChild(m)):(g=this._rowElements.shift(),m=o,this._rowContainer.removeChild(g)),g.removeEventListener("focus",this._topBoundaryFocusListener),m.removeEventListener("focus",this._bottomBoundaryFocusListener),t===0){const h=this._createAccessibilityTreeNode();this._rowElements.unshift(h),this._rowContainer.insertAdjacentElement("afterbegin",h)}else{const h=this._createAccessibilityTreeNode();this._rowElements.push(h),this._rowContainer.appendChild(h)}this._rowElements[0].addEventListener("focus",this._topBoundaryFocusListener),this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._terminal.scrollLines(t===0?-1:1),this._rowElements[t===0?1:this._rowElements.length-2].focus(),r.preventDefault(),r.stopImmediatePropagation()}_handleResize(r){this._rowElements[this._rowElements.length-1].removeEventListener("focus",this._bottomBoundaryFocusListener);for(let t=this._rowContainer.children.length;t<this._terminal.rows;t++)this._rowElements[t]=this._createAccessibilityTreeNode(),this._rowContainer.appendChild(this._rowElements[t]);for(;this._rowElements.length>r;)this._rowContainer.removeChild(this._rowElements.pop());this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._refreshRowsDimensions()}_createAccessibilityTreeNode(){const r=document.createElement("div");return r.setAttribute("role","listitem"),r.tabIndex=-1,this._refreshRowDimensions(r),r}_handleTab(r){for(let t=0;t<r;t++)this._handleChar(" ")}_handleChar(r){this._liveRegionLineCount<21&&(this._charsToConsume.length>0?this._charsToConsume.shift()!==r&&(this._charsToAnnounce+=r):this._charsToAnnounce+=r,r===`
`&&(this._liveRegionLineCount++,this._liveRegionLineCount===21&&(this._liveRegion.textContent+=_.tooMuchOutput)),v.isMac&&this._liveRegion.textContent&&this._liveRegion.textContent.length>0&&!this._liveRegion.parentNode&&setTimeout(()=>{this._accessibilityTreeRoot.appendChild(this._liveRegion)},0))}_clearLiveRegion(){this._liveRegion.textContent="",this._liveRegionLineCount=0,v.isMac&&(0,a.removeElementFromParent)(this._liveRegion)}_handleKey(r){this._clearLiveRegion(),/\p{Control}/u.test(r)||this._charsToConsume.push(r)}_refreshRows(r,t){this._renderRowsDebouncer.refresh(r,t,this._terminal.rows)}_renderRows(r,t){const o=this._terminal.buffer,u=o.lines.length.toString();for(let g=r;g<=t;g++){const m=o.translateBufferLineToString(o.ydisp+g,!0),h=(o.ydisp+g+1).toString(),p=this._rowElements[g];p&&(m.length===0?p.innerText="Â ":p.textContent=m,p.setAttribute("aria-posinset",h),p.setAttribute("aria-setsize",u))}this._announceCharacters()}_refreshRowsDimensions(){if(this._renderService.dimensions.css.cell.height){this._accessibilityTreeRoot.style.width=`${this._renderService.dimensions.css.canvas.width}px`,this._rowElements.length!==this._terminal.rows&&this._handleResize(this._terminal.rows);for(let r=0;r<this._terminal.rows;r++)this._refreshRowDimensions(this._rowElements[r])}}_refreshRowDimensions(r){r.style.height=`${this._renderService.dimensions.css.cell.height}px`}_announceCharacters(){this._charsToAnnounce.length!==0&&(this._liveRegion.textContent+=this._charsToAnnounce,this._charsToAnnounce="")}}i.AccessibilityManager=e},3614:(A,i)=>{function l(n){return n.replace(/\r?\n/g,"\r")}function _(n,f){return f?"\x1B[200~"+n+"\x1B[201~":n}function v(n,f,d){n=_(n=l(n),d.decPrivateModes.bracketedPasteMode),d.triggerDataEvent(n,!0),f.value=""}function c(n,f,d){const a=d.getBoundingClientRect(),e=n.clientX-a.left-10,s=n.clientY-a.top-10;f.style.width="20px",f.style.height="20px",f.style.left=`${e}px`,f.style.top=`${s}px`,f.style.zIndex="1000",f.focus()}Object.defineProperty(i,"__esModule",{value:!0}),i.rightClickHandler=i.moveTextAreaUnderMouseCursor=i.paste=i.handlePasteEvent=i.copyHandler=i.bracketTextForPaste=i.prepareTextForTerminal=void 0,i.prepareTextForTerminal=l,i.bracketTextForPaste=_,i.copyHandler=function(n,f){n.clipboardData&&n.clipboardData.setData("text/plain",f.selectionText),n.preventDefault()},i.handlePasteEvent=function(n,f,d){n.stopPropagation(),n.clipboardData&&v(n.clipboardData.getData("text/plain"),f,d)},i.paste=v,i.moveTextAreaUnderMouseCursor=c,i.rightClickHandler=function(n,f,d,a,e){c(n,f,d),e&&a.rightClickSelect(n),f.value=a.selectionText,f.select()}},7239:(A,i,l)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.ColorContrastCache=void 0;const _=l(1505);i.ColorContrastCache=class{constructor(){this._color=new _.TwoKeyMap,this._css=new _.TwoKeyMap}setCss(v,c,n){this._css.set(v,c,n)}getCss(v,c){return this._css.get(v,c)}setColor(v,c,n){this._color.set(v,c,n)}getColor(v,c){return this._color.get(v,c)}clear(){this._color.clear(),this._css.clear()}}},9631:(A,i)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.removeElementFromParent=void 0,i.removeElementFromParent=function(...l){var _;for(const v of l)(_=v==null?void 0:v.parentElement)===null||_===void 0||_.removeChild(v)}},3656:(A,i)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.addDisposableDomListener=void 0,i.addDisposableDomListener=function(l,_,v,c){l.addEventListener(_,v,c);let n=!1;return{dispose:()=>{n||(n=!0,l.removeEventListener(_,v,c))}}}},6465:function(A,i,l){var _=this&&this.__decorate||function(e,s,r,t){var o,u=arguments.length,g=u<3?s:t===null?t=Object.getOwnPropertyDescriptor(s,r):t;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")g=Reflect.decorate(e,s,r,t);else for(var m=e.length-1;m>=0;m--)(o=e[m])&&(g=(u<3?o(g):u>3?o(s,r,g):o(s,r))||g);return u>3&&g&&Object.defineProperty(s,r,g),g},v=this&&this.__param||function(e,s){return function(r,t){s(r,t,e)}};Object.defineProperty(i,"__esModule",{value:!0}),i.Linkifier2=void 0;const c=l(2585),n=l(8460),f=l(844),d=l(3656);let a=class extends f.Disposable{constructor(e){super(),this._bufferService=e,this._linkProviders=[],this._linkCacheDisposables=[],this._isMouseOut=!0,this._activeLine=-1,this._onShowLinkUnderline=this.register(new n.EventEmitter),this.onShowLinkUnderline=this._onShowLinkUnderline.event,this._onHideLinkUnderline=this.register(new n.EventEmitter),this.onHideLinkUnderline=this._onHideLinkUnderline.event,this.register((0,f.getDisposeArrayDisposable)(this._linkCacheDisposables)),this.register((0,f.toDisposable)(()=>{this._lastMouseEvent=void 0}))}get currentLink(){return this._currentLink}registerLinkProvider(e){return this._linkProviders.push(e),{dispose:()=>{const s=this._linkProviders.indexOf(e);s!==-1&&this._linkProviders.splice(s,1)}}}attachToDom(e,s,r){this._element=e,this._mouseService=s,this._renderService=r,this.register((0,d.addDisposableDomListener)(this._element,"mouseleave",()=>{this._isMouseOut=!0,this._clearCurrentLink()})),this.register((0,d.addDisposableDomListener)(this._element,"mousemove",this._handleMouseMove.bind(this))),this.register((0,d.addDisposableDomListener)(this._element,"mousedown",this._handleMouseDown.bind(this))),this.register((0,d.addDisposableDomListener)(this._element,"mouseup",this._handleMouseUp.bind(this)))}_handleMouseMove(e){if(this._lastMouseEvent=e,!this._element||!this._mouseService)return;const s=this._positionFromMouseEvent(e,this._element,this._mouseService);if(!s)return;this._isMouseOut=!1;const r=e.composedPath();for(let t=0;t<r.length;t++){const o=r[t];if(o.classList.contains("xterm"))break;if(o.classList.contains("xterm-hover"))return}this._lastBufferCell&&s.x===this._lastBufferCell.x&&s.y===this._lastBufferCell.y||(this._handleHover(s),this._lastBufferCell=s)}_handleHover(e){if(this._activeLine!==e.y)return this._clearCurrentLink(),void this._askForLink(e,!1);this._currentLink&&this._linkAtPosition(this._currentLink.link,e)||(this._clearCurrentLink(),this._askForLink(e,!0))}_askForLink(e,s){var r,t;this._activeProviderReplies&&s||((r=this._activeProviderReplies)===null||r===void 0||r.forEach(u=>{u==null||u.forEach(g=>{g.link.dispose&&g.link.dispose()})}),this._activeProviderReplies=new Map,this._activeLine=e.y);let o=!1;for(const[u,g]of this._linkProviders.entries())s?!((t=this._activeProviderReplies)===null||t===void 0)&&t.get(u)&&(o=this._checkLinkProviderResult(u,e,o)):g.provideLinks(e.y,m=>{var h,p;if(this._isMouseOut)return;const C=m==null?void 0:m.map(w=>({link:w}));(h=this._activeProviderReplies)===null||h===void 0||h.set(u,C),o=this._checkLinkProviderResult(u,e,o),((p=this._activeProviderReplies)===null||p===void 0?void 0:p.size)===this._linkProviders.length&&this._removeIntersectingLinks(e.y,this._activeProviderReplies)})}_removeIntersectingLinks(e,s){const r=new Set;for(let t=0;t<s.size;t++){const o=s.get(t);if(o)for(let u=0;u<o.length;u++){const g=o[u],m=g.link.range.start.y<e?0:g.link.range.start.x,h=g.link.range.end.y>e?this._bufferService.cols:g.link.range.end.x;for(let p=m;p<=h;p++){if(r.has(p)){o.splice(u--,1);break}r.add(p)}}}}_checkLinkProviderResult(e,s,r){var t;if(!this._activeProviderReplies)return r;const o=this._activeProviderReplies.get(e);let u=!1;for(let g=0;g<e;g++)this._activeProviderReplies.has(g)&&!this._activeProviderReplies.get(g)||(u=!0);if(!u&&o){const g=o.find(m=>this._linkAtPosition(m.link,s));g&&(r=!0,this._handleNewLink(g))}if(this._activeProviderReplies.size===this._linkProviders.length&&!r)for(let g=0;g<this._activeProviderReplies.size;g++){const m=(t=this._activeProviderReplies.get(g))===null||t===void 0?void 0:t.find(h=>this._linkAtPosition(h.link,s));if(m){r=!0,this._handleNewLink(m);break}}return r}_handleMouseDown(){this._mouseDownLink=this._currentLink}_handleMouseUp(e){if(!this._element||!this._mouseService||!this._currentLink)return;const s=this._positionFromMouseEvent(e,this._element,this._mouseService);s&&this._mouseDownLink===this._currentLink&&this._linkAtPosition(this._currentLink.link,s)&&this._currentLink.link.activate(e,this._currentLink.link.text)}_clearCurrentLink(e,s){this._element&&this._currentLink&&this._lastMouseEvent&&(!e||!s||this._currentLink.link.range.start.y>=e&&this._currentLink.link.range.end.y<=s)&&(this._linkLeave(this._element,this._currentLink.link,this._lastMouseEvent),this._currentLink=void 0,(0,f.disposeArray)(this._linkCacheDisposables))}_handleNewLink(e){if(!this._element||!this._lastMouseEvent||!this._mouseService)return;const s=this._positionFromMouseEvent(this._lastMouseEvent,this._element,this._mouseService);s&&this._linkAtPosition(e.link,s)&&(this._currentLink=e,this._currentLink.state={decorations:{underline:e.link.decorations===void 0||e.link.decorations.underline,pointerCursor:e.link.decorations===void 0||e.link.decorations.pointerCursor},isHovered:!0},this._linkHover(this._element,e.link,this._lastMouseEvent),e.link.decorations={},Object.defineProperties(e.link.decorations,{pointerCursor:{get:()=>{var r,t;return(t=(r=this._currentLink)===null||r===void 0?void 0:r.state)===null||t===void 0?void 0:t.decorations.pointerCursor},set:r=>{var t,o;!((t=this._currentLink)===null||t===void 0)&&t.state&&this._currentLink.state.decorations.pointerCursor!==r&&(this._currentLink.state.decorations.pointerCursor=r,this._currentLink.state.isHovered&&((o=this._element)===null||o===void 0||o.classList.toggle("xterm-cursor-pointer",r)))}},underline:{get:()=>{var r,t;return(t=(r=this._currentLink)===null||r===void 0?void 0:r.state)===null||t===void 0?void 0:t.decorations.underline},set:r=>{var t,o,u;!((t=this._currentLink)===null||t===void 0)&&t.state&&((u=(o=this._currentLink)===null||o===void 0?void 0:o.state)===null||u===void 0?void 0:u.decorations.underline)!==r&&(this._currentLink.state.decorations.underline=r,this._currentLink.state.isHovered&&this._fireUnderlineEvent(e.link,r))}}}),this._renderService&&this._linkCacheDisposables.push(this._renderService.onRenderedViewportChange(r=>{const t=r.start===0?0:r.start+1+this._bufferService.buffer.ydisp,o=this._currentLink?this._lastMouseEvent:void 0;if(this._clearCurrentLink(t,r.end+1+this._bufferService.buffer.ydisp),o&&this._element){const u=this._positionFromMouseEvent(o,this._element,this._mouseService);u&&this._askForLink(u,!1)}})))}_linkHover(e,s,r){var t;!((t=this._currentLink)===null||t===void 0)&&t.state&&(this._currentLink.state.isHovered=!0,this._currentLink.state.decorations.underline&&this._fireUnderlineEvent(s,!0),this._currentLink.state.decorations.pointerCursor&&e.classList.add("xterm-cursor-pointer")),s.hover&&s.hover(r,s.text)}_fireUnderlineEvent(e,s){const r=e.range,t=this._bufferService.buffer.ydisp,o=this._createLinkUnderlineEvent(r.start.x-1,r.start.y-t-1,r.end.x,r.end.y-t-1,void 0);(s?this._onShowLinkUnderline:this._onHideLinkUnderline).fire(o)}_linkLeave(e,s,r){var t;!((t=this._currentLink)===null||t===void 0)&&t.state&&(this._currentLink.state.isHovered=!1,this._currentLink.state.decorations.underline&&this._fireUnderlineEvent(s,!1),this._currentLink.state.decorations.pointerCursor&&e.classList.remove("xterm-cursor-pointer")),s.leave&&s.leave(r,s.text)}_linkAtPosition(e,s){const r=e.range.start.y*this._bufferService.cols+e.range.start.x,t=e.range.end.y*this._bufferService.cols+e.range.end.x,o=s.y*this._bufferService.cols+s.x;return r<=o&&o<=t}_positionFromMouseEvent(e,s,r){const t=r.getCoords(e,s,this._bufferService.cols,this._bufferService.rows);if(t)return{x:t[0],y:t[1]+this._bufferService.buffer.ydisp}}_createLinkUnderlineEvent(e,s,r,t,o){return{x1:e,y1:s,x2:r,y2:t,cols:this._bufferService.cols,fg:o}}};a=_([v(0,c.IBufferService)],a),i.Linkifier2=a},9042:(A,i)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.tooMuchOutput=i.promptLabel=void 0,i.promptLabel="Terminal input",i.tooMuchOutput="Too much output to announce, navigate to rows manually to read"},3730:function(A,i,l){var _=this&&this.__decorate||function(a,e,s,r){var t,o=arguments.length,u=o<3?e:r===null?r=Object.getOwnPropertyDescriptor(e,s):r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")u=Reflect.decorate(a,e,s,r);else for(var g=a.length-1;g>=0;g--)(t=a[g])&&(u=(o<3?t(u):o>3?t(e,s,u):t(e,s))||u);return o>3&&u&&Object.defineProperty(e,s,u),u},v=this&&this.__param||function(a,e){return function(s,r){e(s,r,a)}};Object.defineProperty(i,"__esModule",{value:!0}),i.OscLinkProvider=void 0;const c=l(511),n=l(2585);let f=class{constructor(a,e,s){this._bufferService=a,this._optionsService=e,this._oscLinkService=s}provideLinks(a,e){var s;const r=this._bufferService.buffer.lines.get(a-1);if(!r)return void e(void 0);const t=[],o=this._optionsService.rawOptions.linkHandler,u=new c.CellData,g=r.getTrimmedLength();let m=-1,h=-1,p=!1;for(let C=0;C<g;C++)if(h!==-1||r.hasContent(C)){if(r.loadCell(C,u),u.hasExtendedAttrs()&&u.extended.urlId){if(h===-1){h=C,m=u.extended.urlId;continue}p=u.extended.urlId!==m}else h!==-1&&(p=!0);if(p||h!==-1&&C===g-1){const w=(s=this._oscLinkService.getLinkData(m))===null||s===void 0?void 0:s.uri;if(w){const y={start:{x:h+1,y:a},end:{x:C+(p||C!==g-1?0:1),y:a}};let D=!1;if(!(o!=null&&o.allowNonHttpProtocols))try{const B=new URL(w);["http:","https:"].includes(B.protocol)||(D=!0)}catch{D=!0}D||t.push({text:w,range:y,activate:(B,I)=>o?o.activate(B,I,y):d(0,I),hover:(B,I)=>{var H;return(H=o==null?void 0:o.hover)===null||H===void 0?void 0:H.call(o,B,I,y)},leave:(B,I)=>{var H;return(H=o==null?void 0:o.leave)===null||H===void 0?void 0:H.call(o,B,I,y)}})}p=!1,u.hasExtendedAttrs()&&u.extended.urlId?(h=C,m=u.extended.urlId):(h=-1,m=-1)}}e(t)}};function d(a,e){if(confirm(`Do you want to navigate to ${e}?

WARNING: This link could potentially be dangerous`)){const s=window.open();if(s){try{s.opener=null}catch{}s.location.href=e}else console.warn("Opening link blocked as opener could not be cleared")}}f=_([v(0,n.IBufferService),v(1,n.IOptionsService),v(2,n.IOscLinkService)],f),i.OscLinkProvider=f},6193:(A,i)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.RenderDebouncer=void 0,i.RenderDebouncer=class{constructor(l,_){this._parentWindow=l,this._renderCallback=_,this._refreshCallbacks=[]}dispose(){this._animationFrame&&(this._parentWindow.cancelAnimationFrame(this._animationFrame),this._animationFrame=void 0)}addRefreshCallback(l){return this._refreshCallbacks.push(l),this._animationFrame||(this._animationFrame=this._parentWindow.requestAnimationFrame(()=>this._innerRefresh())),this._animationFrame}refresh(l,_,v){this._rowCount=v,l=l!==void 0?l:0,_=_!==void 0?_:this._rowCount-1,this._rowStart=this._rowStart!==void 0?Math.min(this._rowStart,l):l,this._rowEnd=this._rowEnd!==void 0?Math.max(this._rowEnd,_):_,this._animationFrame||(this._animationFrame=this._parentWindow.requestAnimationFrame(()=>this._innerRefresh()))}_innerRefresh(){if(this._animationFrame=void 0,this._rowStart===void 0||this._rowEnd===void 0||this._rowCount===void 0)return void this._runRefreshCallbacks();const l=Math.max(this._rowStart,0),_=Math.min(this._rowEnd,this._rowCount-1);this._rowStart=void 0,this._rowEnd=void 0,this._renderCallback(l,_),this._runRefreshCallbacks()}_runRefreshCallbacks(){for(const l of this._refreshCallbacks)l(0);this._refreshCallbacks=[]}}},5596:(A,i,l)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.ScreenDprMonitor=void 0;const _=l(844);class v extends _.Disposable{constructor(n){super(),this._parentWindow=n,this._currentDevicePixelRatio=this._parentWindow.devicePixelRatio,this.register((0,_.toDisposable)(()=>{this.clearListener()}))}setListener(n){this._listener&&this.clearListener(),this._listener=n,this._outerListener=()=>{this._listener&&(this._listener(this._parentWindow.devicePixelRatio,this._currentDevicePixelRatio),this._updateDpr())},this._updateDpr()}_updateDpr(){var n;this._outerListener&&((n=this._resolutionMediaMatchList)===null||n===void 0||n.removeListener(this._outerListener),this._currentDevicePixelRatio=this._parentWindow.devicePixelRatio,this._resolutionMediaMatchList=this._parentWindow.matchMedia(`screen and (resolution: ${this._parentWindow.devicePixelRatio}dppx)`),this._resolutionMediaMatchList.addListener(this._outerListener))}clearListener(){this._resolutionMediaMatchList&&this._listener&&this._outerListener&&(this._resolutionMediaMatchList.removeListener(this._outerListener),this._resolutionMediaMatchList=void 0,this._listener=void 0,this._outerListener=void 0)}}i.ScreenDprMonitor=v},3236:(A,i,l)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.Terminal=void 0;const _=l(2950),v=l(1680),c=l(3614),n=l(2584),f=l(5435),d=l(9312),a=l(6114),e=l(3656),s=l(9042),r=l(4567),t=l(1296),o=l(7399),u=l(8460),g=l(8437),m=l(3230),h=l(4725),p=l(428),C=l(8934),w=l(6465),y=l(5114),D=l(8969),B=l(8055),I=l(4269),H=l(5941),S=l(3107),b=l(5744),L=l(9074),R=l(2585),M=l(3730),F=l(844),N=l(6731),O=typeof window<"u"?window.document:null;class W extends D.CoreTerminal{constructor(E={}){super(E),this.browser=a,this._keyDownHandled=!1,this._keyDownSeen=!1,this._keyPressHandled=!1,this._unprocessedDeadKey=!1,this._onCursorMove=this.register(new u.EventEmitter),this.onCursorMove=this._onCursorMove.event,this._onKey=this.register(new u.EventEmitter),this.onKey=this._onKey.event,this._onRender=this.register(new u.EventEmitter),this.onRender=this._onRender.event,this._onSelectionChange=this.register(new u.EventEmitter),this.onSelectionChange=this._onSelectionChange.event,this._onTitleChange=this.register(new u.EventEmitter),this.onTitleChange=this._onTitleChange.event,this._onBell=this.register(new u.EventEmitter),this.onBell=this._onBell.event,this._onFocus=this.register(new u.EventEmitter),this._onBlur=this.register(new u.EventEmitter),this._onA11yCharEmitter=this.register(new u.EventEmitter),this._onA11yTabEmitter=this.register(new u.EventEmitter),this._onWillOpen=this.register(new u.EventEmitter),this._setup(),this.linkifier2=this.register(this._instantiationService.createInstance(w.Linkifier2)),this.linkifier2.registerLinkProvider(this._instantiationService.createInstance(M.OscLinkProvider)),this._decorationService=this._instantiationService.createInstance(L.DecorationService),this._instantiationService.setService(R.IDecorationService,this._decorationService),this.register(this._inputHandler.onRequestBell(()=>this._onBell.fire())),this.register(this._inputHandler.onRequestRefreshRows((x,T)=>this.refresh(x,T))),this.register(this._inputHandler.onRequestSendFocus(()=>this._reportFocus())),this.register(this._inputHandler.onRequestReset(()=>this.reset())),this.register(this._inputHandler.onRequestWindowsOptionsReport(x=>this._reportWindowsOptions(x))),this.register(this._inputHandler.onColor(x=>this._handleColorEvent(x))),this.register((0,u.forwardEvent)(this._inputHandler.onCursorMove,this._onCursorMove)),this.register((0,u.forwardEvent)(this._inputHandler.onTitleChange,this._onTitleChange)),this.register((0,u.forwardEvent)(this._inputHandler.onA11yChar,this._onA11yCharEmitter)),this.register((0,u.forwardEvent)(this._inputHandler.onA11yTab,this._onA11yTabEmitter)),this.register(this._bufferService.onResize(x=>this._afterResize(x.cols,x.rows))),this.register((0,F.toDisposable)(()=>{var x,T;this._customKeyEventHandler=void 0,(T=(x=this.element)===null||x===void 0?void 0:x.parentNode)===null||T===void 0||T.removeChild(this.element)}))}get onFocus(){return this._onFocus.event}get onBlur(){return this._onBlur.event}get onA11yChar(){return this._onA11yCharEmitter.event}get onA11yTab(){return this._onA11yTabEmitter.event}get onWillOpen(){return this._onWillOpen.event}_handleColorEvent(E){if(this._themeService)for(const x of E){let T,P="";switch(x.index){case 256:T="foreground",P="10";break;case 257:T="background",P="11";break;case 258:T="cursor",P="12";break;default:T="ansi",P="4;"+x.index}switch(x.type){case 0:const V=B.color.toColorRGB(T==="ansi"?this._themeService.colors.ansi[x.index]:this._themeService.colors[T]);this.coreService.triggerDataEvent(`${n.C0.ESC}]${P};${(0,H.toRgbString)(V)}${n.C1_ESCAPED.ST}`);break;case 1:if(T==="ansi")this._themeService.modifyColors(U=>U.ansi[x.index]=B.rgba.toColor(...x.color));else{const U=T;this._themeService.modifyColors(G=>G[U]=B.rgba.toColor(...x.color))}break;case 2:this._themeService.restoreColor(x.index)}}}_setup(){super._setup(),this._customKeyEventHandler=void 0}get buffer(){return this.buffers.active}focus(){this.textarea&&this.textarea.focus({preventScroll:!0})}_handleScreenReaderModeOptionChange(E){var x;E?!this._accessibilityManager&&this._renderService&&(this._accessibilityManager=new r.AccessibilityManager(this,this._renderService)):((x=this._accessibilityManager)===null||x===void 0||x.dispose(),this._accessibilityManager=void 0)}_handleTextAreaFocus(E){this.coreService.decPrivateModes.sendFocus&&this.coreService.triggerDataEvent(n.C0.ESC+"[I"),this.updateCursorStyle(E),this.element.classList.add("focus"),this._showCursor(),this._onFocus.fire()}blur(){var E;return(E=this.textarea)===null||E===void 0?void 0:E.blur()}_handleTextAreaBlur(){this.textarea.value="",this.refresh(this.buffer.y,this.buffer.y),this.coreService.decPrivateModes.sendFocus&&this.coreService.triggerDataEvent(n.C0.ESC+"[O"),this.element.classList.remove("focus"),this._onBlur.fire()}_syncTextArea(){if(!this.textarea||!this.buffer.isCursorInViewport||this._compositionHelper.isComposing||!this._renderService)return;const E=this.buffer.ybase+this.buffer.y,x=this.buffer.lines.get(E);if(!x)return;const T=Math.min(this.buffer.x,this.cols-1),P=this._renderService.dimensions.css.cell.height,V=x.getWidth(T),U=this._renderService.dimensions.css.cell.width*V,G=this.buffer.y*this._renderService.dimensions.css.cell.height,Y=T*this._renderService.dimensions.css.cell.width;this.textarea.style.left=Y+"px",this.textarea.style.top=G+"px",this.textarea.style.width=U+"px",this.textarea.style.height=P+"px",this.textarea.style.lineHeight=P+"px",this.textarea.style.zIndex="-5"}_initGlobal(){this._bindKeys(),this.register((0,e.addDisposableDomListener)(this.element,"copy",x=>{this.hasSelection()&&(0,c.copyHandler)(x,this._selectionService)}));const E=x=>(0,c.handlePasteEvent)(x,this.textarea,this.coreService);this.register((0,e.addDisposableDomListener)(this.textarea,"paste",E)),this.register((0,e.addDisposableDomListener)(this.element,"paste",E)),a.isFirefox?this.register((0,e.addDisposableDomListener)(this.element,"mousedown",x=>{x.button===2&&(0,c.rightClickHandler)(x,this.textarea,this.screenElement,this._selectionService,this.options.rightClickSelectsWord)})):this.register((0,e.addDisposableDomListener)(this.element,"contextmenu",x=>{(0,c.rightClickHandler)(x,this.textarea,this.screenElement,this._selectionService,this.options.rightClickSelectsWord)})),a.isLinux&&this.register((0,e.addDisposableDomListener)(this.element,"auxclick",x=>{x.button===1&&(0,c.moveTextAreaUnderMouseCursor)(x,this.textarea,this.screenElement)}))}_bindKeys(){this.register((0,e.addDisposableDomListener)(this.textarea,"keyup",E=>this._keyUp(E),!0)),this.register((0,e.addDisposableDomListener)(this.textarea,"keydown",E=>this._keyDown(E),!0)),this.register((0,e.addDisposableDomListener)(this.textarea,"keypress",E=>this._keyPress(E),!0)),this.register((0,e.addDisposableDomListener)(this.textarea,"compositionstart",()=>this._compositionHelper.compositionstart())),this.register((0,e.addDisposableDomListener)(this.textarea,"compositionupdate",E=>this._compositionHelper.compositionupdate(E))),this.register((0,e.addDisposableDomListener)(this.textarea,"compositionend",()=>this._compositionHelper.compositionend())),this.register((0,e.addDisposableDomListener)(this.textarea,"input",E=>this._inputEvent(E),!0)),this.register(this.onRender(()=>this._compositionHelper.updateCompositionElements()))}open(E){var x;if(!E)throw new Error("Terminal requires a parent element.");E.isConnected||this._logService.debug("Terminal.open was called on an element that was not attached to the DOM"),this._document=E.ownerDocument,this.element=this._document.createElement("div"),this.element.dir="ltr",this.element.classList.add("terminal"),this.element.classList.add("xterm"),this.element.setAttribute("tabindex","0"),E.appendChild(this.element);const T=O.createDocumentFragment();this._viewportElement=O.createElement("div"),this._viewportElement.classList.add("xterm-viewport"),T.appendChild(this._viewportElement),this._viewportScrollArea=O.createElement("div"),this._viewportScrollArea.classList.add("xterm-scroll-area"),this._viewportElement.appendChild(this._viewportScrollArea),this.screenElement=O.createElement("div"),this.screenElement.classList.add("xterm-screen"),this._helperContainer=O.createElement("div"),this._helperContainer.classList.add("xterm-helpers"),this.screenElement.appendChild(this._helperContainer),T.appendChild(this.screenElement),this.textarea=O.createElement("textarea"),this.textarea.classList.add("xterm-helper-textarea"),this.textarea.setAttribute("aria-label",s.promptLabel),a.isChromeOS||this.textarea.setAttribute("aria-multiline","false"),this.textarea.setAttribute("autocorrect","off"),this.textarea.setAttribute("autocapitalize","off"),this.textarea.setAttribute("spellcheck","false"),this.textarea.tabIndex=0,this._coreBrowserService=this._instantiationService.createInstance(y.CoreBrowserService,this.textarea,(x=this._document.defaultView)!==null&&x!==void 0?x:window),this._instantiationService.setService(h.ICoreBrowserService,this._coreBrowserService),this.register((0,e.addDisposableDomListener)(this.textarea,"focus",P=>this._handleTextAreaFocus(P))),this.register((0,e.addDisposableDomListener)(this.textarea,"blur",()=>this._handleTextAreaBlur())),this._helperContainer.appendChild(this.textarea),this._charSizeService=this._instantiationService.createInstance(p.CharSizeService,this._document,this._helperContainer),this._instantiationService.setService(h.ICharSizeService,this._charSizeService),this._themeService=this._instantiationService.createInstance(N.ThemeService),this._instantiationService.setService(h.IThemeService,this._themeService),this._characterJoinerService=this._instantiationService.createInstance(I.CharacterJoinerService),this._instantiationService.setService(h.ICharacterJoinerService,this._characterJoinerService),this._renderService=this.register(this._instantiationService.createInstance(m.RenderService,this.rows,this.screenElement)),this._instantiationService.setService(h.IRenderService,this._renderService),this.register(this._renderService.onRenderedViewportChange(P=>this._onRender.fire(P))),this.onResize(P=>this._renderService.resize(P.cols,P.rows)),this._compositionView=O.createElement("div"),this._compositionView.classList.add("composition-view"),this._compositionHelper=this._instantiationService.createInstance(_.CompositionHelper,this.textarea,this._compositionView),this._helperContainer.appendChild(this._compositionView),this.element.appendChild(T);try{this._onWillOpen.fire(this.element)}catch{}this._renderService.hasRenderer()||this._renderService.setRenderer(this._createRenderer()),this._mouseService=this._instantiationService.createInstance(C.MouseService),this._instantiationService.setService(h.IMouseService,this._mouseService),this.viewport=this._instantiationService.createInstance(v.Viewport,P=>this.scrollLines(P,!0,1),this._viewportElement,this._viewportScrollArea),this.register(this._inputHandler.onRequestSyncScrollBar(()=>this.viewport.syncScrollArea())),this.register(this.viewport),this.register(this.onCursorMove(()=>{this._renderService.handleCursorMove(),this._syncTextArea()})),this.register(this.onResize(()=>this._renderService.handleResize(this.cols,this.rows))),this.register(this.onBlur(()=>this._renderService.handleBlur())),this.register(this.onFocus(()=>this._renderService.handleFocus())),this.register(this._renderService.onDimensionsChange(()=>this.viewport.syncScrollArea())),this._selectionService=this.register(this._instantiationService.createInstance(d.SelectionService,this.element,this.screenElement,this.linkifier2)),this._instantiationService.setService(h.ISelectionService,this._selectionService),this.register(this._selectionService.onRequestScrollLines(P=>this.scrollLines(P.amount,P.suppressScrollEvent))),this.register(this._selectionService.onSelectionChange(()=>this._onSelectionChange.fire())),this.register(this._selectionService.onRequestRedraw(P=>this._renderService.handleSelectionChanged(P.start,P.end,P.columnSelectMode))),this.register(this._selectionService.onLinuxMouseSelection(P=>{this.textarea.value=P,this.textarea.focus(),this.textarea.select()})),this.register(this._onScroll.event(P=>{this.viewport.syncScrollArea(),this._selectionService.refresh()})),this.register((0,e.addDisposableDomListener)(this._viewportElement,"scroll",()=>this._selectionService.refresh())),this.linkifier2.attachToDom(this.screenElement,this._mouseService,this._renderService),this.register(this._instantiationService.createInstance(S.BufferDecorationRenderer,this.screenElement)),this.register((0,e.addDisposableDomListener)(this.element,"mousedown",P=>this._selectionService.handleMouseDown(P))),this.coreMouseService.areMouseEventsActive?(this._selectionService.disable(),this.element.classList.add("enable-mouse-events")):this._selectionService.enable(),this.options.screenReaderMode&&(this._accessibilityManager=new r.AccessibilityManager(this,this._renderService)),this.register(this.optionsService.onSpecificOptionChange("screenReaderMode",P=>this._handleScreenReaderModeOptionChange(P))),this.options.overviewRulerWidth&&(this._overviewRulerRenderer=this.register(this._instantiationService.createInstance(b.OverviewRulerRenderer,this._viewportElement,this.screenElement))),this.optionsService.onSpecificOptionChange("overviewRulerWidth",P=>{!this._overviewRulerRenderer&&P&&this._viewportElement&&this.screenElement&&(this._overviewRulerRenderer=this.register(this._instantiationService.createInstance(b.OverviewRulerRenderer,this._viewportElement,this.screenElement)))}),this._charSizeService.measure(),this.refresh(0,this.rows-1),this._initGlobal(),this.bindMouse()}_createRenderer(){return this._instantiationService.createInstance(t.DomRenderer,this.element,this.screenElement,this._viewportElement,this.linkifier2)}bindMouse(){const E=this,x=this.element;function T(U){const G=E._mouseService.getMouseReportCoords(U,E.screenElement);if(!G)return!1;let Y,X;switch(U.overrideType||U.type){case"mousemove":X=32,U.buttons===void 0?(Y=3,U.button!==void 0&&(Y=U.button<3?U.button:3)):Y=1&U.buttons?0:4&U.buttons?1:2&U.buttons?2:3;break;case"mouseup":X=0,Y=U.button<3?U.button:3;break;case"mousedown":X=1,Y=U.button<3?U.button:3;break;case"wheel":if(E.viewport.getLinesScrolled(U)===0)return!1;X=U.deltaY<0?0:1,Y=4;break;default:return!1}return!(X===void 0||Y===void 0||Y>4)&&E.coreMouseService.triggerMouseEvent({col:G.col,row:G.row,x:G.x,y:G.y,button:Y,action:X,ctrl:U.ctrlKey,alt:U.altKey,shift:U.shiftKey})}const P={mouseup:null,wheel:null,mousedrag:null,mousemove:null},V={mouseup:U=>(T(U),U.buttons||(this._document.removeEventListener("mouseup",P.mouseup),P.mousedrag&&this._document.removeEventListener("mousemove",P.mousedrag)),this.cancel(U)),wheel:U=>(T(U),this.cancel(U,!0)),mousedrag:U=>{U.buttons&&T(U)},mousemove:U=>{U.buttons||T(U)}};this.register(this.coreMouseService.onProtocolChange(U=>{U?(this.optionsService.rawOptions.logLevel==="debug"&&this._logService.debug("Binding to mouse events:",this.coreMouseService.explainEvents(U)),this.element.classList.add("enable-mouse-events"),this._selectionService.disable()):(this._logService.debug("Unbinding from mouse events."),this.element.classList.remove("enable-mouse-events"),this._selectionService.enable()),8&U?P.mousemove||(x.addEventListener("mousemove",V.mousemove),P.mousemove=V.mousemove):(x.removeEventListener("mousemove",P.mousemove),P.mousemove=null),16&U?P.wheel||(x.addEventListener("wheel",V.wheel,{passive:!1}),P.wheel=V.wheel):(x.removeEventListener("wheel",P.wheel),P.wheel=null),2&U?P.mouseup||(P.mouseup=V.mouseup):(this._document.removeEventListener("mouseup",P.mouseup),P.mouseup=null),4&U?P.mousedrag||(P.mousedrag=V.mousedrag):(this._document.removeEventListener("mousemove",P.mousedrag),P.mousedrag=null)})),this.coreMouseService.activeProtocol=this.coreMouseService.activeProtocol,this.register((0,e.addDisposableDomListener)(x,"mousedown",U=>{if(U.preventDefault(),this.focus(),this.coreMouseService.areMouseEventsActive&&!this._selectionService.shouldForceSelection(U))return T(U),P.mouseup&&this._document.addEventListener("mouseup",P.mouseup),P.mousedrag&&this._document.addEventListener("mousemove",P.mousedrag),this.cancel(U)})),this.register((0,e.addDisposableDomListener)(x,"wheel",U=>{if(!P.wheel){if(!this.buffer.hasScrollback){const G=this.viewport.getLinesScrolled(U);if(G===0)return;const Y=n.C0.ESC+(this.coreService.decPrivateModes.applicationCursorKeys?"O":"[")+(U.deltaY<0?"A":"B");let X="";for(let q=0;q<Math.abs(G);q++)X+=Y;return this.coreService.triggerDataEvent(X,!0),this.cancel(U,!0)}return this.viewport.handleWheel(U)?this.cancel(U):void 0}},{passive:!1})),this.register((0,e.addDisposableDomListener)(x,"touchstart",U=>{if(!this.coreMouseService.areMouseEventsActive)return this.viewport.handleTouchStart(U),this.cancel(U)},{passive:!0})),this.register((0,e.addDisposableDomListener)(x,"touchmove",U=>{if(!this.coreMouseService.areMouseEventsActive)return this.viewport.handleTouchMove(U)?void 0:this.cancel(U)},{passive:!1}))}refresh(E,x){var T;(T=this._renderService)===null||T===void 0||T.refreshRows(E,x)}updateCursorStyle(E){var x;!((x=this._selectionService)===null||x===void 0)&&x.shouldColumnSelect(E)?this.element.classList.add("column-select"):this.element.classList.remove("column-select")}_showCursor(){this.coreService.isCursorInitialized||(this.coreService.isCursorInitialized=!0,this.refresh(this.buffer.y,this.buffer.y))}scrollLines(E,x,T=0){super.scrollLines(E,x,T),this.refresh(0,this.rows-1)}paste(E){(0,c.paste)(E,this.textarea,this.coreService)}attachCustomKeyEventHandler(E){this._customKeyEventHandler=E}registerLinkProvider(E){return this.linkifier2.registerLinkProvider(E)}registerCharacterJoiner(E){if(!this._characterJoinerService)throw new Error("Terminal must be opened first");const x=this._characterJoinerService.register(E);return this.refresh(0,this.rows-1),x}deregisterCharacterJoiner(E){if(!this._characterJoinerService)throw new Error("Terminal must be opened first");this._characterJoinerService.deregister(E)&&this.refresh(0,this.rows-1)}get markers(){return this.buffer.markers}addMarker(E){return this.buffer.addMarker(this.buffer.ybase+this.buffer.y+E)}registerDecoration(E){return this._decorationService.registerDecoration(E)}hasSelection(){return!!this._selectionService&&this._selectionService.hasSelection}select(E,x,T){this._selectionService.setSelection(E,x,T)}getSelection(){return this._selectionService?this._selectionService.selectionText:""}getSelectionPosition(){if(this._selectionService&&this._selectionService.hasSelection)return{start:{x:this._selectionService.selectionStart[0],y:this._selectionService.selectionStart[1]},end:{x:this._selectionService.selectionEnd[0],y:this._selectionService.selectionEnd[1]}}}clearSelection(){var E;(E=this._selectionService)===null||E===void 0||E.clearSelection()}selectAll(){var E;(E=this._selectionService)===null||E===void 0||E.selectAll()}selectLines(E,x){var T;(T=this._selectionService)===null||T===void 0||T.selectLines(E,x)}_keyDown(E){if(this._keyDownHandled=!1,this._keyDownSeen=!0,this._customKeyEventHandler&&this._customKeyEventHandler(E)===!1)return!1;const x=this.browser.isMac&&this.options.macOptionIsMeta&&E.altKey;if(!x&&!this._compositionHelper.keydown(E))return this.options.scrollOnUserInput&&this.buffer.ybase!==this.buffer.ydisp&&this._bufferService.scrollToBottom(),!1;x||E.key!=="Dead"&&E.key!=="AltGraph"||(this._unprocessedDeadKey=!0);const T=(0,o.evaluateKeyboardEvent)(E,this.coreService.decPrivateModes.applicationCursorKeys,this.browser.isMac,this.options.macOptionIsMeta);if(this.updateCursorStyle(E),T.type===3||T.type===2){const P=this.rows-1;return this.scrollLines(T.type===2?-P:P),this.cancel(E,!0)}return T.type===1&&this.selectAll(),!!this._isThirdLevelShift(this.browser,E)||(T.cancel&&this.cancel(E,!0),!T.key||!!(E.key&&!E.ctrlKey&&!E.altKey&&!E.metaKey&&E.key.length===1&&E.key.charCodeAt(0)>=65&&E.key.charCodeAt(0)<=90)||(this._unprocessedDeadKey?(this._unprocessedDeadKey=!1,!0):(T.key!==n.C0.ETX&&T.key!==n.C0.CR||(this.textarea.value=""),this._onKey.fire({key:T.key,domEvent:E}),this._showCursor(),this.coreService.triggerDataEvent(T.key,!0),!this.optionsService.rawOptions.screenReaderMode||E.altKey||E.ctrlKey?this.cancel(E,!0):void(this._keyDownHandled=!0))))}_isThirdLevelShift(E,x){const T=E.isMac&&!this.options.macOptionIsMeta&&x.altKey&&!x.ctrlKey&&!x.metaKey||E.isWindows&&x.altKey&&x.ctrlKey&&!x.metaKey||E.isWindows&&x.getModifierState("AltGraph");return x.type==="keypress"?T:T&&(!x.keyCode||x.keyCode>47)}_keyUp(E){this._keyDownSeen=!1,this._customKeyEventHandler&&this._customKeyEventHandler(E)===!1||(function(x){return x.keyCode===16||x.keyCode===17||x.keyCode===18}(E)||this.focus(),this.updateCursorStyle(E),this._keyPressHandled=!1)}_keyPress(E){let x;if(this._keyPressHandled=!1,this._keyDownHandled||this._customKeyEventHandler&&this._customKeyEventHandler(E)===!1)return!1;if(this.cancel(E),E.charCode)x=E.charCode;else if(E.which===null||E.which===void 0)x=E.keyCode;else{if(E.which===0||E.charCode===0)return!1;x=E.which}return!(!x||(E.altKey||E.ctrlKey||E.metaKey)&&!this._isThirdLevelShift(this.browser,E)||(x=String.fromCharCode(x),this._onKey.fire({key:x,domEvent:E}),this._showCursor(),this.coreService.triggerDataEvent(x,!0),this._keyPressHandled=!0,this._unprocessedDeadKey=!1,0))}_inputEvent(E){if(E.data&&E.inputType==="insertText"&&(!E.composed||!this._keyDownSeen)&&!this.optionsService.rawOptions.screenReaderMode){if(this._keyPressHandled)return!1;this._unprocessedDeadKey=!1;const x=E.data;return this.coreService.triggerDataEvent(x,!0),this.cancel(E),!0}return!1}resize(E,x){E!==this.cols||x!==this.rows?super.resize(E,x):this._charSizeService&&!this._charSizeService.hasValidSize&&this._charSizeService.measure()}_afterResize(E,x){var T,P;(T=this._charSizeService)===null||T===void 0||T.measure(),(P=this.viewport)===null||P===void 0||P.syncScrollArea(!0)}clear(){if(this.buffer.ybase!==0||this.buffer.y!==0){this.buffer.clearAllMarkers(),this.buffer.lines.set(0,this.buffer.lines.get(this.buffer.ybase+this.buffer.y)),this.buffer.lines.length=1,this.buffer.ydisp=0,this.buffer.ybase=0,this.buffer.y=0;for(let E=1;E<this.rows;E++)this.buffer.lines.push(this.buffer.getBlankLine(g.DEFAULT_ATTR_DATA));this.refresh(0,this.rows-1),this._onScroll.fire({position:this.buffer.ydisp,source:0})}}reset(){var E,x;this.options.rows=this.rows,this.options.cols=this.cols;const T=this._customKeyEventHandler;this._setup(),super.reset(),(E=this._selectionService)===null||E===void 0||E.reset(),this._decorationService.reset(),this._customKeyEventHandler=T,this.refresh(0,this.rows-1),(x=this.viewport)===null||x===void 0||x.syncScrollArea()}clearTextureAtlas(){var E;(E=this._renderService)===null||E===void 0||E.clearTextureAtlas()}_reportFocus(){var E;!((E=this.element)===null||E===void 0)&&E.classList.contains("focus")?this.coreService.triggerDataEvent(n.C0.ESC+"[I"):this.coreService.triggerDataEvent(n.C0.ESC+"[O")}_reportWindowsOptions(E){if(this._renderService)switch(E){case f.WindowsOptionsReportType.GET_WIN_SIZE_PIXELS:const x=this._renderService.dimensions.css.canvas.width.toFixed(0),T=this._renderService.dimensions.css.canvas.height.toFixed(0);this.coreService.triggerDataEvent(`${n.C0.ESC}[4;${T};${x}t`);break;case f.WindowsOptionsReportType.GET_CELL_SIZE_PIXELS:const P=this._renderService.dimensions.css.cell.width.toFixed(0),V=this._renderService.dimensions.css.cell.height.toFixed(0);this.coreService.triggerDataEvent(`${n.C0.ESC}[6;${V};${P}t`)}}cancel(E,x){if(this.options.cancelEvents||x)return E.preventDefault(),E.stopPropagation(),!1}}i.Terminal=W},9924:(A,i)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.TimeBasedDebouncer=void 0,i.TimeBasedDebouncer=class{constructor(l,_=1e3){this._renderCallback=l,this._debounceThresholdMS=_,this._lastRefreshMs=0,this._additionalRefreshRequested=!1}dispose(){this._refreshTimeoutID&&clearTimeout(this._refreshTimeoutID)}refresh(l,_,v){this._rowCount=v,l=l!==void 0?l:0,_=_!==void 0?_:this._rowCount-1,this._rowStart=this._rowStart!==void 0?Math.min(this._rowStart,l):l,this._rowEnd=this._rowEnd!==void 0?Math.max(this._rowEnd,_):_;const c=Date.now();if(c-this._lastRefreshMs>=this._debounceThresholdMS)this._lastRefreshMs=c,this._innerRefresh();else if(!this._additionalRefreshRequested){const n=c-this._lastRefreshMs,f=this._debounceThresholdMS-n;this._additionalRefreshRequested=!0,this._refreshTimeoutID=window.setTimeout(()=>{this._lastRefreshMs=Date.now(),this._innerRefresh(),this._additionalRefreshRequested=!1,this._refreshTimeoutID=void 0},f)}}_innerRefresh(){if(this._rowStart===void 0||this._rowEnd===void 0||this._rowCount===void 0)return;const l=Math.max(this._rowStart,0),_=Math.min(this._rowEnd,this._rowCount-1);this._rowStart=void 0,this._rowEnd=void 0,this._renderCallback(l,_)}}},1680:function(A,i,l){var _=this&&this.__decorate||function(e,s,r,t){var o,u=arguments.length,g=u<3?s:t===null?t=Object.getOwnPropertyDescriptor(s,r):t;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")g=Reflect.decorate(e,s,r,t);else for(var m=e.length-1;m>=0;m--)(o=e[m])&&(g=(u<3?o(g):u>3?o(s,r,g):o(s,r))||g);return u>3&&g&&Object.defineProperty(s,r,g),g},v=this&&this.__param||function(e,s){return function(r,t){s(r,t,e)}};Object.defineProperty(i,"__esModule",{value:!0}),i.Viewport=void 0;const c=l(844),n=l(3656),f=l(4725),d=l(2585);let a=class extends c.Disposable{constructor(e,s,r,t,o,u,g,m,h){super(),this._scrollLines=e,this._viewportElement=s,this._scrollArea=r,this._bufferService=t,this._optionsService=o,this._charSizeService=u,this._renderService=g,this._coreBrowserService=m,this.scrollBarWidth=0,this._currentRowHeight=0,this._currentDeviceCellHeight=0,this._lastRecordedBufferLength=0,this._lastRecordedViewportHeight=0,this._lastRecordedBufferHeight=0,this._lastTouchY=0,this._lastScrollTop=0,this._wheelPartialScroll=0,this._refreshAnimationFrame=null,this._ignoreNextScrollEvent=!1,this._smoothScrollState={startTime:0,origin:-1,target:-1},this.scrollBarWidth=this._viewportElement.offsetWidth-this._scrollArea.offsetWidth||15,this.register((0,n.addDisposableDomListener)(this._viewportElement,"scroll",this._handleScroll.bind(this))),this._activeBuffer=this._bufferService.buffer,this.register(this._bufferService.buffers.onBufferActivate(p=>this._activeBuffer=p.activeBuffer)),this._renderDimensions=this._renderService.dimensions,this.register(this._renderService.onDimensionsChange(p=>this._renderDimensions=p)),this._handleThemeChange(h.colors),this.register(h.onChangeColors(p=>this._handleThemeChange(p))),this.register(this._optionsService.onSpecificOptionChange("scrollback",()=>this.syncScrollArea())),setTimeout(()=>this.syncScrollArea(),0)}_handleThemeChange(e){this._viewportElement.style.backgroundColor=e.background.css}_refresh(e){if(e)return this._innerRefresh(),void(this._refreshAnimationFrame!==null&&this._coreBrowserService.window.cancelAnimationFrame(this._refreshAnimationFrame));this._refreshAnimationFrame===null&&(this._refreshAnimationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>this._innerRefresh()))}_innerRefresh(){if(this._charSizeService.height>0){this._currentRowHeight=this._renderService.dimensions.device.cell.height/this._coreBrowserService.dpr,this._currentDeviceCellHeight=this._renderService.dimensions.device.cell.height,this._lastRecordedViewportHeight=this._viewportElement.offsetHeight;const s=Math.round(this._currentRowHeight*this._lastRecordedBufferLength)+(this._lastRecordedViewportHeight-this._renderService.dimensions.css.canvas.height);this._lastRecordedBufferHeight!==s&&(this._lastRecordedBufferHeight=s,this._scrollArea.style.height=this._lastRecordedBufferHeight+"px")}const e=this._bufferService.buffer.ydisp*this._currentRowHeight;this._viewportElement.scrollTop!==e&&(this._ignoreNextScrollEvent=!0,this._viewportElement.scrollTop=e),this._refreshAnimationFrame=null}syncScrollArea(e=!1){if(this._lastRecordedBufferLength!==this._bufferService.buffer.lines.length)return this._lastRecordedBufferLength=this._bufferService.buffer.lines.length,void this._refresh(e);this._lastRecordedViewportHeight===this._renderService.dimensions.css.canvas.height&&this._lastScrollTop===this._activeBuffer.ydisp*this._currentRowHeight&&this._renderDimensions.device.cell.height===this._currentDeviceCellHeight||this._refresh(e)}_handleScroll(e){if(this._lastScrollTop=this._viewportElement.scrollTop,!this._viewportElement.offsetParent)return;if(this._ignoreNextScrollEvent)return this._ignoreNextScrollEvent=!1,void this._scrollLines(0);const s=Math.round(this._lastScrollTop/this._currentRowHeight)-this._bufferService.buffer.ydisp;this._scrollLines(s)}_smoothScroll(){if(this._isDisposed||this._smoothScrollState.origin===-1||this._smoothScrollState.target===-1)return;const e=this._smoothScrollPercent();this._viewportElement.scrollTop=this._smoothScrollState.origin+Math.round(e*(this._smoothScrollState.target-this._smoothScrollState.origin)),e<1?this._coreBrowserService.window.requestAnimationFrame(()=>this._smoothScroll()):this._clearSmoothScrollState()}_smoothScrollPercent(){return this._optionsService.rawOptions.smoothScrollDuration&&this._smoothScrollState.startTime?Math.max(Math.min((Date.now()-this._smoothScrollState.startTime)/this._optionsService.rawOptions.smoothScrollDuration,1),0):1}_clearSmoothScrollState(){this._smoothScrollState.startTime=0,this._smoothScrollState.origin=-1,this._smoothScrollState.target=-1}_bubbleScroll(e,s){const r=this._viewportElement.scrollTop+this._lastRecordedViewportHeight;return!(s<0&&this._viewportElement.scrollTop!==0||s>0&&r<this._lastRecordedBufferHeight)||(e.cancelable&&e.preventDefault(),!1)}handleWheel(e){const s=this._getPixelsScrolled(e);return s!==0&&(this._optionsService.rawOptions.smoothScrollDuration?(this._smoothScrollState.startTime=Date.now(),this._smoothScrollPercent()<1?(this._smoothScrollState.origin=this._viewportElement.scrollTop,this._smoothScrollState.target===-1?this._smoothScrollState.target=this._viewportElement.scrollTop+s:this._smoothScrollState.target+=s,this._smoothScrollState.target=Math.max(Math.min(this._smoothScrollState.target,this._viewportElement.scrollHeight),0),this._smoothScroll()):this._clearSmoothScrollState()):this._viewportElement.scrollTop+=s,this._bubbleScroll(e,s))}_getPixelsScrolled(e){if(e.deltaY===0||e.shiftKey)return 0;let s=this._applyScrollModifier(e.deltaY,e);return e.deltaMode===WheelEvent.DOM_DELTA_LINE?s*=this._currentRowHeight:e.deltaMode===WheelEvent.DOM_DELTA_PAGE&&(s*=this._currentRowHeight*this._bufferService.rows),s}getLinesScrolled(e){if(e.deltaY===0||e.shiftKey)return 0;let s=this._applyScrollModifier(e.deltaY,e);return e.deltaMode===WheelEvent.DOM_DELTA_PIXEL?(s/=this._currentRowHeight+0,this._wheelPartialScroll+=s,s=Math.floor(Math.abs(this._wheelPartialScroll))*(this._wheelPartialScroll>0?1:-1),this._wheelPartialScroll%=1):e.deltaMode===WheelEvent.DOM_DELTA_PAGE&&(s*=this._bufferService.rows),s}_applyScrollModifier(e,s){const r=this._optionsService.rawOptions.fastScrollModifier;return r==="alt"&&s.altKey||r==="ctrl"&&s.ctrlKey||r==="shift"&&s.shiftKey?e*this._optionsService.rawOptions.fastScrollSensitivity*this._optionsService.rawOptions.scrollSensitivity:e*this._optionsService.rawOptions.scrollSensitivity}handleTouchStart(e){this._lastTouchY=e.touches[0].pageY}handleTouchMove(e){const s=this._lastTouchY-e.touches[0].pageY;return this._lastTouchY=e.touches[0].pageY,s!==0&&(this._viewportElement.scrollTop+=s,this._bubbleScroll(e,s))}};a=_([v(3,d.IBufferService),v(4,d.IOptionsService),v(5,f.ICharSizeService),v(6,f.IRenderService),v(7,f.ICoreBrowserService),v(8,f.IThemeService)],a),i.Viewport=a},3107:function(A,i,l){var _=this&&this.__decorate||function(e,s,r,t){var o,u=arguments.length,g=u<3?s:t===null?t=Object.getOwnPropertyDescriptor(s,r):t;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")g=Reflect.decorate(e,s,r,t);else for(var m=e.length-1;m>=0;m--)(o=e[m])&&(g=(u<3?o(g):u>3?o(s,r,g):o(s,r))||g);return u>3&&g&&Object.defineProperty(s,r,g),g},v=this&&this.__param||function(e,s){return function(r,t){s(r,t,e)}};Object.defineProperty(i,"__esModule",{value:!0}),i.BufferDecorationRenderer=void 0;const c=l(3656),n=l(4725),f=l(844),d=l(2585);let a=class extends f.Disposable{constructor(e,s,r,t){super(),this._screenElement=e,this._bufferService=s,this._decorationService=r,this._renderService=t,this._decorationElements=new Map,this._altBufferIsActive=!1,this._dimensionsChanged=!1,this._container=document.createElement("div"),this._container.classList.add("xterm-decoration-container"),this._screenElement.appendChild(this._container),this.register(this._renderService.onRenderedViewportChange(()=>this._doRefreshDecorations())),this.register(this._renderService.onDimensionsChange(()=>{this._dimensionsChanged=!0,this._queueRefresh()})),this.register((0,c.addDisposableDomListener)(window,"resize",()=>this._queueRefresh())),this.register(this._bufferService.buffers.onBufferActivate(()=>{this._altBufferIsActive=this._bufferService.buffer===this._bufferService.buffers.alt})),this.register(this._decorationService.onDecorationRegistered(()=>this._queueRefresh())),this.register(this._decorationService.onDecorationRemoved(o=>this._removeDecoration(o))),this.register((0,f.toDisposable)(()=>{this._container.remove(),this._decorationElements.clear()}))}_queueRefresh(){this._animationFrame===void 0&&(this._animationFrame=this._renderService.addRefreshCallback(()=>{this._doRefreshDecorations(),this._animationFrame=void 0}))}_doRefreshDecorations(){for(const e of this._decorationService.decorations)this._renderDecoration(e);this._dimensionsChanged=!1}_renderDecoration(e){this._refreshStyle(e),this._dimensionsChanged&&this._refreshXPosition(e)}_createElement(e){var s;const r=document.createElement("div");r.classList.add("xterm-decoration"),r.style.width=`${Math.round((e.options.width||1)*this._renderService.dimensions.css.cell.width)}px`,r.style.height=(e.options.height||1)*this._renderService.dimensions.css.cell.height+"px",r.style.top=(e.marker.line-this._bufferService.buffers.active.ydisp)*this._renderService.dimensions.css.cell.height+"px",r.style.lineHeight=`${this._renderService.dimensions.css.cell.height}px`;const t=(s=e.options.x)!==null&&s!==void 0?s:0;return t&&t>this._bufferService.cols&&(r.style.display="none"),this._refreshXPosition(e,r),r}_refreshStyle(e){const s=e.marker.line-this._bufferService.buffers.active.ydisp;if(s<0||s>=this._bufferService.rows)e.element&&(e.element.style.display="none",e.onRenderEmitter.fire(e.element));else{let r=this._decorationElements.get(e);r||(r=this._createElement(e),e.element=r,this._decorationElements.set(e,r),this._container.appendChild(r)),r.style.top=s*this._renderService.dimensions.css.cell.height+"px",r.style.display=this._altBufferIsActive?"none":"block",e.onRenderEmitter.fire(r)}}_refreshXPosition(e,s=e.element){var r;if(!s)return;const t=(r=e.options.x)!==null&&r!==void 0?r:0;(e.options.anchor||"left")==="right"?s.style.right=t?t*this._renderService.dimensions.css.cell.width+"px":"":s.style.left=t?t*this._renderService.dimensions.css.cell.width+"px":""}_removeDecoration(e){var s;(s=this._decorationElements.get(e))===null||s===void 0||s.remove(),this._decorationElements.delete(e),e.dispose()}};a=_([v(1,d.IBufferService),v(2,d.IDecorationService),v(3,n.IRenderService)],a),i.BufferDecorationRenderer=a},5871:(A,i)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.ColorZoneStore=void 0,i.ColorZoneStore=class{constructor(){this._zones=[],this._zonePool=[],this._zonePoolIndex=0,this._linePadding={full:0,left:0,center:0,right:0}}get zones(){return this._zonePool.length=Math.min(this._zonePool.length,this._zones.length),this._zones}clear(){this._zones.length=0,this._zonePoolIndex=0}addDecoration(l){if(l.options.overviewRulerOptions){for(const _ of this._zones)if(_.color===l.options.overviewRulerOptions.color&&_.position===l.options.overviewRulerOptions.position){if(this._lineIntersectsZone(_,l.marker.line))return;if(this._lineAdjacentToZone(_,l.marker.line,l.options.overviewRulerOptions.position))return void this._addLineToZone(_,l.marker.line)}if(this._zonePoolIndex<this._zonePool.length)return this._zonePool[this._zonePoolIndex].color=l.options.overviewRulerOptions.color,this._zonePool[this._zonePoolIndex].position=l.options.overviewRulerOptions.position,this._zonePool[this._zonePoolIndex].startBufferLine=l.marker.line,this._zonePool[this._zonePoolIndex].endBufferLine=l.marker.line,void this._zones.push(this._zonePool[this._zonePoolIndex++]);this._zones.push({color:l.options.overviewRulerOptions.color,position:l.options.overviewRulerOptions.position,startBufferLine:l.marker.line,endBufferLine:l.marker.line}),this._zonePool.push(this._zones[this._zones.length-1]),this._zonePoolIndex++}}setPadding(l){this._linePadding=l}_lineIntersectsZone(l,_){return _>=l.startBufferLine&&_<=l.endBufferLine}_lineAdjacentToZone(l,_,v){return _>=l.startBufferLine-this._linePadding[v||"full"]&&_<=l.endBufferLine+this._linePadding[v||"full"]}_addLineToZone(l,_){l.startBufferLine=Math.min(l.startBufferLine,_),l.endBufferLine=Math.max(l.endBufferLine,_)}}},5744:function(A,i,l){var _=this&&this.__decorate||function(o,u,g,m){var h,p=arguments.length,C=p<3?u:m===null?m=Object.getOwnPropertyDescriptor(u,g):m;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")C=Reflect.decorate(o,u,g,m);else for(var w=o.length-1;w>=0;w--)(h=o[w])&&(C=(p<3?h(C):p>3?h(u,g,C):h(u,g))||C);return p>3&&C&&Object.defineProperty(u,g,C),C},v=this&&this.__param||function(o,u){return function(g,m){u(g,m,o)}};Object.defineProperty(i,"__esModule",{value:!0}),i.OverviewRulerRenderer=void 0;const c=l(5871),n=l(3656),f=l(4725),d=l(844),a=l(2585),e={full:0,left:0,center:0,right:0},s={full:0,left:0,center:0,right:0},r={full:0,left:0,center:0,right:0};let t=class extends d.Disposable{constructor(o,u,g,m,h,p,C){var w;super(),this._viewportElement=o,this._screenElement=u,this._bufferService=g,this._decorationService=m,this._renderService=h,this._optionsService=p,this._coreBrowseService=C,this._colorZoneStore=new c.ColorZoneStore,this._shouldUpdateDimensions=!0,this._shouldUpdateAnchor=!0,this._lastKnownBufferLength=0,this._canvas=document.createElement("canvas"),this._canvas.classList.add("xterm-decoration-overview-ruler"),this._refreshCanvasDimensions(),(w=this._viewportElement.parentElement)===null||w===void 0||w.insertBefore(this._canvas,this._viewportElement);const y=this._canvas.getContext("2d");if(!y)throw new Error("Ctx cannot be null");this._ctx=y,this._registerDecorationListeners(),this._registerBufferChangeListeners(),this._registerDimensionChangeListeners(),this.register((0,d.toDisposable)(()=>{var D;(D=this._canvas)===null||D===void 0||D.remove()}))}get _width(){return this._optionsService.options.overviewRulerWidth||0}_registerDecorationListeners(){this.register(this._decorationService.onDecorationRegistered(()=>this._queueRefresh(void 0,!0))),this.register(this._decorationService.onDecorationRemoved(()=>this._queueRefresh(void 0,!0)))}_registerBufferChangeListeners(){this.register(this._renderService.onRenderedViewportChange(()=>this._queueRefresh())),this.register(this._bufferService.buffers.onBufferActivate(()=>{this._canvas.style.display=this._bufferService.buffer===this._bufferService.buffers.alt?"none":"block"})),this.register(this._bufferService.onScroll(()=>{this._lastKnownBufferLength!==this._bufferService.buffers.normal.lines.length&&(this._refreshDrawHeightConstants(),this._refreshColorZonePadding())}))}_registerDimensionChangeListeners(){this.register(this._renderService.onRender(()=>{this._containerHeight&&this._containerHeight===this._screenElement.clientHeight||(this._queueRefresh(!0),this._containerHeight=this._screenElement.clientHeight)})),this.register(this._optionsService.onSpecificOptionChange("overviewRulerWidth",()=>this._queueRefresh(!0))),this.register((0,n.addDisposableDomListener)(this._coreBrowseService.window,"resize",()=>this._queueRefresh(!0))),this._queueRefresh(!0)}_refreshDrawConstants(){const o=Math.floor(this._canvas.width/3),u=Math.ceil(this._canvas.width/3);s.full=this._canvas.width,s.left=o,s.center=u,s.right=o,this._refreshDrawHeightConstants(),r.full=0,r.left=0,r.center=s.left,r.right=s.left+s.center}_refreshDrawHeightConstants(){e.full=Math.round(2*this._coreBrowseService.dpr);const o=this._canvas.height/this._bufferService.buffer.lines.length,u=Math.round(Math.max(Math.min(o,12),6)*this._coreBrowseService.dpr);e.left=u,e.center=u,e.right=u}_refreshColorZonePadding(){this._colorZoneStore.setPadding({full:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*e.full),left:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*e.left),center:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*e.center),right:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*e.right)}),this._lastKnownBufferLength=this._bufferService.buffers.normal.lines.length}_refreshCanvasDimensions(){this._canvas.style.width=`${this._width}px`,this._canvas.width=Math.round(this._width*this._coreBrowseService.dpr),this._canvas.style.height=`${this._screenElement.clientHeight}px`,this._canvas.height=Math.round(this._screenElement.clientHeight*this._coreBrowseService.dpr),this._refreshDrawConstants(),this._refreshColorZonePadding()}_refreshDecorations(){this._shouldUpdateDimensions&&this._refreshCanvasDimensions(),this._ctx.clearRect(0,0,this._canvas.width,this._canvas.height),this._colorZoneStore.clear();for(const u of this._decorationService.decorations)this._colorZoneStore.addDecoration(u);this._ctx.lineWidth=1;const o=this._colorZoneStore.zones;for(const u of o)u.position!=="full"&&this._renderColorZone(u);for(const u of o)u.position==="full"&&this._renderColorZone(u);this._shouldUpdateDimensions=!1,this._shouldUpdateAnchor=!1}_renderColorZone(o){this._ctx.fillStyle=o.color,this._ctx.fillRect(r[o.position||"full"],Math.round((this._canvas.height-1)*(o.startBufferLine/this._bufferService.buffers.active.lines.length)-e[o.position||"full"]/2),s[o.position||"full"],Math.round((this._canvas.height-1)*((o.endBufferLine-o.startBufferLine)/this._bufferService.buffers.active.lines.length)+e[o.position||"full"]))}_queueRefresh(o,u){this._shouldUpdateDimensions=o||this._shouldUpdateDimensions,this._shouldUpdateAnchor=u||this._shouldUpdateAnchor,this._animationFrame===void 0&&(this._animationFrame=this._coreBrowseService.window.requestAnimationFrame(()=>{this._refreshDecorations(),this._animationFrame=void 0}))}};t=_([v(2,a.IBufferService),v(3,a.IDecorationService),v(4,f.IRenderService),v(5,a.IOptionsService),v(6,f.ICoreBrowserService)],t),i.OverviewRulerRenderer=t},2950:function(A,i,l){var _=this&&this.__decorate||function(a,e,s,r){var t,o=arguments.length,u=o<3?e:r===null?r=Object.getOwnPropertyDescriptor(e,s):r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")u=Reflect.decorate(a,e,s,r);else for(var g=a.length-1;g>=0;g--)(t=a[g])&&(u=(o<3?t(u):o>3?t(e,s,u):t(e,s))||u);return o>3&&u&&Object.defineProperty(e,s,u),u},v=this&&this.__param||function(a,e){return function(s,r){e(s,r,a)}};Object.defineProperty(i,"__esModule",{value:!0}),i.CompositionHelper=void 0;const c=l(4725),n=l(2585),f=l(2584);let d=class{constructor(a,e,s,r,t,o){this._textarea=a,this._compositionView=e,this._bufferService=s,this._optionsService=r,this._coreService=t,this._renderService=o,this._isComposing=!1,this._isSendingComposition=!1,this._compositionPosition={start:0,end:0},this._dataAlreadySent=""}get isComposing(){return this._isComposing}compositionstart(){this._isComposing=!0,this._compositionPosition.start=this._textarea.value.length,this._compositionView.textContent="",this._dataAlreadySent="",this._compositionView.classList.add("active")}compositionupdate(a){this._compositionView.textContent=a.data,this.updateCompositionElements(),setTimeout(()=>{this._compositionPosition.end=this._textarea.value.length},0)}compositionend(){this._finalizeComposition(!0)}keydown(a){if(this._isComposing||this._isSendingComposition){if(a.keyCode===229||a.keyCode===16||a.keyCode===17||a.keyCode===18)return!1;this._finalizeComposition(!1)}return a.keyCode!==229||(this._handleAnyTextareaChanges(),!1)}_finalizeComposition(a){if(this._compositionView.classList.remove("active"),this._isComposing=!1,a){const e={start:this._compositionPosition.start,end:this._compositionPosition.end};this._isSendingComposition=!0,setTimeout(()=>{if(this._isSendingComposition){let s;this._isSendingComposition=!1,e.start+=this._dataAlreadySent.length,s=this._isComposing?this._textarea.value.substring(e.start,e.end):this._textarea.value.substring(e.start),s.length>0&&this._coreService.triggerDataEvent(s,!0)}},0)}else{this._isSendingComposition=!1;const e=this._textarea.value.substring(this._compositionPosition.start,this._compositionPosition.end);this._coreService.triggerDataEvent(e,!0)}}_handleAnyTextareaChanges(){const a=this._textarea.value;setTimeout(()=>{if(!this._isComposing){const e=this._textarea.value,s=e.replace(a,"");this._dataAlreadySent=s,e.length>a.length?this._coreService.triggerDataEvent(s,!0):e.length<a.length?this._coreService.triggerDataEvent(`${f.C0.DEL}`,!0):e.length===a.length&&e!==a&&this._coreService.triggerDataEvent(e,!0)}},0)}updateCompositionElements(a){if(this._isComposing){if(this._bufferService.buffer.isCursorInViewport){const e=Math.min(this._bufferService.buffer.x,this._bufferService.cols-1),s=this._renderService.dimensions.css.cell.height,r=this._bufferService.buffer.y*this._renderService.dimensions.css.cell.height,t=e*this._renderService.dimensions.css.cell.width;this._compositionView.style.left=t+"px",this._compositionView.style.top=r+"px",this._compositionView.style.height=s+"px",this._compositionView.style.lineHeight=s+"px",this._compositionView.style.fontFamily=this._optionsService.rawOptions.fontFamily,this._compositionView.style.fontSize=this._optionsService.rawOptions.fontSize+"px";const o=this._compositionView.getBoundingClientRect();this._textarea.style.left=t+"px",this._textarea.style.top=r+"px",this._textarea.style.width=Math.max(o.width,1)+"px",this._textarea.style.height=Math.max(o.height,1)+"px",this._textarea.style.lineHeight=o.height+"px"}a||setTimeout(()=>this.updateCompositionElements(!0),0)}}};d=_([v(2,n.IBufferService),v(3,n.IOptionsService),v(4,n.ICoreService),v(5,c.IRenderService)],d),i.CompositionHelper=d},9806:(A,i)=>{function l(_,v,c){const n=c.getBoundingClientRect(),f=_.getComputedStyle(c),d=parseInt(f.getPropertyValue("padding-left")),a=parseInt(f.getPropertyValue("padding-top"));return[v.clientX-n.left-d,v.clientY-n.top-a]}Object.defineProperty(i,"__esModule",{value:!0}),i.getCoords=i.getCoordsRelativeToElement=void 0,i.getCoordsRelativeToElement=l,i.getCoords=function(_,v,c,n,f,d,a,e,s){if(!d)return;const r=l(_,v,c);return r?(r[0]=Math.ceil((r[0]+(s?a/2:0))/a),r[1]=Math.ceil(r[1]/e),r[0]=Math.min(Math.max(r[0],1),n+(s?1:0)),r[1]=Math.min(Math.max(r[1],1),f),r):void 0}},9504:(A,i,l)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.moveToCellSequence=void 0;const _=l(2584);function v(e,s,r,t){const o=e-c(e,r),u=s-c(s,r),g=Math.abs(o-u)-function(m,h,p){let C=0;const w=m-c(m,p),y=h-c(h,p);for(let D=0;D<Math.abs(w-y);D++){const B=n(m,h)==="A"?-1:1,I=p.buffer.lines.get(w+B*D);I!=null&&I.isWrapped&&C++}return C}(e,s,r);return a(g,d(n(e,s),t))}function c(e,s){let r=0,t=s.buffer.lines.get(e),o=t==null?void 0:t.isWrapped;for(;o&&e>=0&&e<s.rows;)r++,t=s.buffer.lines.get(--e),o=t==null?void 0:t.isWrapped;return r}function n(e,s){return e>s?"A":"B"}function f(e,s,r,t,o,u){let g=e,m=s,h="";for(;g!==r||m!==t;)g+=o?1:-1,o&&g>u.cols-1?(h+=u.buffer.translateBufferLineToString(m,!1,e,g),g=0,e=0,m++):!o&&g<0&&(h+=u.buffer.translateBufferLineToString(m,!1,0,e+1),g=u.cols-1,e=g,m--);return h+u.buffer.translateBufferLineToString(m,!1,e,g)}function d(e,s){const r=s?"O":"[";return _.C0.ESC+r+e}function a(e,s){e=Math.floor(e);let r="";for(let t=0;t<e;t++)r+=s;return r}i.moveToCellSequence=function(e,s,r,t){const o=r.buffer.x,u=r.buffer.y;if(!r.buffer.hasScrollback)return function(h,p,C,w,y,D){return v(p,w,y,D).length===0?"":a(f(h,p,h,p-c(p,y),!1,y).length,d("D",D))}(o,u,0,s,r,t)+v(u,s,r,t)+function(h,p,C,w,y,D){let B;B=v(p,w,y,D).length>0?w-c(w,y):p;const I=w,H=function(S,b,L,R,M,F){let N;return N=v(L,R,M,F).length>0?R-c(R,M):b,S<L&&N<=R||S>=L&&N<R?"C":"D"}(h,p,C,w,y,D);return a(f(h,B,C,I,H==="C",y).length,d(H,D))}(o,u,e,s,r,t);let g;if(u===s)return g=o>e?"D":"C",a(Math.abs(o-e),d(g,t));g=u>s?"D":"C";const m=Math.abs(u-s);return a(function(h,p){return p.cols-h}(u>s?e:o,r)+(m-1)*r.cols+1+((u>s?o:e)-1),d(g,t))}},1296:function(A,i,l){var _=this&&this.__decorate||function(h,p,C,w){var y,D=arguments.length,B=D<3?p:w===null?w=Object.getOwnPropertyDescriptor(p,C):w;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")B=Reflect.decorate(h,p,C,w);else for(var I=h.length-1;I>=0;I--)(y=h[I])&&(B=(D<3?y(B):D>3?y(p,C,B):y(p,C))||B);return D>3&&B&&Object.defineProperty(p,C,B),B},v=this&&this.__param||function(h,p){return function(C,w){p(C,w,h)}};Object.defineProperty(i,"__esModule",{value:!0}),i.DomRenderer=void 0;const c=l(9631),n=l(3787),f=l(2223),d=l(6171),a=l(4725),e=l(8055),s=l(8460),r=l(844),t=l(2585),o="xterm-dom-renderer-owner-",u="xterm-focus";let g=1,m=class extends r.Disposable{constructor(h,p,C,w,y,D,B,I,H,S){super(),this._element=h,this._screenElement=p,this._viewportElement=C,this._linkifier2=w,this._charSizeService=D,this._optionsService=B,this._bufferService=I,this._coreBrowserService=H,this._terminalClass=g++,this._rowElements=[],this._cellToRowElements=[],this.onRequestRedraw=this.register(new s.EventEmitter).event,this._rowContainer=document.createElement("div"),this._rowContainer.classList.add("xterm-rows"),this._rowContainer.style.lineHeight="normal",this._rowContainer.setAttribute("aria-hidden","true"),this._refreshRowElements(this._bufferService.cols,this._bufferService.rows),this._selectionContainer=document.createElement("div"),this._selectionContainer.classList.add("xterm-selection"),this._selectionContainer.setAttribute("aria-hidden","true"),this.dimensions=(0,d.createRenderDimensions)(),this._updateDimensions(),this.register(this._optionsService.onOptionChange(()=>this._handleOptionsChanged())),this.register(S.onChangeColors(b=>this._injectCss(b))),this._injectCss(S.colors),this._rowFactory=y.createInstance(n.DomRendererRowFactory,document),this._element.classList.add(o+this._terminalClass),this._screenElement.appendChild(this._rowContainer),this._screenElement.appendChild(this._selectionContainer),this.register(this._linkifier2.onShowLinkUnderline(b=>this._handleLinkHover(b))),this.register(this._linkifier2.onHideLinkUnderline(b=>this._handleLinkLeave(b))),this.register((0,r.toDisposable)(()=>{this._element.classList.remove(o+this._terminalClass),(0,c.removeElementFromParent)(this._rowContainer,this._selectionContainer,this._themeStyleElement,this._dimensionsStyleElement)}))}_updateDimensions(){const h=this._coreBrowserService.dpr;this.dimensions.device.char.width=this._charSizeService.width*h,this.dimensions.device.char.height=Math.ceil(this._charSizeService.height*h),this.dimensions.device.cell.width=this.dimensions.device.char.width+Math.round(this._optionsService.rawOptions.letterSpacing),this.dimensions.device.cell.height=Math.floor(this.dimensions.device.char.height*this._optionsService.rawOptions.lineHeight),this.dimensions.device.char.left=0,this.dimensions.device.char.top=0,this.dimensions.device.canvas.width=this.dimensions.device.cell.width*this._bufferService.cols,this.dimensions.device.canvas.height=this.dimensions.device.cell.height*this._bufferService.rows,this.dimensions.css.canvas.width=Math.round(this.dimensions.device.canvas.width/h),this.dimensions.css.canvas.height=Math.round(this.dimensions.device.canvas.height/h),this.dimensions.css.cell.width=this.dimensions.css.canvas.width/this._bufferService.cols,this.dimensions.css.cell.height=this.dimensions.css.canvas.height/this._bufferService.rows;for(const C of this._rowElements)C.style.width=`${this.dimensions.css.canvas.width}px`,C.style.height=`${this.dimensions.css.cell.height}px`,C.style.lineHeight=`${this.dimensions.css.cell.height}px`,C.style.overflow="hidden";this._dimensionsStyleElement||(this._dimensionsStyleElement=document.createElement("style"),this._screenElement.appendChild(this._dimensionsStyleElement));const p=`${this._terminalSelector} .xterm-rows span { display: inline-block; height: 100%; vertical-align: top; width: ${this.dimensions.css.cell.width}px}`;this._dimensionsStyleElement.textContent=p,this._selectionContainer.style.height=this._viewportElement.style.height,this._screenElement.style.width=`${this.dimensions.css.canvas.width}px`,this._screenElement.style.height=`${this.dimensions.css.canvas.height}px`}_injectCss(h){this._themeStyleElement||(this._themeStyleElement=document.createElement("style"),this._screenElement.appendChild(this._themeStyleElement));let p=`${this._terminalSelector} .xterm-rows { color: ${h.foreground.css}; font-family: ${this._optionsService.rawOptions.fontFamily}; font-size: ${this._optionsService.rawOptions.fontSize}px;}`;p+=`${this._terminalSelector} span:not(.${n.BOLD_CLASS}) { font-weight: ${this._optionsService.rawOptions.fontWeight};}${this._terminalSelector} span.${n.BOLD_CLASS} { font-weight: ${this._optionsService.rawOptions.fontWeightBold};}${this._terminalSelector} span.${n.ITALIC_CLASS} { font-style: italic;}`,p+="@keyframes blink_box_shadow_"+this._terminalClass+" { 50% {  box-shadow: none; }}",p+="@keyframes blink_block_"+this._terminalClass+` { 0% {  background-color: ${h.cursor.css};  color: ${h.cursorAccent.css}; } 50% {  background-color: ${h.cursorAccent.css};  color: ${h.cursor.css}; }}`,p+=`${this._terminalSelector} .xterm-rows:not(.xterm-focus) .${n.CURSOR_CLASS}.${n.CURSOR_STYLE_BLOCK_CLASS} { outline: 1px solid ${h.cursor.css}; outline-offset: -1px;}${this._terminalSelector} .xterm-rows.xterm-focus .${n.CURSOR_CLASS}.${n.CURSOR_BLINK_CLASS}:not(.${n.CURSOR_STYLE_BLOCK_CLASS}) { animation: blink_box_shadow_`+this._terminalClass+` 1s step-end infinite;}${this._terminalSelector} .xterm-rows.xterm-focus .${n.CURSOR_CLASS}.${n.CURSOR_BLINK_CLASS}.${n.CURSOR_STYLE_BLOCK_CLASS} { animation: blink_block_`+this._terminalClass+` 1s step-end infinite;}${this._terminalSelector} .xterm-rows.xterm-focus .${n.CURSOR_CLASS}.${n.CURSOR_STYLE_BLOCK_CLASS} { background-color: ${h.cursor.css}; color: ${h.cursorAccent.css};}${this._terminalSelector} .xterm-rows .${n.CURSOR_CLASS}.${n.CURSOR_STYLE_BAR_CLASS} { box-shadow: ${this._optionsService.rawOptions.cursorWidth}px 0 0 ${h.cursor.css} inset;}${this._terminalSelector} .xterm-rows .${n.CURSOR_CLASS}.${n.CURSOR_STYLE_UNDERLINE_CLASS} { box-shadow: 0 -1px 0 ${h.cursor.css} inset;}`,p+=`${this._terminalSelector} .xterm-selection { position: absolute; top: 0; left: 0; z-index: 1; pointer-events: none;}${this._terminalSelector}.focus .xterm-selection div { position: absolute; background-color: ${h.selectionBackgroundOpaque.css};}${this._terminalSelector} .xterm-selection div { position: absolute; background-color: ${h.selectionInactiveBackgroundOpaque.css};}`;for(const[C,w]of h.ansi.entries())p+=`${this._terminalSelector} .xterm-fg-${C} { color: ${w.css}; }${this._terminalSelector} .xterm-bg-${C} { background-color: ${w.css}; }`;p+=`${this._terminalSelector} .xterm-fg-${f.INVERTED_DEFAULT_COLOR} { color: ${e.color.opaque(h.background).css}; }${this._terminalSelector} .xterm-bg-${f.INVERTED_DEFAULT_COLOR} { background-color: ${h.foreground.css}; }`,this._themeStyleElement.textContent=p}handleDevicePixelRatioChange(){this._updateDimensions()}_refreshRowElements(h,p){for(let C=this._rowElements.length;C<=p;C++){const w=document.createElement("div");this._rowContainer.appendChild(w),this._rowElements.push(w)}for(;this._rowElements.length>p;)this._rowContainer.removeChild(this._rowElements.pop())}handleResize(h,p){this._refreshRowElements(h,p),this._updateDimensions()}handleCharSizeChanged(){this._updateDimensions()}handleBlur(){this._rowContainer.classList.remove(u)}handleFocus(){this._rowContainer.classList.add(u)}handleSelectionChanged(h,p,C){for(;this._selectionContainer.children.length;)this._selectionContainer.removeChild(this._selectionContainer.children[0]);if(this._rowFactory.handleSelectionChanged(h,p,C),this.renderRows(0,this._bufferService.rows-1),!h||!p)return;const w=h[1]-this._bufferService.buffer.ydisp,y=p[1]-this._bufferService.buffer.ydisp,D=Math.max(w,0),B=Math.min(y,this._bufferService.rows-1);if(D>=this._bufferService.rows||B<0)return;const I=document.createDocumentFragment();if(C){const H=h[0]>p[0];I.appendChild(this._createSelectionElement(D,H?p[0]:h[0],H?h[0]:p[0],B-D+1))}else{const H=w===D?h[0]:0,S=D===y?p[0]:this._bufferService.cols;I.appendChild(this._createSelectionElement(D,H,S));const b=B-D-1;if(I.appendChild(this._createSelectionElement(D+1,0,this._bufferService.cols,b)),D!==B){const L=y===B?p[0]:this._bufferService.cols;I.appendChild(this._createSelectionElement(B,0,L))}}this._selectionContainer.appendChild(I)}_createSelectionElement(h,p,C,w=1){const y=document.createElement("div");return y.style.height=w*this.dimensions.css.cell.height+"px",y.style.top=h*this.dimensions.css.cell.height+"px",y.style.left=p*this.dimensions.css.cell.width+"px",y.style.width=this.dimensions.css.cell.width*(C-p)+"px",y}handleCursorMove(){}_handleOptionsChanged(){this._updateDimensions()}clear(){for(const h of this._rowElements)h.replaceChildren()}renderRows(h,p){const C=this._bufferService.buffer.ybase+this._bufferService.buffer.y,w=Math.min(this._bufferService.buffer.x,this._bufferService.cols-1),y=this._optionsService.rawOptions.cursorBlink;for(let D=h;D<=p;D++){const B=this._rowElements[D],I=D+this._bufferService.buffer.ydisp,H=this._bufferService.buffer.lines.get(I),S=this._optionsService.rawOptions.cursorStyle;this._cellToRowElements[D]&&this._cellToRowElements[D].length===this._bufferService.cols||(this._cellToRowElements[D]=new Int16Array(this._bufferService.cols)),B.replaceChildren(this._rowFactory.createRow(H,I,I===C,S,w,y,this.dimensions.css.cell.width,this._bufferService.cols,this._cellToRowElements[D]))}}get _terminalSelector(){return`.${o}${this._terminalClass}`}_handleLinkHover(h){this._setCellUnderline(h.x1,h.x2,h.y1,h.y2,h.cols,!0)}_handleLinkLeave(h){this._setCellUnderline(h.x1,h.x2,h.y1,h.y2,h.cols,!1)}_setCellUnderline(h,p,C,w,y,D){if(h=this._cellToRowElements[C][h],p=this._cellToRowElements[w][p],h!==-1&&p!==-1)for(;h!==p||C!==w;){const B=this._rowElements[C];if(!B)return;const I=B.children[h];I&&(I.style.textDecoration=D?"underline":"none"),++h>=y&&(h=0,C++)}}};m=_([v(4,t.IInstantiationService),v(5,a.ICharSizeService),v(6,t.IOptionsService),v(7,t.IBufferService),v(8,a.ICoreBrowserService),v(9,a.IThemeService)],m),i.DomRenderer=m},3787:function(A,i,l){var _=this&&this.__decorate||function(g,m,h,p){var C,w=arguments.length,y=w<3?m:p===null?p=Object.getOwnPropertyDescriptor(m,h):p;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")y=Reflect.decorate(g,m,h,p);else for(var D=g.length-1;D>=0;D--)(C=g[D])&&(y=(w<3?C(y):w>3?C(m,h,y):C(m,h))||y);return w>3&&y&&Object.defineProperty(m,h,y),y},v=this&&this.__param||function(g,m){return function(h,p){m(h,p,g)}};Object.defineProperty(i,"__esModule",{value:!0}),i.DomRendererRowFactory=i.CURSOR_STYLE_UNDERLINE_CLASS=i.CURSOR_STYLE_BAR_CLASS=i.CURSOR_STYLE_BLOCK_CLASS=i.CURSOR_BLINK_CLASS=i.CURSOR_CLASS=i.STRIKETHROUGH_CLASS=i.UNDERLINE_CLASS=i.ITALIC_CLASS=i.DIM_CLASS=i.BOLD_CLASS=void 0;const c=l(2223),n=l(643),f=l(511),d=l(2585),a=l(8055),e=l(4725),s=l(4269),r=l(6171),t=l(3734);i.BOLD_CLASS="xterm-bold",i.DIM_CLASS="xterm-dim",i.ITALIC_CLASS="xterm-italic",i.UNDERLINE_CLASS="xterm-underline",i.STRIKETHROUGH_CLASS="xterm-strikethrough",i.CURSOR_CLASS="xterm-cursor",i.CURSOR_BLINK_CLASS="xterm-cursor-blink",i.CURSOR_STYLE_BLOCK_CLASS="xterm-cursor-block",i.CURSOR_STYLE_BAR_CLASS="xterm-cursor-bar",i.CURSOR_STYLE_UNDERLINE_CLASS="xterm-cursor-underline";let o=class{constructor(g,m,h,p,C,w,y){this._document=g,this._characterJoinerService=m,this._optionsService=h,this._coreBrowserService=p,this._coreService=C,this._decorationService=w,this._themeService=y,this._workCell=new f.CellData,this._columnSelectMode=!1}handleSelectionChanged(g,m,h){this._selectionStart=g,this._selectionEnd=m,this._columnSelectMode=h}createRow(g,m,h,p,C,w,y,D,B){const I=this._document.createDocumentFragment(),H=this._characterJoinerService.getJoinedCharacters(m);let S=0;for(let M=Math.min(g.length,D)-1;M>=0;M--)if(g.loadCell(M,this._workCell).getCode()!==n.NULL_CELL_CODE||h&&M===C){S=M+1;break}const b=this._themeService.colors;let L=-1,R=0;for(;R<S;R++){g.loadCell(R,this._workCell);let M=this._workCell.getWidth();if(M===0){B[R]=L;continue}let F=!1,N=R,O=this._workCell;if(H.length>0&&R===H[0][0]){F=!0;const q=H.shift();O=new s.JoinedCellData(this._workCell,g.translateToString(!0,q[0],q[1]),q[1]-q[0]),N=q[1]-1,M=O.getWidth()}const W=this._document.createElement("span");if(M>1&&(W.style.width=y*M+"px"),F&&(W.style.display="inline",C>=R&&C<=N&&(C=R)),!this._coreService.isCursorHidden&&h&&R===C)switch(W.classList.add(i.CURSOR_CLASS),w&&W.classList.add(i.CURSOR_BLINK_CLASS),p){case"bar":W.classList.add(i.CURSOR_STYLE_BAR_CLASS);break;case"underline":W.classList.add(i.CURSOR_STYLE_UNDERLINE_CLASS);break;default:W.classList.add(i.CURSOR_STYLE_BLOCK_CLASS)}if(O.isBold()&&W.classList.add(i.BOLD_CLASS),O.isItalic()&&W.classList.add(i.ITALIC_CLASS),O.isDim()&&W.classList.add(i.DIM_CLASS),O.isInvisible()?W.textContent=n.WHITESPACE_CELL_CHAR:W.textContent=O.getChars()||n.WHITESPACE_CELL_CHAR,O.isUnderline()&&(W.classList.add(`${i.UNDERLINE_CLASS}-${O.extended.underlineStyle}`),W.textContent===" "&&(W.textContent="Â "),!O.isUnderlineColorDefault()))if(O.isUnderlineColorRGB())W.style.textDecorationColor=`rgb(${t.AttributeData.toColorRGB(O.getUnderlineColor()).join(",")})`;else{let q=O.getUnderlineColor();this._optionsService.rawOptions.drawBoldTextInBrightColors&&O.isBold()&&q<8&&(q+=8),W.style.textDecorationColor=b.ansi[q].css}O.isStrikethrough()&&W.classList.add(i.STRIKETHROUGH_CLASS);let k=O.getFgColor(),E=O.getFgColorMode(),x=O.getBgColor(),T=O.getBgColorMode();const P=!!O.isInverse();if(P){const q=k;k=x,x=q;const ae=E;E=T,T=ae}let V,U,G=!1;this._decorationService.forEachDecorationAtCell(R,m,void 0,q=>{q.options.layer!=="top"&&G||(q.backgroundColorRGB&&(T=50331648,x=q.backgroundColorRGB.rgba>>8&16777215,V=q.backgroundColorRGB),q.foregroundColorRGB&&(E=50331648,k=q.foregroundColorRGB.rgba>>8&16777215,U=q.foregroundColorRGB),G=q.options.layer==="top")});const Y=this._isCellInSelection(R,m);let X;switch(G||b.selectionForeground&&Y&&(E=50331648,k=b.selectionForeground.rgba>>8&16777215,U=b.selectionForeground),Y&&(V=this._coreBrowserService.isFocused?b.selectionBackgroundOpaque:b.selectionInactiveBackgroundOpaque,G=!0),G&&W.classList.add("xterm-decoration-top"),T){case 16777216:case 33554432:X=b.ansi[x],W.classList.add(`xterm-bg-${x}`);break;case 50331648:X=a.rgba.toColor(x>>16,x>>8&255,255&x),this._addStyle(W,`background-color:#${u((x>>>0).toString(16),"0",6)}`);break;default:P?(X=b.foreground,W.classList.add(`xterm-bg-${c.INVERTED_DEFAULT_COLOR}`)):X=b.background}switch(V||O.isDim()&&(V=a.color.multiplyOpacity(X,.5)),E){case 16777216:case 33554432:O.isBold()&&k<8&&this._optionsService.rawOptions.drawBoldTextInBrightColors&&(k+=8),this._applyMinimumContrast(W,X,b.ansi[k],O,V,void 0)||W.classList.add(`xterm-fg-${k}`);break;case 50331648:const q=a.rgba.toColor(k>>16&255,k>>8&255,255&k);this._applyMinimumContrast(W,X,q,O,V,U)||this._addStyle(W,`color:#${u(k.toString(16),"0",6)}`);break;default:this._applyMinimumContrast(W,X,b.foreground,O,V,void 0)||P&&W.classList.add(`xterm-fg-${c.INVERTED_DEFAULT_COLOR}`)}I.appendChild(W),B[R]=++L,R=N}return R<D-1&&B.subarray(R).fill(++L),I}_applyMinimumContrast(g,m,h,p,C,w){if(this._optionsService.rawOptions.minimumContrastRatio===1||(0,r.excludeFromContrastRatioDemands)(p.getCode()))return!1;let y;return C||w||(y=this._themeService.colors.contrastCache.getColor(m.rgba,h.rgba)),y===void 0&&(y=a.color.ensureContrastRatio(C||m,w||h,this._optionsService.rawOptions.minimumContrastRatio),this._themeService.colors.contrastCache.setColor((C||m).rgba,(w||h).rgba,y??null)),!!y&&(this._addStyle(g,`color:${y.css}`),!0)}_addStyle(g,m){g.setAttribute("style",`${g.getAttribute("style")||""}${m};`)}_isCellInSelection(g,m){const h=this._selectionStart,p=this._selectionEnd;return!(!h||!p)&&(this._columnSelectMode?h[0]<=p[0]?g>=h[0]&&m>=h[1]&&g<p[0]&&m<=p[1]:g<h[0]&&m>=h[1]&&g>=p[0]&&m<=p[1]:m>h[1]&&m<p[1]||h[1]===p[1]&&m===h[1]&&g>=h[0]&&g<p[0]||h[1]<p[1]&&m===p[1]&&g<p[0]||h[1]<p[1]&&m===h[1]&&g>=h[0])}};function u(g,m,h){for(;g.length<h;)g=m+g;return g}o=_([v(1,e.ICharacterJoinerService),v(2,d.IOptionsService),v(3,e.ICoreBrowserService),v(4,d.ICoreService),v(5,d.IDecorationService),v(6,e.IThemeService)],o),i.DomRendererRowFactory=o},2223:(A,i,l)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.TEXT_BASELINE=i.DIM_OPACITY=i.INVERTED_DEFAULT_COLOR=void 0;const _=l(6114);i.INVERTED_DEFAULT_COLOR=257,i.DIM_OPACITY=.5,i.TEXT_BASELINE=_.isFirefox||_.isLegacyEdge?"bottom":"ideographic"},6171:(A,i)=>{function l(_){return 57508<=_&&_<=57558}Object.defineProperty(i,"__esModule",{value:!0}),i.createRenderDimensions=i.excludeFromContrastRatioDemands=i.isRestrictedPowerlineGlyph=i.isPowerlineGlyph=i.throwIfFalsy=void 0,i.throwIfFalsy=function(_){if(!_)throw new Error("value must not be falsy");return _},i.isPowerlineGlyph=l,i.isRestrictedPowerlineGlyph=function(_){return 57520<=_&&_<=57527},i.excludeFromContrastRatioDemands=function(_){return l(_)||function(v){return 9472<=v&&v<=9631}(_)},i.createRenderDimensions=function(){return{css:{canvas:{width:0,height:0},cell:{width:0,height:0}},device:{canvas:{width:0,height:0},cell:{width:0,height:0},char:{width:0,height:0,left:0,top:0}}}}},456:(A,i)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.SelectionModel=void 0,i.SelectionModel=class{constructor(l){this._bufferService=l,this.isSelectAllActive=!1,this.selectionStartLength=0}clearSelection(){this.selectionStart=void 0,this.selectionEnd=void 0,this.isSelectAllActive=!1,this.selectionStartLength=0}get finalSelectionStart(){return this.isSelectAllActive?[0,0]:this.selectionEnd&&this.selectionStart&&this.areSelectionValuesReversed()?this.selectionEnd:this.selectionStart}get finalSelectionEnd(){if(this.isSelectAllActive)return[this._bufferService.cols,this._bufferService.buffer.ybase+this._bufferService.rows-1];if(this.selectionStart){if(!this.selectionEnd||this.areSelectionValuesReversed()){const l=this.selectionStart[0]+this.selectionStartLength;return l>this._bufferService.cols?l%this._bufferService.cols==0?[this._bufferService.cols,this.selectionStart[1]+Math.floor(l/this._bufferService.cols)-1]:[l%this._bufferService.cols,this.selectionStart[1]+Math.floor(l/this._bufferService.cols)]:[l,this.selectionStart[1]]}if(this.selectionStartLength&&this.selectionEnd[1]===this.selectionStart[1]){const l=this.selectionStart[0]+this.selectionStartLength;return l>this._bufferService.cols?[l%this._bufferService.cols,this.selectionStart[1]+Math.floor(l/this._bufferService.cols)]:[Math.max(l,this.selectionEnd[0]),this.selectionEnd[1]]}return this.selectionEnd}}areSelectionValuesReversed(){const l=this.selectionStart,_=this.selectionEnd;return!(!l||!_)&&(l[1]>_[1]||l[1]===_[1]&&l[0]>_[0])}handleTrim(l){return this.selectionStart&&(this.selectionStart[1]-=l),this.selectionEnd&&(this.selectionEnd[1]-=l),this.selectionEnd&&this.selectionEnd[1]<0?(this.clearSelection(),!0):(this.selectionStart&&this.selectionStart[1]<0&&(this.selectionStart[1]=0),!1)}}},428:function(A,i,l){var _=this&&this.__decorate||function(e,s,r,t){var o,u=arguments.length,g=u<3?s:t===null?t=Object.getOwnPropertyDescriptor(s,r):t;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")g=Reflect.decorate(e,s,r,t);else for(var m=e.length-1;m>=0;m--)(o=e[m])&&(g=(u<3?o(g):u>3?o(s,r,g):o(s,r))||g);return u>3&&g&&Object.defineProperty(s,r,g),g},v=this&&this.__param||function(e,s){return function(r,t){s(r,t,e)}};Object.defineProperty(i,"__esModule",{value:!0}),i.CharSizeService=void 0;const c=l(2585),n=l(8460),f=l(844);let d=class extends f.Disposable{constructor(e,s,r){super(),this._optionsService=r,this.width=0,this.height=0,this._onCharSizeChange=this.register(new n.EventEmitter),this.onCharSizeChange=this._onCharSizeChange.event,this._measureStrategy=new a(e,s,this._optionsService),this.register(this._optionsService.onMultipleOptionChange(["fontFamily","fontSize"],()=>this.measure()))}get hasValidSize(){return this.width>0&&this.height>0}measure(){const e=this._measureStrategy.measure();e.width===this.width&&e.height===this.height||(this.width=e.width,this.height=e.height,this._onCharSizeChange.fire())}};d=_([v(2,c.IOptionsService)],d),i.CharSizeService=d;class a{constructor(s,r,t){this._document=s,this._parentElement=r,this._optionsService=t,this._result={width:0,height:0},this._measureElement=this._document.createElement("span"),this._measureElement.classList.add("xterm-char-measure-element"),this._measureElement.textContent="W",this._measureElement.setAttribute("aria-hidden","true"),this._parentElement.appendChild(this._measureElement)}measure(){this._measureElement.style.fontFamily=this._optionsService.rawOptions.fontFamily,this._measureElement.style.fontSize=`${this._optionsService.rawOptions.fontSize}px`;const s=this._measureElement.getBoundingClientRect();return s.width!==0&&s.height!==0&&(this._result.width=s.width,this._result.height=Math.ceil(s.height)),this._result}}},4269:function(A,i,l){var _=this&&this.__decorate||function(s,r,t,o){var u,g=arguments.length,m=g<3?r:o===null?o=Object.getOwnPropertyDescriptor(r,t):o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")m=Reflect.decorate(s,r,t,o);else for(var h=s.length-1;h>=0;h--)(u=s[h])&&(m=(g<3?u(m):g>3?u(r,t,m):u(r,t))||m);return g>3&&m&&Object.defineProperty(r,t,m),m},v=this&&this.__param||function(s,r){return function(t,o){r(t,o,s)}};Object.defineProperty(i,"__esModule",{value:!0}),i.CharacterJoinerService=i.JoinedCellData=void 0;const c=l(3734),n=l(643),f=l(511),d=l(2585);class a extends c.AttributeData{constructor(r,t,o){super(),this.content=0,this.combinedData="",this.fg=r.fg,this.bg=r.bg,this.combinedData=t,this._width=o}isCombined(){return 2097152}getWidth(){return this._width}getChars(){return this.combinedData}getCode(){return 2097151}setFromCharData(r){throw new Error("not implemented")}getAsCharData(){return[this.fg,this.getChars(),this.getWidth(),this.getCode()]}}i.JoinedCellData=a;let e=class te{constructor(r){this._bufferService=r,this._characterJoiners=[],this._nextCharacterJoinerId=0,this._workCell=new f.CellData}register(r){const t={id:this._nextCharacterJoinerId++,handler:r};return this._characterJoiners.push(t),t.id}deregister(r){for(let t=0;t<this._characterJoiners.length;t++)if(this._characterJoiners[t].id===r)return this._characterJoiners.splice(t,1),!0;return!1}getJoinedCharacters(r){if(this._characterJoiners.length===0)return[];const t=this._bufferService.buffer.lines.get(r);if(!t||t.length===0)return[];const o=[],u=t.translateToString(!0);let g=0,m=0,h=0,p=t.getFg(0),C=t.getBg(0);for(let w=0;w<t.getTrimmedLength();w++)if(t.loadCell(w,this._workCell),this._workCell.getWidth()!==0){if(this._workCell.fg!==p||this._workCell.bg!==C){if(w-g>1){const y=this._getJoinedRanges(u,h,m,t,g);for(let D=0;D<y.length;D++)o.push(y[D])}g=w,h=m,p=this._workCell.fg,C=this._workCell.bg}m+=this._workCell.getChars().length||n.WHITESPACE_CELL_CHAR.length}if(this._bufferService.cols-g>1){const w=this._getJoinedRanges(u,h,m,t,g);for(let y=0;y<w.length;y++)o.push(w[y])}return o}_getJoinedRanges(r,t,o,u,g){const m=r.substring(t,o);let h=[];try{h=this._characterJoiners[0].handler(m)}catch(p){console.error(p)}for(let p=1;p<this._characterJoiners.length;p++)try{const C=this._characterJoiners[p].handler(m);for(let w=0;w<C.length;w++)te._mergeRanges(h,C[w])}catch(C){console.error(C)}return this._stringRangesToCellRanges(h,u,g),h}_stringRangesToCellRanges(r,t,o){let u=0,g=!1,m=0,h=r[u];if(h){for(let p=o;p<this._bufferService.cols;p++){const C=t.getWidth(p),w=t.getString(p).length||n.WHITESPACE_CELL_CHAR.length;if(C!==0){if(!g&&h[0]<=m&&(h[0]=p,g=!0),h[1]<=m){if(h[1]=p,h=r[++u],!h)break;h[0]<=m?(h[0]=p,g=!0):g=!1}m+=w}}h&&(h[1]=this._bufferService.cols)}}static _mergeRanges(r,t){let o=!1;for(let u=0;u<r.length;u++){const g=r[u];if(o){if(t[1]<=g[0])return r[u-1][1]=t[1],r;if(t[1]<=g[1])return r[u-1][1]=Math.max(t[1],g[1]),r.splice(u,1),r;r.splice(u,1),u--}else{if(t[1]<=g[0])return r.splice(u,0,t),r;if(t[1]<=g[1])return g[0]=Math.min(t[0],g[0]),r;t[0]<g[1]&&(g[0]=Math.min(t[0],g[0]),o=!0)}}return o?r[r.length-1][1]=t[1]:r.push(t),r}};e=_([v(0,d.IBufferService)],e),i.CharacterJoinerService=e},5114:(A,i)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.CoreBrowserService=void 0,i.CoreBrowserService=class{constructor(l,_){this._textarea=l,this.window=_,this._isFocused=!1,this._cachedIsFocused=void 0,this._textarea.addEventListener("focus",()=>this._isFocused=!0),this._textarea.addEventListener("blur",()=>this._isFocused=!1)}get dpr(){return this.window.devicePixelRatio}get isFocused(){return this._cachedIsFocused===void 0&&(this._cachedIsFocused=this._isFocused&&this._textarea.ownerDocument.hasFocus(),queueMicrotask(()=>this._cachedIsFocused=void 0)),this._cachedIsFocused}}},8934:function(A,i,l){var _=this&&this.__decorate||function(d,a,e,s){var r,t=arguments.length,o=t<3?a:s===null?s=Object.getOwnPropertyDescriptor(a,e):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(d,a,e,s);else for(var u=d.length-1;u>=0;u--)(r=d[u])&&(o=(t<3?r(o):t>3?r(a,e,o):r(a,e))||o);return t>3&&o&&Object.defineProperty(a,e,o),o},v=this&&this.__param||function(d,a){return function(e,s){a(e,s,d)}};Object.defineProperty(i,"__esModule",{value:!0}),i.MouseService=void 0;const c=l(4725),n=l(9806);let f=class{constructor(d,a){this._renderService=d,this._charSizeService=a}getCoords(d,a,e,s,r){return(0,n.getCoords)(window,d,a,e,s,this._charSizeService.hasValidSize,this._renderService.dimensions.css.cell.width,this._renderService.dimensions.css.cell.height,r)}getMouseReportCoords(d,a){const e=(0,n.getCoordsRelativeToElement)(window,d,a);if(!(!this._charSizeService.hasValidSize||e[0]<0||e[1]<0||e[0]>=this._renderService.dimensions.css.canvas.width||e[1]>=this._renderService.dimensions.css.canvas.height))return{col:Math.floor(e[0]/this._renderService.dimensions.css.cell.width),row:Math.floor(e[1]/this._renderService.dimensions.css.cell.height),x:Math.floor(e[0]),y:Math.floor(e[1])}}};f=_([v(0,c.IRenderService),v(1,c.ICharSizeService)],f),i.MouseService=f},3230:function(A,i,l){var _=this&&this.__decorate||function(o,u,g,m){var h,p=arguments.length,C=p<3?u:m===null?m=Object.getOwnPropertyDescriptor(u,g):m;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")C=Reflect.decorate(o,u,g,m);else for(var w=o.length-1;w>=0;w--)(h=o[w])&&(C=(p<3?h(C):p>3?h(u,g,C):h(u,g))||C);return p>3&&C&&Object.defineProperty(u,g,C),C},v=this&&this.__param||function(o,u){return function(g,m){u(g,m,o)}};Object.defineProperty(i,"__esModule",{value:!0}),i.RenderService=void 0;const c=l(6193),n=l(8460),f=l(844),d=l(5596),a=l(3656),e=l(2585),s=l(4725),r=l(7226);let t=class extends f.Disposable{constructor(o,u,g,m,h,p,C,w){if(super(),this._rowCount=o,this._charSizeService=m,this._pausedResizeTask=new r.DebouncedIdleTask,this._isPaused=!1,this._needsFullRefresh=!1,this._isNextRenderRedrawOnly=!0,this._needsSelectionRefresh=!1,this._canvasWidth=0,this._canvasHeight=0,this._selectionState={start:void 0,end:void 0,columnSelectMode:!1},this._onDimensionsChange=this.register(new n.EventEmitter),this.onDimensionsChange=this._onDimensionsChange.event,this._onRenderedViewportChange=this.register(new n.EventEmitter),this.onRenderedViewportChange=this._onRenderedViewportChange.event,this._onRender=this.register(new n.EventEmitter),this.onRender=this._onRender.event,this._onRefreshRequest=this.register(new n.EventEmitter),this.onRefreshRequest=this._onRefreshRequest.event,this.register({dispose:()=>{var y;return(y=this._renderer)===null||y===void 0?void 0:y.dispose()}}),this._renderDebouncer=new c.RenderDebouncer(C.window,(y,D)=>this._renderRows(y,D)),this.register(this._renderDebouncer),this._screenDprMonitor=new d.ScreenDprMonitor(C.window),this._screenDprMonitor.setListener(()=>this.handleDevicePixelRatioChange()),this.register(this._screenDprMonitor),this.register(p.onResize(()=>this._fullRefresh())),this.register(p.buffers.onBufferActivate(()=>{var y;return(y=this._renderer)===null||y===void 0?void 0:y.clear()})),this.register(g.onOptionChange(()=>this._handleOptionsChanged())),this.register(this._charSizeService.onCharSizeChange(()=>this.handleCharSizeChanged())),this.register(h.onDecorationRegistered(()=>this._fullRefresh())),this.register(h.onDecorationRemoved(()=>this._fullRefresh())),this.register(g.onMultipleOptionChange(["customGlyphs","drawBoldTextInBrightColors","letterSpacing","lineHeight","fontFamily","fontSize","fontWeight","fontWeightBold","minimumContrastRatio"],()=>{this.clear(),this.handleResize(p.cols,p.rows),this._fullRefresh()})),this.register(g.onMultipleOptionChange(["cursorBlink","cursorStyle"],()=>this.refreshRows(p.buffer.y,p.buffer.y,!0))),this.register((0,a.addDisposableDomListener)(C.window,"resize",()=>this.handleDevicePixelRatioChange())),this.register(w.onChangeColors(()=>this._fullRefresh())),"IntersectionObserver"in C.window){const y=new C.window.IntersectionObserver(D=>this._handleIntersectionChange(D[D.length-1]),{threshold:0});y.observe(u),this.register({dispose:()=>y.disconnect()})}}get dimensions(){return this._renderer.dimensions}_handleIntersectionChange(o){this._isPaused=o.isIntersecting===void 0?o.intersectionRatio===0:!o.isIntersecting,this._isPaused||this._charSizeService.hasValidSize||this._charSizeService.measure(),!this._isPaused&&this._needsFullRefresh&&(this._pausedResizeTask.flush(),this.refreshRows(0,this._rowCount-1),this._needsFullRefresh=!1)}refreshRows(o,u,g=!1){this._isPaused?this._needsFullRefresh=!0:(g||(this._isNextRenderRedrawOnly=!1),this._renderDebouncer.refresh(o,u,this._rowCount))}_renderRows(o,u){this._renderer&&(this._renderer.renderRows(o,u),this._needsSelectionRefresh&&(this._renderer.handleSelectionChanged(this._selectionState.start,this._selectionState.end,this._selectionState.columnSelectMode),this._needsSelectionRefresh=!1),this._isNextRenderRedrawOnly||this._onRenderedViewportChange.fire({start:o,end:u}),this._onRender.fire({start:o,end:u}),this._isNextRenderRedrawOnly=!0)}resize(o,u){this._rowCount=u,this._fireOnCanvasResize()}_handleOptionsChanged(){this._renderer&&(this.refreshRows(0,this._rowCount-1),this._fireOnCanvasResize())}_fireOnCanvasResize(){this._renderer&&(this._renderer.dimensions.css.canvas.width===this._canvasWidth&&this._renderer.dimensions.css.canvas.height===this._canvasHeight||this._onDimensionsChange.fire(this._renderer.dimensions))}hasRenderer(){return!!this._renderer}setRenderer(o){var u;(u=this._renderer)===null||u===void 0||u.dispose(),this._renderer=o,this._renderer.onRequestRedraw(g=>this.refreshRows(g.start,g.end,!0)),this._needsSelectionRefresh=!0,this._fullRefresh()}addRefreshCallback(o){return this._renderDebouncer.addRefreshCallback(o)}_fullRefresh(){this._isPaused?this._needsFullRefresh=!0:this.refreshRows(0,this._rowCount-1)}clearTextureAtlas(){var o,u;this._renderer&&((u=(o=this._renderer).clearTextureAtlas)===null||u===void 0||u.call(o),this._fullRefresh())}handleDevicePixelRatioChange(){this._charSizeService.measure(),this._renderer&&(this._renderer.handleDevicePixelRatioChange(),this.refreshRows(0,this._rowCount-1))}handleResize(o,u){this._renderer&&(this._isPaused?this._pausedResizeTask.set(()=>this._renderer.handleResize(o,u)):this._renderer.handleResize(o,u),this._fullRefresh())}handleCharSizeChanged(){var o;(o=this._renderer)===null||o===void 0||o.handleCharSizeChanged()}handleBlur(){var o;(o=this._renderer)===null||o===void 0||o.handleBlur()}handleFocus(){var o;(o=this._renderer)===null||o===void 0||o.handleFocus()}handleSelectionChanged(o,u,g){var m;this._selectionState.start=o,this._selectionState.end=u,this._selectionState.columnSelectMode=g,(m=this._renderer)===null||m===void 0||m.handleSelectionChanged(o,u,g)}handleCursorMove(){var o;(o=this._renderer)===null||o===void 0||o.handleCursorMove()}clear(){var o;(o=this._renderer)===null||o===void 0||o.clear()}};t=_([v(2,e.IOptionsService),v(3,s.ICharSizeService),v(4,e.IDecorationService),v(5,e.IBufferService),v(6,s.ICoreBrowserService),v(7,s.IThemeService)],t),i.RenderService=t},9312:function(A,i,l){var _=this&&this.__decorate||function(h,p,C,w){var y,D=arguments.length,B=D<3?p:w===null?w=Object.getOwnPropertyDescriptor(p,C):w;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")B=Reflect.decorate(h,p,C,w);else for(var I=h.length-1;I>=0;I--)(y=h[I])&&(B=(D<3?y(B):D>3?y(p,C,B):y(p,C))||B);return D>3&&B&&Object.defineProperty(p,C,B),B},v=this&&this.__param||function(h,p){return function(C,w){p(C,w,h)}};Object.defineProperty(i,"__esModule",{value:!0}),i.SelectionService=void 0;const c=l(6114),n=l(456),f=l(511),d=l(8460),a=l(4725),e=l(2585),s=l(9806),r=l(9504),t=l(844),o=l(4841),u=String.fromCharCode(160),g=new RegExp(u,"g");let m=class extends t.Disposable{constructor(h,p,C,w,y,D,B,I,H){super(),this._element=h,this._screenElement=p,this._linkifier=C,this._bufferService=w,this._coreService=y,this._mouseService=D,this._optionsService=B,this._renderService=I,this._coreBrowserService=H,this._dragScrollAmount=0,this._enabled=!0,this._workCell=new f.CellData,this._mouseDownTimeStamp=0,this._oldHasSelection=!1,this._oldSelectionStart=void 0,this._oldSelectionEnd=void 0,this._onLinuxMouseSelection=this.register(new d.EventEmitter),this.onLinuxMouseSelection=this._onLinuxMouseSelection.event,this._onRedrawRequest=this.register(new d.EventEmitter),this.onRequestRedraw=this._onRedrawRequest.event,this._onSelectionChange=this.register(new d.EventEmitter),this.onSelectionChange=this._onSelectionChange.event,this._onRequestScrollLines=this.register(new d.EventEmitter),this.onRequestScrollLines=this._onRequestScrollLines.event,this._mouseMoveListener=S=>this._handleMouseMove(S),this._mouseUpListener=S=>this._handleMouseUp(S),this._coreService.onUserInput(()=>{this.hasSelection&&this.clearSelection()}),this._trimListener=this._bufferService.buffer.lines.onTrim(S=>this._handleTrim(S)),this.register(this._bufferService.buffers.onBufferActivate(S=>this._handleBufferActivate(S))),this.enable(),this._model=new n.SelectionModel(this._bufferService),this._activeSelectionMode=0,this.register((0,t.toDisposable)(()=>{this._removeMouseDownListeners()}))}reset(){this.clearSelection()}disable(){this.clearSelection(),this._enabled=!1}enable(){this._enabled=!0}get selectionStart(){return this._model.finalSelectionStart}get selectionEnd(){return this._model.finalSelectionEnd}get hasSelection(){const h=this._model.finalSelectionStart,p=this._model.finalSelectionEnd;return!(!h||!p||h[0]===p[0]&&h[1]===p[1])}get selectionText(){const h=this._model.finalSelectionStart,p=this._model.finalSelectionEnd;if(!h||!p)return"";const C=this._bufferService.buffer,w=[];if(this._activeSelectionMode===3){if(h[0]===p[0])return"";const y=h[0]<p[0]?h[0]:p[0],D=h[0]<p[0]?p[0]:h[0];for(let B=h[1];B<=p[1];B++){const I=C.translateBufferLineToString(B,!0,y,D);w.push(I)}}else{const y=h[1]===p[1]?p[0]:void 0;w.push(C.translateBufferLineToString(h[1],!0,h[0],y));for(let D=h[1]+1;D<=p[1]-1;D++){const B=C.lines.get(D),I=C.translateBufferLineToString(D,!0);B!=null&&B.isWrapped?w[w.length-1]+=I:w.push(I)}if(h[1]!==p[1]){const D=C.lines.get(p[1]),B=C.translateBufferLineToString(p[1],!0,0,p[0]);D&&D.isWrapped?w[w.length-1]+=B:w.push(B)}}return w.map(y=>y.replace(g," ")).join(c.isWindows?`\r
`:`
`)}clearSelection(){this._model.clearSelection(),this._removeMouseDownListeners(),this.refresh(),this._onSelectionChange.fire()}refresh(h){this._refreshAnimationFrame||(this._refreshAnimationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>this._refresh())),c.isLinux&&h&&this.selectionText.length&&this._onLinuxMouseSelection.fire(this.selectionText)}_refresh(){this._refreshAnimationFrame=void 0,this._onRedrawRequest.fire({start:this._model.finalSelectionStart,end:this._model.finalSelectionEnd,columnSelectMode:this._activeSelectionMode===3})}_isClickInSelection(h){const p=this._getMouseBufferCoords(h),C=this._model.finalSelectionStart,w=this._model.finalSelectionEnd;return!!(C&&w&&p)&&this._areCoordsInSelection(p,C,w)}isCellInSelection(h,p){const C=this._model.finalSelectionStart,w=this._model.finalSelectionEnd;return!(!C||!w)&&this._areCoordsInSelection([h,p],C,w)}_areCoordsInSelection(h,p,C){return h[1]>p[1]&&h[1]<C[1]||p[1]===C[1]&&h[1]===p[1]&&h[0]>=p[0]&&h[0]<C[0]||p[1]<C[1]&&h[1]===C[1]&&h[0]<C[0]||p[1]<C[1]&&h[1]===p[1]&&h[0]>=p[0]}_selectWordAtCursor(h,p){var C,w;const y=(w=(C=this._linkifier.currentLink)===null||C===void 0?void 0:C.link)===null||w===void 0?void 0:w.range;if(y)return this._model.selectionStart=[y.start.x-1,y.start.y-1],this._model.selectionStartLength=(0,o.getRangeLength)(y,this._bufferService.cols),this._model.selectionEnd=void 0,!0;const D=this._getMouseBufferCoords(h);return!!D&&(this._selectWordAt(D,p),this._model.selectionEnd=void 0,!0)}selectAll(){this._model.isSelectAllActive=!0,this.refresh(),this._onSelectionChange.fire()}selectLines(h,p){this._model.clearSelection(),h=Math.max(h,0),p=Math.min(p,this._bufferService.buffer.lines.length-1),this._model.selectionStart=[0,h],this._model.selectionEnd=[this._bufferService.cols,p],this.refresh(),this._onSelectionChange.fire()}_handleTrim(h){this._model.handleTrim(h)&&this.refresh()}_getMouseBufferCoords(h){const p=this._mouseService.getCoords(h,this._screenElement,this._bufferService.cols,this._bufferService.rows,!0);if(p)return p[0]--,p[1]--,p[1]+=this._bufferService.buffer.ydisp,p}_getMouseEventScrollAmount(h){let p=(0,s.getCoordsRelativeToElement)(this._coreBrowserService.window,h,this._screenElement)[1];const C=this._renderService.dimensions.css.canvas.height;return p>=0&&p<=C?0:(p>C&&(p-=C),p=Math.min(Math.max(p,-50),50),p/=50,p/Math.abs(p)+Math.round(14*p))}shouldForceSelection(h){return c.isMac?h.altKey&&this._optionsService.rawOptions.macOptionClickForcesSelection:h.shiftKey}handleMouseDown(h){if(this._mouseDownTimeStamp=h.timeStamp,(h.button!==2||!this.hasSelection)&&h.button===0){if(!this._enabled){if(!this.shouldForceSelection(h))return;h.stopPropagation()}h.preventDefault(),this._dragScrollAmount=0,this._enabled&&h.shiftKey?this._handleIncrementalClick(h):h.detail===1?this._handleSingleClick(h):h.detail===2?this._handleDoubleClick(h):h.detail===3&&this._handleTripleClick(h),this._addMouseDownListeners(),this.refresh(!0)}}_addMouseDownListeners(){this._screenElement.ownerDocument&&(this._screenElement.ownerDocument.addEventListener("mousemove",this._mouseMoveListener),this._screenElement.ownerDocument.addEventListener("mouseup",this._mouseUpListener)),this._dragScrollIntervalTimer=this._coreBrowserService.window.setInterval(()=>this._dragScroll(),50)}_removeMouseDownListeners(){this._screenElement.ownerDocument&&(this._screenElement.ownerDocument.removeEventListener("mousemove",this._mouseMoveListener),this._screenElement.ownerDocument.removeEventListener("mouseup",this._mouseUpListener)),this._coreBrowserService.window.clearInterval(this._dragScrollIntervalTimer),this._dragScrollIntervalTimer=void 0}_handleIncrementalClick(h){this._model.selectionStart&&(this._model.selectionEnd=this._getMouseBufferCoords(h))}_handleSingleClick(h){if(this._model.selectionStartLength=0,this._model.isSelectAllActive=!1,this._activeSelectionMode=this.shouldColumnSelect(h)?3:0,this._model.selectionStart=this._getMouseBufferCoords(h),!this._model.selectionStart)return;this._model.selectionEnd=void 0;const p=this._bufferService.buffer.lines.get(this._model.selectionStart[1]);p&&p.length!==this._model.selectionStart[0]&&p.hasWidth(this._model.selectionStart[0])===0&&this._model.selectionStart[0]++}_handleDoubleClick(h){this._selectWordAtCursor(h,!0)&&(this._activeSelectionMode=1)}_handleTripleClick(h){const p=this._getMouseBufferCoords(h);p&&(this._activeSelectionMode=2,this._selectLineAt(p[1]))}shouldColumnSelect(h){return h.altKey&&!(c.isMac&&this._optionsService.rawOptions.macOptionClickForcesSelection)}_handleMouseMove(h){if(h.stopImmediatePropagation(),!this._model.selectionStart)return;const p=this._model.selectionEnd?[this._model.selectionEnd[0],this._model.selectionEnd[1]]:null;if(this._model.selectionEnd=this._getMouseBufferCoords(h),!this._model.selectionEnd)return void this.refresh(!0);this._activeSelectionMode===2?this._model.selectionEnd[1]<this._model.selectionStart[1]?this._model.selectionEnd[0]=0:this._model.selectionEnd[0]=this._bufferService.cols:this._activeSelectionMode===1&&this._selectToWordAt(this._model.selectionEnd),this._dragScrollAmount=this._getMouseEventScrollAmount(h),this._activeSelectionMode!==3&&(this._dragScrollAmount>0?this._model.selectionEnd[0]=this._bufferService.cols:this._dragScrollAmount<0&&(this._model.selectionEnd[0]=0));const C=this._bufferService.buffer;if(this._model.selectionEnd[1]<C.lines.length){const w=C.lines.get(this._model.selectionEnd[1]);w&&w.hasWidth(this._model.selectionEnd[0])===0&&this._model.selectionEnd[0]++}p&&p[0]===this._model.selectionEnd[0]&&p[1]===this._model.selectionEnd[1]||this.refresh(!0)}_dragScroll(){if(this._model.selectionEnd&&this._model.selectionStart&&this._dragScrollAmount){this._onRequestScrollLines.fire({amount:this._dragScrollAmount,suppressScrollEvent:!1});const h=this._bufferService.buffer;this._dragScrollAmount>0?(this._activeSelectionMode!==3&&(this._model.selectionEnd[0]=this._bufferService.cols),this._model.selectionEnd[1]=Math.min(h.ydisp+this._bufferService.rows,h.lines.length-1)):(this._activeSelectionMode!==3&&(this._model.selectionEnd[0]=0),this._model.selectionEnd[1]=h.ydisp),this.refresh()}}_handleMouseUp(h){const p=h.timeStamp-this._mouseDownTimeStamp;if(this._removeMouseDownListeners(),this.selectionText.length<=1&&p<500&&h.altKey&&this._optionsService.rawOptions.altClickMovesCursor){if(this._bufferService.buffer.ybase===this._bufferService.buffer.ydisp){const C=this._mouseService.getCoords(h,this._element,this._bufferService.cols,this._bufferService.rows,!1);if(C&&C[0]!==void 0&&C[1]!==void 0){const w=(0,r.moveToCellSequence)(C[0]-1,C[1]-1,this._bufferService,this._coreService.decPrivateModes.applicationCursorKeys);this._coreService.triggerDataEvent(w,!0)}}}else this._fireEventIfSelectionChanged()}_fireEventIfSelectionChanged(){const h=this._model.finalSelectionStart,p=this._model.finalSelectionEnd,C=!(!h||!p||h[0]===p[0]&&h[1]===p[1]);C?h&&p&&(this._oldSelectionStart&&this._oldSelectionEnd&&h[0]===this._oldSelectionStart[0]&&h[1]===this._oldSelectionStart[1]&&p[0]===this._oldSelectionEnd[0]&&p[1]===this._oldSelectionEnd[1]||this._fireOnSelectionChange(h,p,C)):this._oldHasSelection&&this._fireOnSelectionChange(h,p,C)}_fireOnSelectionChange(h,p,C){this._oldSelectionStart=h,this._oldSelectionEnd=p,this._oldHasSelection=C,this._onSelectionChange.fire()}_handleBufferActivate(h){this.clearSelection(),this._trimListener.dispose(),this._trimListener=h.activeBuffer.lines.onTrim(p=>this._handleTrim(p))}_convertViewportColToCharacterIndex(h,p){let C=p;for(let w=0;p>=w;w++){const y=h.loadCell(w,this._workCell).getChars().length;this._workCell.getWidth()===0?C--:y>1&&p!==w&&(C+=y-1)}return C}setSelection(h,p,C){this._model.clearSelection(),this._removeMouseDownListeners(),this._model.selectionStart=[h,p],this._model.selectionStartLength=C,this.refresh(),this._fireEventIfSelectionChanged()}rightClickSelect(h){this._isClickInSelection(h)||(this._selectWordAtCursor(h,!1)&&this.refresh(!0),this._fireEventIfSelectionChanged())}_getWordAt(h,p,C=!0,w=!0){if(h[0]>=this._bufferService.cols)return;const y=this._bufferService.buffer,D=y.lines.get(h[1]);if(!D)return;const B=y.translateBufferLineToString(h[1],!1);let I=this._convertViewportColToCharacterIndex(D,h[0]),H=I;const S=h[0]-I;let b=0,L=0,R=0,M=0;if(B.charAt(I)===" "){for(;I>0&&B.charAt(I-1)===" ";)I--;for(;H<B.length&&B.charAt(H+1)===" ";)H++}else{let O=h[0],W=h[0];D.getWidth(O)===0&&(b++,O--),D.getWidth(W)===2&&(L++,W++);const k=D.getString(W).length;for(k>1&&(M+=k-1,H+=k-1);O>0&&I>0&&!this._isCharWordSeparator(D.loadCell(O-1,this._workCell));){D.loadCell(O-1,this._workCell);const E=this._workCell.getChars().length;this._workCell.getWidth()===0?(b++,O--):E>1&&(R+=E-1,I-=E-1),I--,O--}for(;W<D.length&&H+1<B.length&&!this._isCharWordSeparator(D.loadCell(W+1,this._workCell));){D.loadCell(W+1,this._workCell);const E=this._workCell.getChars().length;this._workCell.getWidth()===2?(L++,W++):E>1&&(M+=E-1,H+=E-1),H++,W++}}H++;let F=I+S-b+R,N=Math.min(this._bufferService.cols,H-I+b+L-R-M);if(p||B.slice(I,H).trim()!==""){if(C&&F===0&&D.getCodePoint(0)!==32){const O=y.lines.get(h[1]-1);if(O&&D.isWrapped&&O.getCodePoint(this._bufferService.cols-1)!==32){const W=this._getWordAt([this._bufferService.cols-1,h[1]-1],!1,!0,!1);if(W){const k=this._bufferService.cols-W.start;F-=k,N+=k}}}if(w&&F+N===this._bufferService.cols&&D.getCodePoint(this._bufferService.cols-1)!==32){const O=y.lines.get(h[1]+1);if(O!=null&&O.isWrapped&&O.getCodePoint(0)!==32){const W=this._getWordAt([0,h[1]+1],!1,!1,!0);W&&(N+=W.length)}}return{start:F,length:N}}}_selectWordAt(h,p){const C=this._getWordAt(h,p);if(C){for(;C.start<0;)C.start+=this._bufferService.cols,h[1]--;this._model.selectionStart=[C.start,h[1]],this._model.selectionStartLength=C.length}}_selectToWordAt(h){const p=this._getWordAt(h,!0);if(p){let C=h[1];for(;p.start<0;)p.start+=this._bufferService.cols,C--;if(!this._model.areSelectionValuesReversed())for(;p.start+p.length>this._bufferService.cols;)p.length-=this._bufferService.cols,C++;this._model.selectionEnd=[this._model.areSelectionValuesReversed()?p.start:p.start+p.length,C]}}_isCharWordSeparator(h){return h.getWidth()!==0&&this._optionsService.rawOptions.wordSeparator.indexOf(h.getChars())>=0}_selectLineAt(h){const p=this._bufferService.buffer.getWrappedRangeForLine(h),C={start:{x:0,y:p.first},end:{x:this._bufferService.cols-1,y:p.last}};this._model.selectionStart=[0,p.first],this._model.selectionEnd=void 0,this._model.selectionStartLength=(0,o.getRangeLength)(C,this._bufferService.cols)}};m=_([v(3,e.IBufferService),v(4,e.ICoreService),v(5,a.IMouseService),v(6,e.IOptionsService),v(7,a.IRenderService),v(8,a.ICoreBrowserService)],m),i.SelectionService=m},4725:(A,i,l)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.IThemeService=i.ICharacterJoinerService=i.ISelectionService=i.IRenderService=i.IMouseService=i.ICoreBrowserService=i.ICharSizeService=void 0;const _=l(8343);i.ICharSizeService=(0,_.createDecorator)("CharSizeService"),i.ICoreBrowserService=(0,_.createDecorator)("CoreBrowserService"),i.IMouseService=(0,_.createDecorator)("MouseService"),i.IRenderService=(0,_.createDecorator)("RenderService"),i.ISelectionService=(0,_.createDecorator)("SelectionService"),i.ICharacterJoinerService=(0,_.createDecorator)("CharacterJoinerService"),i.IThemeService=(0,_.createDecorator)("ThemeService")},6731:function(A,i,l){var _=this&&this.__decorate||function(m,h,p,C){var w,y=arguments.length,D=y<3?h:C===null?C=Object.getOwnPropertyDescriptor(h,p):C;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")D=Reflect.decorate(m,h,p,C);else for(var B=m.length-1;B>=0;B--)(w=m[B])&&(D=(y<3?w(D):y>3?w(h,p,D):w(h,p))||D);return y>3&&D&&Object.defineProperty(h,p,D),D},v=this&&this.__param||function(m,h){return function(p,C){h(p,C,m)}};Object.defineProperty(i,"__esModule",{value:!0}),i.ThemeService=i.DEFAULT_ANSI_COLORS=void 0;const c=l(7239),n=l(8055),f=l(8460),d=l(844),a=l(2585),e=n.css.toColor("#ffffff"),s=n.css.toColor("#000000"),r=n.css.toColor("#ffffff"),t=n.css.toColor("#000000"),o={css:"rgba(255, 255, 255, 0.3)",rgba:4294967117};i.DEFAULT_ANSI_COLORS=Object.freeze((()=>{const m=[n.css.toColor("#2e3436"),n.css.toColor("#cc0000"),n.css.toColor("#4e9a06"),n.css.toColor("#c4a000"),n.css.toColor("#3465a4"),n.css.toColor("#75507b"),n.css.toColor("#06989a"),n.css.toColor("#d3d7cf"),n.css.toColor("#555753"),n.css.toColor("#ef2929"),n.css.toColor("#8ae234"),n.css.toColor("#fce94f"),n.css.toColor("#729fcf"),n.css.toColor("#ad7fa8"),n.css.toColor("#34e2e2"),n.css.toColor("#eeeeec")],h=[0,95,135,175,215,255];for(let p=0;p<216;p++){const C=h[p/36%6|0],w=h[p/6%6|0],y=h[p%6];m.push({css:n.channels.toCss(C,w,y),rgba:n.channels.toRgba(C,w,y)})}for(let p=0;p<24;p++){const C=8+10*p;m.push({css:n.channels.toCss(C,C,C),rgba:n.channels.toRgba(C,C,C)})}return m})());let u=class extends d.Disposable{constructor(m){super(),this._optionsService=m,this._onChangeColors=this.register(new f.EventEmitter),this.onChangeColors=this._onChangeColors.event,this._contrastCache=new c.ColorContrastCache,this._colors={foreground:e,background:s,cursor:r,cursorAccent:t,selectionForeground:void 0,selectionBackgroundTransparent:o,selectionBackgroundOpaque:n.color.blend(s,o),selectionInactiveBackgroundTransparent:o,selectionInactiveBackgroundOpaque:n.color.blend(s,o),ansi:i.DEFAULT_ANSI_COLORS.slice(),contrastCache:this._contrastCache},this._updateRestoreColors(),this._setTheme(this._optionsService.rawOptions.theme),this.register(this._optionsService.onSpecificOptionChange("minimumContrastRatio",()=>this._contrastCache.clear())),this.register(this._optionsService.onSpecificOptionChange("theme",()=>this._setTheme(this._optionsService.rawOptions.theme)))}get colors(){return this._colors}_setTheme(m={}){const h=this._colors;if(h.foreground=g(m.foreground,e),h.background=g(m.background,s),h.cursor=g(m.cursor,r),h.cursorAccent=g(m.cursorAccent,t),h.selectionBackgroundTransparent=g(m.selectionBackground,o),h.selectionBackgroundOpaque=n.color.blend(h.background,h.selectionBackgroundTransparent),h.selectionInactiveBackgroundTransparent=g(m.selectionInactiveBackground,h.selectionBackgroundTransparent),h.selectionInactiveBackgroundOpaque=n.color.blend(h.background,h.selectionInactiveBackgroundTransparent),h.selectionForeground=m.selectionForeground?g(m.selectionForeground,n.NULL_COLOR):void 0,h.selectionForeground===n.NULL_COLOR&&(h.selectionForeground=void 0),n.color.isOpaque(h.selectionBackgroundTransparent)&&(h.selectionBackgroundTransparent=n.color.opacity(h.selectionBackgroundTransparent,.3)),n.color.isOpaque(h.selectionInactiveBackgroundTransparent)&&(h.selectionInactiveBackgroundTransparent=n.color.opacity(h.selectionInactiveBackgroundTransparent,.3)),h.ansi=i.DEFAULT_ANSI_COLORS.slice(),h.ansi[0]=g(m.black,i.DEFAULT_ANSI_COLORS[0]),h.ansi[1]=g(m.red,i.DEFAULT_ANSI_COLORS[1]),h.ansi[2]=g(m.green,i.DEFAULT_ANSI_COLORS[2]),h.ansi[3]=g(m.yellow,i.DEFAULT_ANSI_COLORS[3]),h.ansi[4]=g(m.blue,i.DEFAULT_ANSI_COLORS[4]),h.ansi[5]=g(m.magenta,i.DEFAULT_ANSI_COLORS[5]),h.ansi[6]=g(m.cyan,i.DEFAULT_ANSI_COLORS[6]),h.ansi[7]=g(m.white,i.DEFAULT_ANSI_COLORS[7]),h.ansi[8]=g(m.brightBlack,i.DEFAULT_ANSI_COLORS[8]),h.ansi[9]=g(m.brightRed,i.DEFAULT_ANSI_COLORS[9]),h.ansi[10]=g(m.brightGreen,i.DEFAULT_ANSI_COLORS[10]),h.ansi[11]=g(m.brightYellow,i.DEFAULT_ANSI_COLORS[11]),h.ansi[12]=g(m.brightBlue,i.DEFAULT_ANSI_COLORS[12]),h.ansi[13]=g(m.brightMagenta,i.DEFAULT_ANSI_COLORS[13]),h.ansi[14]=g(m.brightCyan,i.DEFAULT_ANSI_COLORS[14]),h.ansi[15]=g(m.brightWhite,i.DEFAULT_ANSI_COLORS[15]),m.extendedAnsi){const p=Math.min(h.ansi.length-16,m.extendedAnsi.length);for(let C=0;C<p;C++)h.ansi[C+16]=g(m.extendedAnsi[C],i.DEFAULT_ANSI_COLORS[C+16])}this._contrastCache.clear(),this._updateRestoreColors(),this._onChangeColors.fire(this.colors)}restoreColor(m){this._restoreColor(m),this._onChangeColors.fire(this.colors)}_restoreColor(m){if(m!==void 0)switch(m){case 256:this._colors.foreground=this._restoreColors.foreground;break;case 257:this._colors.background=this._restoreColors.background;break;case 258:this._colors.cursor=this._restoreColors.cursor;break;default:this._colors.ansi[m]=this._restoreColors.ansi[m]}else for(let h=0;h<this._restoreColors.ansi.length;++h)this._colors.ansi[h]=this._restoreColors.ansi[h]}modifyColors(m){m(this._colors),this._onChangeColors.fire(this.colors)}_updateRestoreColors(){this._restoreColors={foreground:this._colors.foreground,background:this._colors.background,cursor:this._colors.cursor,ansi:this._colors.ansi.slice()}}};function g(m,h){if(m!==void 0)try{return n.css.toColor(m)}catch{}return h}u=_([v(0,a.IOptionsService)],u),i.ThemeService=u},6349:(A,i,l)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.CircularList=void 0;const _=l(8460),v=l(844);class c extends v.Disposable{constructor(f){super(),this._maxLength=f,this.onDeleteEmitter=this.register(new _.EventEmitter),this.onDelete=this.onDeleteEmitter.event,this.onInsertEmitter=this.register(new _.EventEmitter),this.onInsert=this.onInsertEmitter.event,this.onTrimEmitter=this.register(new _.EventEmitter),this.onTrim=this.onTrimEmitter.event,this._array=new Array(this._maxLength),this._startIndex=0,this._length=0}get maxLength(){return this._maxLength}set maxLength(f){if(this._maxLength===f)return;const d=new Array(f);for(let a=0;a<Math.min(f,this.length);a++)d[a]=this._array[this._getCyclicIndex(a)];this._array=d,this._maxLength=f,this._startIndex=0}get length(){return this._length}set length(f){if(f>this._length)for(let d=this._length;d<f;d++)this._array[d]=void 0;this._length=f}get(f){return this._array[this._getCyclicIndex(f)]}set(f,d){this._array[this._getCyclicIndex(f)]=d}push(f){this._array[this._getCyclicIndex(this._length)]=f,this._length===this._maxLength?(this._startIndex=++this._startIndex%this._maxLength,this.onTrimEmitter.fire(1)):this._length++}recycle(){if(this._length!==this._maxLength)throw new Error("Can only recycle when the buffer is full");return this._startIndex=++this._startIndex%this._maxLength,this.onTrimEmitter.fire(1),this._array[this._getCyclicIndex(this._length-1)]}get isFull(){return this._length===this._maxLength}pop(){return this._array[this._getCyclicIndex(this._length---1)]}splice(f,d,...a){if(d){for(let e=f;e<this._length-d;e++)this._array[this._getCyclicIndex(e)]=this._array[this._getCyclicIndex(e+d)];this._length-=d,this.onDeleteEmitter.fire({index:f,amount:d})}for(let e=this._length-1;e>=f;e--)this._array[this._getCyclicIndex(e+a.length)]=this._array[this._getCyclicIndex(e)];for(let e=0;e<a.length;e++)this._array[this._getCyclicIndex(f+e)]=a[e];if(a.length&&this.onInsertEmitter.fire({index:f,amount:a.length}),this._length+a.length>this._maxLength){const e=this._length+a.length-this._maxLength;this._startIndex+=e,this._length=this._maxLength,this.onTrimEmitter.fire(e)}else this._length+=a.length}trimStart(f){f>this._length&&(f=this._length),this._startIndex+=f,this._length-=f,this.onTrimEmitter.fire(f)}shiftElements(f,d,a){if(!(d<=0)){if(f<0||f>=this._length)throw new Error("start argument out of range");if(f+a<0)throw new Error("Cannot shift elements in list beyond index 0");if(a>0){for(let s=d-1;s>=0;s--)this.set(f+s+a,this.get(f+s));const e=f+d+a-this._length;if(e>0)for(this._length+=e;this._length>this._maxLength;)this._length--,this._startIndex++,this.onTrimEmitter.fire(1)}else for(let e=0;e<d;e++)this.set(f+e+a,this.get(f+e))}}_getCyclicIndex(f){return(this._startIndex+f)%this._maxLength}}i.CircularList=c},1439:(A,i)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.clone=void 0,i.clone=function l(_,v=5){if(typeof _!="object")return _;const c=Array.isArray(_)?[]:{};for(const n in _)c[n]=v<=1?_[n]:_[n]&&l(_[n],v-1);return c}},8055:(A,i,l)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.contrastRatio=i.toPaddedHex=i.rgba=i.rgb=i.css=i.color=i.channels=i.NULL_COLOR=void 0;const _=l(6114);let v=0,c=0,n=0,f=0;var d,a,e;function s(t){const o=t.toString(16);return o.length<2?"0"+o:o}function r(t,o){return t<o?(o+.05)/(t+.05):(t+.05)/(o+.05)}i.NULL_COLOR={css:"#00000000",rgba:0},function(t){t.toCss=function(o,u,g,m){return m!==void 0?`#${s(o)}${s(u)}${s(g)}${s(m)}`:`#${s(o)}${s(u)}${s(g)}`},t.toRgba=function(o,u,g,m=255){return(o<<24|u<<16|g<<8|m)>>>0}}(d=i.channels||(i.channels={})),function(t){function o(u,g){return f=Math.round(255*g),[v,c,n]=e.toChannels(u.rgba),{css:d.toCss(v,c,n,f),rgba:d.toRgba(v,c,n,f)}}t.blend=function(u,g){if(f=(255&g.rgba)/255,f===1)return{css:g.css,rgba:g.rgba};const m=g.rgba>>24&255,h=g.rgba>>16&255,p=g.rgba>>8&255,C=u.rgba>>24&255,w=u.rgba>>16&255,y=u.rgba>>8&255;return v=C+Math.round((m-C)*f),c=w+Math.round((h-w)*f),n=y+Math.round((p-y)*f),{css:d.toCss(v,c,n),rgba:d.toRgba(v,c,n)}},t.isOpaque=function(u){return(255&u.rgba)==255},t.ensureContrastRatio=function(u,g,m){const h=e.ensureContrastRatio(u.rgba,g.rgba,m);if(h)return e.toColor(h>>24&255,h>>16&255,h>>8&255)},t.opaque=function(u){const g=(255|u.rgba)>>>0;return[v,c,n]=e.toChannels(g),{css:d.toCss(v,c,n),rgba:g}},t.opacity=o,t.multiplyOpacity=function(u,g){return f=255&u.rgba,o(u,f*g/255)},t.toColorRGB=function(u){return[u.rgba>>24&255,u.rgba>>16&255,u.rgba>>8&255]}}(i.color||(i.color={})),function(t){let o,u;if(!_.isNode){const g=document.createElement("canvas");g.width=1,g.height=1;const m=g.getContext("2d",{willReadFrequently:!0});m&&(o=m,o.globalCompositeOperation="copy",u=o.createLinearGradient(0,0,1,1))}t.toColor=function(g){if(g.match(/#[\da-f]{3,8}/i))switch(g.length){case 4:return v=parseInt(g.slice(1,2).repeat(2),16),c=parseInt(g.slice(2,3).repeat(2),16),n=parseInt(g.slice(3,4).repeat(2),16),e.toColor(v,c,n);case 5:return v=parseInt(g.slice(1,2).repeat(2),16),c=parseInt(g.slice(2,3).repeat(2),16),n=parseInt(g.slice(3,4).repeat(2),16),f=parseInt(g.slice(4,5).repeat(2),16),e.toColor(v,c,n,f);case 7:return{css:g,rgba:(parseInt(g.slice(1),16)<<8|255)>>>0};case 9:return{css:g,rgba:parseInt(g.slice(1),16)>>>0}}const m=g.match(/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(,\s*(0|1|\d?\.(\d+))\s*)?\)/);if(m)return v=parseInt(m[1]),c=parseInt(m[2]),n=parseInt(m[3]),f=Math.round(255*(m[5]===void 0?1:parseFloat(m[5]))),e.toColor(v,c,n,f);if(!o||!u)throw new Error("css.toColor: Unsupported css format");if(o.fillStyle=u,o.fillStyle=g,typeof o.fillStyle!="string")throw new Error("css.toColor: Unsupported css format");if(o.fillRect(0,0,1,1),[v,c,n,f]=o.getImageData(0,0,1,1).data,f!==255)throw new Error("css.toColor: Unsupported css format");return{rgba:d.toRgba(v,c,n,f),css:g}}}(i.css||(i.css={})),function(t){function o(u,g,m){const h=u/255,p=g/255,C=m/255;return .2126*(h<=.03928?h/12.92:Math.pow((h+.055)/1.055,2.4))+.7152*(p<=.03928?p/12.92:Math.pow((p+.055)/1.055,2.4))+.0722*(C<=.03928?C/12.92:Math.pow((C+.055)/1.055,2.4))}t.relativeLuminance=function(u){return o(u>>16&255,u>>8&255,255&u)},t.relativeLuminance2=o}(a=i.rgb||(i.rgb={})),function(t){function o(g,m,h){const p=g>>24&255,C=g>>16&255,w=g>>8&255;let y=m>>24&255,D=m>>16&255,B=m>>8&255,I=r(a.relativeLuminance2(y,D,B),a.relativeLuminance2(p,C,w));for(;I<h&&(y>0||D>0||B>0);)y-=Math.max(0,Math.ceil(.1*y)),D-=Math.max(0,Math.ceil(.1*D)),B-=Math.max(0,Math.ceil(.1*B)),I=r(a.relativeLuminance2(y,D,B),a.relativeLuminance2(p,C,w));return(y<<24|D<<16|B<<8|255)>>>0}function u(g,m,h){const p=g>>24&255,C=g>>16&255,w=g>>8&255;let y=m>>24&255,D=m>>16&255,B=m>>8&255,I=r(a.relativeLuminance2(y,D,B),a.relativeLuminance2(p,C,w));for(;I<h&&(y<255||D<255||B<255);)y=Math.min(255,y+Math.ceil(.1*(255-y))),D=Math.min(255,D+Math.ceil(.1*(255-D))),B=Math.min(255,B+Math.ceil(.1*(255-B))),I=r(a.relativeLuminance2(y,D,B),a.relativeLuminance2(p,C,w));return(y<<24|D<<16|B<<8|255)>>>0}t.ensureContrastRatio=function(g,m,h){const p=a.relativeLuminance(g>>8),C=a.relativeLuminance(m>>8);if(r(p,C)<h){if(C<p){const D=o(g,m,h),B=r(p,a.relativeLuminance(D>>8));if(B<h){const I=u(g,m,h);return B>r(p,a.relativeLuminance(I>>8))?D:I}return D}const w=u(g,m,h),y=r(p,a.relativeLuminance(w>>8));if(y<h){const D=o(g,m,h);return y>r(p,a.relativeLuminance(D>>8))?w:D}return w}},t.reduceLuminance=o,t.increaseLuminance=u,t.toChannels=function(g){return[g>>24&255,g>>16&255,g>>8&255,255&g]},t.toColor=function(g,m,h,p){return{css:d.toCss(g,m,h,p),rgba:d.toRgba(g,m,h,p)}}}(e=i.rgba||(i.rgba={})),i.toPaddedHex=s,i.contrastRatio=r},8969:(A,i,l)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.CoreTerminal=void 0;const _=l(844),v=l(2585),c=l(4348),n=l(7866),f=l(744),d=l(7302),a=l(6975),e=l(8460),s=l(1753),r=l(1480),t=l(7994),o=l(9282),u=l(5435),g=l(5981),m=l(2660);let h=!1;class p extends _.Disposable{constructor(w){super(),this._onBinary=this.register(new e.EventEmitter),this.onBinary=this._onBinary.event,this._onData=this.register(new e.EventEmitter),this.onData=this._onData.event,this._onLineFeed=this.register(new e.EventEmitter),this.onLineFeed=this._onLineFeed.event,this._onResize=this.register(new e.EventEmitter),this.onResize=this._onResize.event,this._onWriteParsed=this.register(new e.EventEmitter),this.onWriteParsed=this._onWriteParsed.event,this._onScroll=this.register(new e.EventEmitter),this._instantiationService=new c.InstantiationService,this.optionsService=this.register(new d.OptionsService(w)),this._instantiationService.setService(v.IOptionsService,this.optionsService),this._bufferService=this.register(this._instantiationService.createInstance(f.BufferService)),this._instantiationService.setService(v.IBufferService,this._bufferService),this._logService=this.register(this._instantiationService.createInstance(n.LogService)),this._instantiationService.setService(v.ILogService,this._logService),this.coreService=this.register(this._instantiationService.createInstance(a.CoreService)),this._instantiationService.setService(v.ICoreService,this.coreService),this.coreMouseService=this.register(this._instantiationService.createInstance(s.CoreMouseService)),this._instantiationService.setService(v.ICoreMouseService,this.coreMouseService),this.unicodeService=this.register(this._instantiationService.createInstance(r.UnicodeService)),this._instantiationService.setService(v.IUnicodeService,this.unicodeService),this._charsetService=this._instantiationService.createInstance(t.CharsetService),this._instantiationService.setService(v.ICharsetService,this._charsetService),this._oscLinkService=this._instantiationService.createInstance(m.OscLinkService),this._instantiationService.setService(v.IOscLinkService,this._oscLinkService),this._inputHandler=this.register(new u.InputHandler(this._bufferService,this._charsetService,this.coreService,this._logService,this.optionsService,this._oscLinkService,this.coreMouseService,this.unicodeService)),this.register((0,e.forwardEvent)(this._inputHandler.onLineFeed,this._onLineFeed)),this.register(this._inputHandler),this.register((0,e.forwardEvent)(this._bufferService.onResize,this._onResize)),this.register((0,e.forwardEvent)(this.coreService.onData,this._onData)),this.register((0,e.forwardEvent)(this.coreService.onBinary,this._onBinary)),this.register(this.coreService.onRequestScrollToBottom(()=>this.scrollToBottom())),this.register(this.coreService.onUserInput(()=>this._writeBuffer.handleUserInput())),this.register(this.optionsService.onSpecificOptionChange("windowsMode",y=>this._handleWindowsModeOptionChange(y))),this.register(this._bufferService.onScroll(y=>{this._onScroll.fire({position:this._bufferService.buffer.ydisp,source:0}),this._inputHandler.markRangeDirty(this._bufferService.buffer.scrollTop,this._bufferService.buffer.scrollBottom)})),this.register(this._inputHandler.onScroll(y=>{this._onScroll.fire({position:this._bufferService.buffer.ydisp,source:0}),this._inputHandler.markRangeDirty(this._bufferService.buffer.scrollTop,this._bufferService.buffer.scrollBottom)})),this._writeBuffer=this.register(new g.WriteBuffer((y,D)=>this._inputHandler.parse(y,D))),this.register((0,e.forwardEvent)(this._writeBuffer.onWriteParsed,this._onWriteParsed)),this.register((0,_.toDisposable)(()=>{var y;(y=this._windowsMode)===null||y===void 0||y.dispose(),this._windowsMode=void 0}))}get onScroll(){return this._onScrollApi||(this._onScrollApi=this.register(new e.EventEmitter),this._onScroll.event(w=>{var y;(y=this._onScrollApi)===null||y===void 0||y.fire(w.position)})),this._onScrollApi.event}get cols(){return this._bufferService.cols}get rows(){return this._bufferService.rows}get buffers(){return this._bufferService.buffers}get options(){return this.optionsService.options}set options(w){for(const y in w)this.optionsService.options[y]=w[y]}write(w,y){this._writeBuffer.write(w,y)}writeSync(w,y){this._logService.logLevel<=v.LogLevelEnum.WARN&&!h&&(this._logService.warn("writeSync is unreliable and will be removed soon."),h=!0),this._writeBuffer.writeSync(w,y)}resize(w,y){isNaN(w)||isNaN(y)||(w=Math.max(w,f.MINIMUM_COLS),y=Math.max(y,f.MINIMUM_ROWS),this._bufferService.resize(w,y))}scroll(w,y=!1){this._bufferService.scroll(w,y)}scrollLines(w,y,D){this._bufferService.scrollLines(w,y,D)}scrollPages(w){this._bufferService.scrollPages(w)}scrollToTop(){this._bufferService.scrollToTop()}scrollToBottom(){this._bufferService.scrollToBottom()}scrollToLine(w){this._bufferService.scrollToLine(w)}registerEscHandler(w,y){return this._inputHandler.registerEscHandler(w,y)}registerDcsHandler(w,y){return this._inputHandler.registerDcsHandler(w,y)}registerCsiHandler(w,y){return this._inputHandler.registerCsiHandler(w,y)}registerOscHandler(w,y){return this._inputHandler.registerOscHandler(w,y)}_setup(){this.optionsService.rawOptions.windowsMode&&this._enableWindowsMode()}reset(){this._inputHandler.reset(),this._bufferService.reset(),this._charsetService.reset(),this.coreService.reset(),this.coreMouseService.reset()}_handleWindowsModeOptionChange(w){var y;w?this._enableWindowsMode():((y=this._windowsMode)===null||y===void 0||y.dispose(),this._windowsMode=void 0)}_enableWindowsMode(){if(!this._windowsMode){const w=[];w.push(this.onLineFeed(o.updateWindowsModeWrappedState.bind(null,this._bufferService))),w.push(this.registerCsiHandler({final:"H"},()=>((0,o.updateWindowsModeWrappedState)(this._bufferService),!1))),this._windowsMode={dispose:()=>{for(const y of w)y.dispose()}}}}}i.CoreTerminal=p},8460:(A,i)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.forwardEvent=i.EventEmitter=void 0,i.EventEmitter=class{constructor(){this._listeners=[],this._disposed=!1}get event(){return this._event||(this._event=l=>(this._listeners.push(l),{dispose:()=>{if(!this._disposed){for(let _=0;_<this._listeners.length;_++)if(this._listeners[_]===l)return void this._listeners.splice(_,1)}}})),this._event}fire(l,_){const v=[];for(let c=0;c<this._listeners.length;c++)v.push(this._listeners[c]);for(let c=0;c<v.length;c++)v[c].call(void 0,l,_)}dispose(){this._listeners&&(this._listeners.length=0),this._disposed=!0}},i.forwardEvent=function(l,_){return l(v=>_.fire(v))}},5435:function(A,i,l){var _=this&&this.__decorate||function(H,S,b,L){var R,M=arguments.length,F=M<3?S:L===null?L=Object.getOwnPropertyDescriptor(S,b):L;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")F=Reflect.decorate(H,S,b,L);else for(var N=H.length-1;N>=0;N--)(R=H[N])&&(F=(M<3?R(F):M>3?R(S,b,F):R(S,b))||F);return M>3&&F&&Object.defineProperty(S,b,F),F},v=this&&this.__param||function(H,S){return function(b,L){S(b,L,H)}};Object.defineProperty(i,"__esModule",{value:!0}),i.InputHandler=i.WindowsOptionsReportType=void 0;const c=l(2584),n=l(7116),f=l(2015),d=l(844),a=l(482),e=l(8437),s=l(8460),r=l(643),t=l(511),o=l(3734),u=l(2585),g=l(6242),m=l(6351),h=l(5941),p={"(":0,")":1,"*":2,"+":3,"-":1,".":2},C=131072;function w(H,S){if(H>24)return S.setWinLines||!1;switch(H){case 1:return!!S.restoreWin;case 2:return!!S.minimizeWin;case 3:return!!S.setWinPosition;case 4:return!!S.setWinSizePixels;case 5:return!!S.raiseWin;case 6:return!!S.lowerWin;case 7:return!!S.refreshWin;case 8:return!!S.setWinSizeChars;case 9:return!!S.maximizeWin;case 10:return!!S.fullscreenWin;case 11:return!!S.getWinState;case 13:return!!S.getWinPosition;case 14:return!!S.getWinSizePixels;case 15:return!!S.getScreenSizePixels;case 16:return!!S.getCellSizePixels;case 18:return!!S.getWinSizeChars;case 19:return!!S.getScreenSizeChars;case 20:return!!S.getIconTitle;case 21:return!!S.getWinTitle;case 22:return!!S.pushTitle;case 23:return!!S.popTitle;case 24:return!!S.setWinLines}return!1}var y;(function(H){H[H.GET_WIN_SIZE_PIXELS=0]="GET_WIN_SIZE_PIXELS",H[H.GET_CELL_SIZE_PIXELS=1]="GET_CELL_SIZE_PIXELS"})(y=i.WindowsOptionsReportType||(i.WindowsOptionsReportType={}));let D=0;class B extends d.Disposable{constructor(S,b,L,R,M,F,N,O,W=new f.EscapeSequenceParser){super(),this._bufferService=S,this._charsetService=b,this._coreService=L,this._logService=R,this._optionsService=M,this._oscLinkService=F,this._coreMouseService=N,this._unicodeService=O,this._parser=W,this._parseBuffer=new Uint32Array(4096),this._stringDecoder=new a.StringToUtf32,this._utf8Decoder=new a.Utf8ToUtf32,this._workCell=new t.CellData,this._windowTitle="",this._iconName="",this._windowTitleStack=[],this._iconNameStack=[],this._curAttrData=e.DEFAULT_ATTR_DATA.clone(),this._eraseAttrDataInternal=e.DEFAULT_ATTR_DATA.clone(),this._onRequestBell=this.register(new s.EventEmitter),this.onRequestBell=this._onRequestBell.event,this._onRequestRefreshRows=this.register(new s.EventEmitter),this.onRequestRefreshRows=this._onRequestRefreshRows.event,this._onRequestReset=this.register(new s.EventEmitter),this.onRequestReset=this._onRequestReset.event,this._onRequestSendFocus=this.register(new s.EventEmitter),this.onRequestSendFocus=this._onRequestSendFocus.event,this._onRequestSyncScrollBar=this.register(new s.EventEmitter),this.onRequestSyncScrollBar=this._onRequestSyncScrollBar.event,this._onRequestWindowsOptionsReport=this.register(new s.EventEmitter),this.onRequestWindowsOptionsReport=this._onRequestWindowsOptionsReport.event,this._onA11yChar=this.register(new s.EventEmitter),this.onA11yChar=this._onA11yChar.event,this._onA11yTab=this.register(new s.EventEmitter),this.onA11yTab=this._onA11yTab.event,this._onCursorMove=this.register(new s.EventEmitter),this.onCursorMove=this._onCursorMove.event,this._onLineFeed=this.register(new s.EventEmitter),this.onLineFeed=this._onLineFeed.event,this._onScroll=this.register(new s.EventEmitter),this.onScroll=this._onScroll.event,this._onTitleChange=this.register(new s.EventEmitter),this.onTitleChange=this._onTitleChange.event,this._onColor=this.register(new s.EventEmitter),this.onColor=this._onColor.event,this._parseStack={paused:!1,cursorStartX:0,cursorStartY:0,decodedLength:0,position:0},this._specialColors=[256,257,258],this.register(this._parser),this._dirtyRowTracker=new I(this._bufferService),this._activeBuffer=this._bufferService.buffer,this.register(this._bufferService.buffers.onBufferActivate(k=>this._activeBuffer=k.activeBuffer)),this._parser.setCsiHandlerFallback((k,E)=>{this._logService.debug("Unknown CSI code: ",{identifier:this._parser.identToString(k),params:E.toArray()})}),this._parser.setEscHandlerFallback(k=>{this._logService.debug("Unknown ESC code: ",{identifier:this._parser.identToString(k)})}),this._parser.setExecuteHandlerFallback(k=>{this._logService.debug("Unknown EXECUTE code: ",{code:k})}),this._parser.setOscHandlerFallback((k,E,x)=>{this._logService.debug("Unknown OSC code: ",{identifier:k,action:E,data:x})}),this._parser.setDcsHandlerFallback((k,E,x)=>{E==="HOOK"&&(x=x.toArray()),this._logService.debug("Unknown DCS code: ",{identifier:this._parser.identToString(k),action:E,payload:x})}),this._parser.setPrintHandler((k,E,x)=>this.print(k,E,x)),this._parser.registerCsiHandler({final:"@"},k=>this.insertChars(k)),this._parser.registerCsiHandler({intermediates:" ",final:"@"},k=>this.scrollLeft(k)),this._parser.registerCsiHandler({final:"A"},k=>this.cursorUp(k)),this._parser.registerCsiHandler({intermediates:" ",final:"A"},k=>this.scrollRight(k)),this._parser.registerCsiHandler({final:"B"},k=>this.cursorDown(k)),this._parser.registerCsiHandler({final:"C"},k=>this.cursorForward(k)),this._parser.registerCsiHandler({final:"D"},k=>this.cursorBackward(k)),this._parser.registerCsiHandler({final:"E"},k=>this.cursorNextLine(k)),this._parser.registerCsiHandler({final:"F"},k=>this.cursorPrecedingLine(k)),this._parser.registerCsiHandler({final:"G"},k=>this.cursorCharAbsolute(k)),this._parser.registerCsiHandler({final:"H"},k=>this.cursorPosition(k)),this._parser.registerCsiHandler({final:"I"},k=>this.cursorForwardTab(k)),this._parser.registerCsiHandler({final:"J"},k=>this.eraseInDisplay(k,!1)),this._parser.registerCsiHandler({prefix:"?",final:"J"},k=>this.eraseInDisplay(k,!0)),this._parser.registerCsiHandler({final:"K"},k=>this.eraseInLine(k,!1)),this._parser.registerCsiHandler({prefix:"?",final:"K"},k=>this.eraseInLine(k,!0)),this._parser.registerCsiHandler({final:"L"},k=>this.insertLines(k)),this._parser.registerCsiHandler({final:"M"},k=>this.deleteLines(k)),this._parser.registerCsiHandler({final:"P"},k=>this.deleteChars(k)),this._parser.registerCsiHandler({final:"S"},k=>this.scrollUp(k)),this._parser.registerCsiHandler({final:"T"},k=>this.scrollDown(k)),this._parser.registerCsiHandler({final:"X"},k=>this.eraseChars(k)),this._parser.registerCsiHandler({final:"Z"},k=>this.cursorBackwardTab(k)),this._parser.registerCsiHandler({final:"`"},k=>this.charPosAbsolute(k)),this._parser.registerCsiHandler({final:"a"},k=>this.hPositionRelative(k)),this._parser.registerCsiHandler({final:"b"},k=>this.repeatPrecedingCharacter(k)),this._parser.registerCsiHandler({final:"c"},k=>this.sendDeviceAttributesPrimary(k)),this._parser.registerCsiHandler({prefix:">",final:"c"},k=>this.sendDeviceAttributesSecondary(k)),this._parser.registerCsiHandler({final:"d"},k=>this.linePosAbsolute(k)),this._parser.registerCsiHandler({final:"e"},k=>this.vPositionRelative(k)),this._parser.registerCsiHandler({final:"f"},k=>this.hVPosition(k)),this._parser.registerCsiHandler({final:"g"},k=>this.tabClear(k)),this._parser.registerCsiHandler({final:"h"},k=>this.setMode(k)),this._parser.registerCsiHandler({prefix:"?",final:"h"},k=>this.setModePrivate(k)),this._parser.registerCsiHandler({final:"l"},k=>this.resetMode(k)),this._parser.registerCsiHandler({prefix:"?",final:"l"},k=>this.resetModePrivate(k)),this._parser.registerCsiHandler({final:"m"},k=>this.charAttributes(k)),this._parser.registerCsiHandler({final:"n"},k=>this.deviceStatus(k)),this._parser.registerCsiHandler({prefix:"?",final:"n"},k=>this.deviceStatusPrivate(k)),this._parser.registerCsiHandler({intermediates:"!",final:"p"},k=>this.softReset(k)),this._parser.registerCsiHandler({intermediates:" ",final:"q"},k=>this.setCursorStyle(k)),this._parser.registerCsiHandler({final:"r"},k=>this.setScrollRegion(k)),this._parser.registerCsiHandler({final:"s"},k=>this.saveCursor(k)),this._parser.registerCsiHandler({final:"t"},k=>this.windowOptions(k)),this._parser.registerCsiHandler({final:"u"},k=>this.restoreCursor(k)),this._parser.registerCsiHandler({intermediates:"'",final:"}"},k=>this.insertColumns(k)),this._parser.registerCsiHandler({intermediates:"'",final:"~"},k=>this.deleteColumns(k)),this._parser.registerCsiHandler({intermediates:'"',final:"q"},k=>this.selectProtected(k)),this._parser.registerCsiHandler({intermediates:"$",final:"p"},k=>this.requestMode(k,!0)),this._parser.registerCsiHandler({prefix:"?",intermediates:"$",final:"p"},k=>this.requestMode(k,!1)),this._parser.setExecuteHandler(c.C0.BEL,()=>this.bell()),this._parser.setExecuteHandler(c.C0.LF,()=>this.lineFeed()),this._parser.setExecuteHandler(c.C0.VT,()=>this.lineFeed()),this._parser.setExecuteHandler(c.C0.FF,()=>this.lineFeed()),this._parser.setExecuteHandler(c.C0.CR,()=>this.carriageReturn()),this._parser.setExecuteHandler(c.C0.BS,()=>this.backspace()),this._parser.setExecuteHandler(c.C0.HT,()=>this.tab()),this._parser.setExecuteHandler(c.C0.SO,()=>this.shiftOut()),this._parser.setExecuteHandler(c.C0.SI,()=>this.shiftIn()),this._parser.setExecuteHandler(c.C1.IND,()=>this.index()),this._parser.setExecuteHandler(c.C1.NEL,()=>this.nextLine()),this._parser.setExecuteHandler(c.C1.HTS,()=>this.tabSet()),this._parser.registerOscHandler(0,new g.OscHandler(k=>(this.setTitle(k),this.setIconName(k),!0))),this._parser.registerOscHandler(1,new g.OscHandler(k=>this.setIconName(k))),this._parser.registerOscHandler(2,new g.OscHandler(k=>this.setTitle(k))),this._parser.registerOscHandler(4,new g.OscHandler(k=>this.setOrReportIndexedColor(k))),this._parser.registerOscHandler(8,new g.OscHandler(k=>this.setHyperlink(k))),this._parser.registerOscHandler(10,new g.OscHandler(k=>this.setOrReportFgColor(k))),this._parser.registerOscHandler(11,new g.OscHandler(k=>this.setOrReportBgColor(k))),this._parser.registerOscHandler(12,new g.OscHandler(k=>this.setOrReportCursorColor(k))),this._parser.registerOscHandler(104,new g.OscHandler(k=>this.restoreIndexedColor(k))),this._parser.registerOscHandler(110,new g.OscHandler(k=>this.restoreFgColor(k))),this._parser.registerOscHandler(111,new g.OscHandler(k=>this.restoreBgColor(k))),this._parser.registerOscHandler(112,new g.OscHandler(k=>this.restoreCursorColor(k))),this._parser.registerEscHandler({final:"7"},()=>this.saveCursor()),this._parser.registerEscHandler({final:"8"},()=>this.restoreCursor()),this._parser.registerEscHandler({final:"D"},()=>this.index()),this._parser.registerEscHandler({final:"E"},()=>this.nextLine()),this._parser.registerEscHandler({final:"H"},()=>this.tabSet()),this._parser.registerEscHandler({final:"M"},()=>this.reverseIndex()),this._parser.registerEscHandler({final:"="},()=>this.keypadApplicationMode()),this._parser.registerEscHandler({final:">"},()=>this.keypadNumericMode()),this._parser.registerEscHandler({final:"c"},()=>this.fullReset()),this._parser.registerEscHandler({final:"n"},()=>this.setgLevel(2)),this._parser.registerEscHandler({final:"o"},()=>this.setgLevel(3)),this._parser.registerEscHandler({final:"|"},()=>this.setgLevel(3)),this._parser.registerEscHandler({final:"}"},()=>this.setgLevel(2)),this._parser.registerEscHandler({final:"~"},()=>this.setgLevel(1)),this._parser.registerEscHandler({intermediates:"%",final:"@"},()=>this.selectDefaultCharset()),this._parser.registerEscHandler({intermediates:"%",final:"G"},()=>this.selectDefaultCharset());for(const k in n.CHARSETS)this._parser.registerEscHandler({intermediates:"(",final:k},()=>this.selectCharset("("+k)),this._parser.registerEscHandler({intermediates:")",final:k},()=>this.selectCharset(")"+k)),this._parser.registerEscHandler({intermediates:"*",final:k},()=>this.selectCharset("*"+k)),this._parser.registerEscHandler({intermediates:"+",final:k},()=>this.selectCharset("+"+k)),this._parser.registerEscHandler({intermediates:"-",final:k},()=>this.selectCharset("-"+k)),this._parser.registerEscHandler({intermediates:".",final:k},()=>this.selectCharset("."+k)),this._parser.registerEscHandler({intermediates:"/",final:k},()=>this.selectCharset("/"+k));this._parser.registerEscHandler({intermediates:"#",final:"8"},()=>this.screenAlignmentPattern()),this._parser.setErrorHandler(k=>(this._logService.error("Parsing error: ",k),k)),this._parser.registerDcsHandler({intermediates:"$",final:"q"},new m.DcsHandler((k,E)=>this.requestStatusString(k,E)))}getAttrData(){return this._curAttrData}_preserveStack(S,b,L,R){this._parseStack.paused=!0,this._parseStack.cursorStartX=S,this._parseStack.cursorStartY=b,this._parseStack.decodedLength=L,this._parseStack.position=R}_logSlowResolvingAsync(S){this._logService.logLevel<=u.LogLevelEnum.WARN&&Promise.race([S,new Promise((b,L)=>setTimeout(()=>L("#SLOW_TIMEOUT"),5e3))]).catch(b=>{if(b!=="#SLOW_TIMEOUT")throw b;console.warn("async parser handler taking longer than 5000 ms")})}_getCurrentLinkId(){return this._curAttrData.extended.urlId}parse(S,b){let L,R=this._activeBuffer.x,M=this._activeBuffer.y,F=0;const N=this._parseStack.paused;if(N){if(L=this._parser.parse(this._parseBuffer,this._parseStack.decodedLength,b))return this._logSlowResolvingAsync(L),L;R=this._parseStack.cursorStartX,M=this._parseStack.cursorStartY,this._parseStack.paused=!1,S.length>C&&(F=this._parseStack.position+C)}if(this._logService.logLevel<=u.LogLevelEnum.DEBUG&&this._logService.debug("parsing data"+(typeof S=="string"?` "${S}"`:` "${Array.prototype.map.call(S,O=>String.fromCharCode(O)).join("")}"`),typeof S=="string"?S.split("").map(O=>O.charCodeAt(0)):S),this._parseBuffer.length<S.length&&this._parseBuffer.length<C&&(this._parseBuffer=new Uint32Array(Math.min(S.length,C))),N||this._dirtyRowTracker.clearRange(),S.length>C)for(let O=F;O<S.length;O+=C){const W=O+C<S.length?O+C:S.length,k=typeof S=="string"?this._stringDecoder.decode(S.substring(O,W),this._parseBuffer):this._utf8Decoder.decode(S.subarray(O,W),this._parseBuffer);if(L=this._parser.parse(this._parseBuffer,k))return this._preserveStack(R,M,k,O),this._logSlowResolvingAsync(L),L}else if(!N){const O=typeof S=="string"?this._stringDecoder.decode(S,this._parseBuffer):this._utf8Decoder.decode(S,this._parseBuffer);if(L=this._parser.parse(this._parseBuffer,O))return this._preserveStack(R,M,O,0),this._logSlowResolvingAsync(L),L}this._activeBuffer.x===R&&this._activeBuffer.y===M||this._onCursorMove.fire(),this._onRequestRefreshRows.fire(this._dirtyRowTracker.start,this._dirtyRowTracker.end)}print(S,b,L){let R,M;const F=this._charsetService.charset,N=this._optionsService.rawOptions.screenReaderMode,O=this._bufferService.cols,W=this._coreService.decPrivateModes.wraparound,k=this._coreService.modes.insertMode,E=this._curAttrData;let x=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._activeBuffer.x&&L-b>0&&x.getWidth(this._activeBuffer.x-1)===2&&x.setCellFromCodePoint(this._activeBuffer.x-1,0,1,E.fg,E.bg,E.extended);for(let T=b;T<L;++T){if(R=S[T],M=this._unicodeService.wcwidth(R),R<127&&F){const P=F[String.fromCharCode(R)];P&&(R=P.charCodeAt(0))}if(N&&this._onA11yChar.fire((0,a.stringFromCodePoint)(R)),this._getCurrentLinkId()&&this._oscLinkService.addLineToLink(this._getCurrentLinkId(),this._activeBuffer.ybase+this._activeBuffer.y),M||!this._activeBuffer.x){if(this._activeBuffer.x+M-1>=O){if(W){for(;this._activeBuffer.x<O;)x.setCellFromCodePoint(this._activeBuffer.x++,0,1,E.fg,E.bg,E.extended);this._activeBuffer.x=0,this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData(),!0)):(this._activeBuffer.y>=this._bufferService.rows&&(this._activeBuffer.y=this._bufferService.rows-1),this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).isWrapped=!0),x=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y)}else if(this._activeBuffer.x=O-1,M===2)continue}if(k&&(x.insertCells(this._activeBuffer.x,M,this._activeBuffer.getNullCell(E),E),x.getWidth(O-1)===2&&x.setCellFromCodePoint(O-1,r.NULL_CELL_CODE,r.NULL_CELL_WIDTH,E.fg,E.bg,E.extended)),x.setCellFromCodePoint(this._activeBuffer.x++,R,M,E.fg,E.bg,E.extended),M>0)for(;--M;)x.setCellFromCodePoint(this._activeBuffer.x++,0,0,E.fg,E.bg,E.extended)}else x.getWidth(this._activeBuffer.x-1)?x.addCodepointToCell(this._activeBuffer.x-1,R):x.addCodepointToCell(this._activeBuffer.x-2,R)}L-b>0&&(x.loadCell(this._activeBuffer.x-1,this._workCell),this._workCell.getWidth()===2||this._workCell.getCode()>65535?this._parser.precedingCodepoint=0:this._workCell.isCombined()?this._parser.precedingCodepoint=this._workCell.getChars().charCodeAt(0):this._parser.precedingCodepoint=this._workCell.content),this._activeBuffer.x<O&&L-b>0&&x.getWidth(this._activeBuffer.x)===0&&!x.hasContent(this._activeBuffer.x)&&x.setCellFromCodePoint(this._activeBuffer.x,0,1,E.fg,E.bg,E.extended),this._dirtyRowTracker.markDirty(this._activeBuffer.y)}registerCsiHandler(S,b){return S.final!=="t"||S.prefix||S.intermediates?this._parser.registerCsiHandler(S,b):this._parser.registerCsiHandler(S,L=>!w(L.params[0],this._optionsService.rawOptions.windowOptions)||b(L))}registerDcsHandler(S,b){return this._parser.registerDcsHandler(S,new m.DcsHandler(b))}registerEscHandler(S,b){return this._parser.registerEscHandler(S,b)}registerOscHandler(S,b){return this._parser.registerOscHandler(S,new g.OscHandler(b))}bell(){return this._onRequestBell.fire(),!0}lineFeed(){return this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._optionsService.rawOptions.convertEol&&(this._activeBuffer.x=0),this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData())):this._activeBuffer.y>=this._bufferService.rows&&(this._activeBuffer.y=this._bufferService.rows-1),this._activeBuffer.x>=this._bufferService.cols&&this._activeBuffer.x--,this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._onLineFeed.fire(),!0}carriageReturn(){return this._activeBuffer.x=0,!0}backspace(){var S;if(!this._coreService.decPrivateModes.reverseWraparound)return this._restrictCursor(),this._activeBuffer.x>0&&this._activeBuffer.x--,!0;if(this._restrictCursor(this._bufferService.cols),this._activeBuffer.x>0)this._activeBuffer.x--;else if(this._activeBuffer.x===0&&this._activeBuffer.y>this._activeBuffer.scrollTop&&this._activeBuffer.y<=this._activeBuffer.scrollBottom&&(!((S=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y))===null||S===void 0)&&S.isWrapped)){this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).isWrapped=!1,this._activeBuffer.y--,this._activeBuffer.x=this._bufferService.cols-1;const b=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);b.hasWidth(this._activeBuffer.x)&&!b.hasContent(this._activeBuffer.x)&&this._activeBuffer.x--}return this._restrictCursor(),!0}tab(){if(this._activeBuffer.x>=this._bufferService.cols)return!0;const S=this._activeBuffer.x;return this._activeBuffer.x=this._activeBuffer.nextStop(),this._optionsService.rawOptions.screenReaderMode&&this._onA11yTab.fire(this._activeBuffer.x-S),!0}shiftOut(){return this._charsetService.setgLevel(1),!0}shiftIn(){return this._charsetService.setgLevel(0),!0}_restrictCursor(S=this._bufferService.cols-1){this._activeBuffer.x=Math.min(S,Math.max(0,this._activeBuffer.x)),this._activeBuffer.y=this._coreService.decPrivateModes.origin?Math.min(this._activeBuffer.scrollBottom,Math.max(this._activeBuffer.scrollTop,this._activeBuffer.y)):Math.min(this._bufferService.rows-1,Math.max(0,this._activeBuffer.y)),this._dirtyRowTracker.markDirty(this._activeBuffer.y)}_setCursor(S,b){this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._coreService.decPrivateModes.origin?(this._activeBuffer.x=S,this._activeBuffer.y=this._activeBuffer.scrollTop+b):(this._activeBuffer.x=S,this._activeBuffer.y=b),this._restrictCursor(),this._dirtyRowTracker.markDirty(this._activeBuffer.y)}_moveCursor(S,b){this._restrictCursor(),this._setCursor(this._activeBuffer.x+S,this._activeBuffer.y+b)}cursorUp(S){const b=this._activeBuffer.y-this._activeBuffer.scrollTop;return b>=0?this._moveCursor(0,-Math.min(b,S.params[0]||1)):this._moveCursor(0,-(S.params[0]||1)),!0}cursorDown(S){const b=this._activeBuffer.scrollBottom-this._activeBuffer.y;return b>=0?this._moveCursor(0,Math.min(b,S.params[0]||1)):this._moveCursor(0,S.params[0]||1),!0}cursorForward(S){return this._moveCursor(S.params[0]||1,0),!0}cursorBackward(S){return this._moveCursor(-(S.params[0]||1),0),!0}cursorNextLine(S){return this.cursorDown(S),this._activeBuffer.x=0,!0}cursorPrecedingLine(S){return this.cursorUp(S),this._activeBuffer.x=0,!0}cursorCharAbsolute(S){return this._setCursor((S.params[0]||1)-1,this._activeBuffer.y),!0}cursorPosition(S){return this._setCursor(S.length>=2?(S.params[1]||1)-1:0,(S.params[0]||1)-1),!0}charPosAbsolute(S){return this._setCursor((S.params[0]||1)-1,this._activeBuffer.y),!0}hPositionRelative(S){return this._moveCursor(S.params[0]||1,0),!0}linePosAbsolute(S){return this._setCursor(this._activeBuffer.x,(S.params[0]||1)-1),!0}vPositionRelative(S){return this._moveCursor(0,S.params[0]||1),!0}hVPosition(S){return this.cursorPosition(S),!0}tabClear(S){const b=S.params[0];return b===0?delete this._activeBuffer.tabs[this._activeBuffer.x]:b===3&&(this._activeBuffer.tabs={}),!0}cursorForwardTab(S){if(this._activeBuffer.x>=this._bufferService.cols)return!0;let b=S.params[0]||1;for(;b--;)this._activeBuffer.x=this._activeBuffer.nextStop();return!0}cursorBackwardTab(S){if(this._activeBuffer.x>=this._bufferService.cols)return!0;let b=S.params[0]||1;for(;b--;)this._activeBuffer.x=this._activeBuffer.prevStop();return!0}selectProtected(S){const b=S.params[0];return b===1&&(this._curAttrData.bg|=536870912),b!==2&&b!==0||(this._curAttrData.bg&=-536870913),!0}_eraseInBufferLine(S,b,L,R=!1,M=!1){const F=this._activeBuffer.lines.get(this._activeBuffer.ybase+S);F.replaceCells(b,L,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData(),M),R&&(F.isWrapped=!1)}_resetBufferLine(S,b=!1){const L=this._activeBuffer.lines.get(this._activeBuffer.ybase+S);L.fill(this._activeBuffer.getNullCell(this._eraseAttrData()),b),this._bufferService.buffer.clearMarkers(this._activeBuffer.ybase+S),L.isWrapped=!1}eraseInDisplay(S,b=!1){let L;switch(this._restrictCursor(this._bufferService.cols),S.params[0]){case 0:for(L=this._activeBuffer.y,this._dirtyRowTracker.markDirty(L),this._eraseInBufferLine(L++,this._activeBuffer.x,this._bufferService.cols,this._activeBuffer.x===0,b);L<this._bufferService.rows;L++)this._resetBufferLine(L,b);this._dirtyRowTracker.markDirty(L);break;case 1:for(L=this._activeBuffer.y,this._dirtyRowTracker.markDirty(L),this._eraseInBufferLine(L,0,this._activeBuffer.x+1,!0,b),this._activeBuffer.x+1>=this._bufferService.cols&&(this._activeBuffer.lines.get(L+1).isWrapped=!1);L--;)this._resetBufferLine(L,b);this._dirtyRowTracker.markDirty(0);break;case 2:for(L=this._bufferService.rows,this._dirtyRowTracker.markDirty(L-1);L--;)this._resetBufferLine(L,b);this._dirtyRowTracker.markDirty(0);break;case 3:const R=this._activeBuffer.lines.length-this._bufferService.rows;R>0&&(this._activeBuffer.lines.trimStart(R),this._activeBuffer.ybase=Math.max(this._activeBuffer.ybase-R,0),this._activeBuffer.ydisp=Math.max(this._activeBuffer.ydisp-R,0),this._onScroll.fire(0))}return!0}eraseInLine(S,b=!1){switch(this._restrictCursor(this._bufferService.cols),S.params[0]){case 0:this._eraseInBufferLine(this._activeBuffer.y,this._activeBuffer.x,this._bufferService.cols,this._activeBuffer.x===0,b);break;case 1:this._eraseInBufferLine(this._activeBuffer.y,0,this._activeBuffer.x+1,!1,b);break;case 2:this._eraseInBufferLine(this._activeBuffer.y,0,this._bufferService.cols,!0,b)}return this._dirtyRowTracker.markDirty(this._activeBuffer.y),!0}insertLines(S){this._restrictCursor();let b=S.params[0]||1;if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const L=this._activeBuffer.ybase+this._activeBuffer.y,R=this._bufferService.rows-1-this._activeBuffer.scrollBottom,M=this._bufferService.rows-1+this._activeBuffer.ybase-R+1;for(;b--;)this._activeBuffer.lines.splice(M-1,1),this._activeBuffer.lines.splice(L,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.y,this._activeBuffer.scrollBottom),this._activeBuffer.x=0,!0}deleteLines(S){this._restrictCursor();let b=S.params[0]||1;if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const L=this._activeBuffer.ybase+this._activeBuffer.y;let R;for(R=this._bufferService.rows-1-this._activeBuffer.scrollBottom,R=this._bufferService.rows-1+this._activeBuffer.ybase-R;b--;)this._activeBuffer.lines.splice(L,1),this._activeBuffer.lines.splice(R,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.y,this._activeBuffer.scrollBottom),this._activeBuffer.x=0,!0}insertChars(S){this._restrictCursor();const b=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return b&&(b.insertCells(this._activeBuffer.x,S.params[0]||1,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),this._dirtyRowTracker.markDirty(this._activeBuffer.y)),!0}deleteChars(S){this._restrictCursor();const b=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return b&&(b.deleteCells(this._activeBuffer.x,S.params[0]||1,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),this._dirtyRowTracker.markDirty(this._activeBuffer.y)),!0}scrollUp(S){let b=S.params[0]||1;for(;b--;)this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollTop,1),this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollBottom,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}scrollDown(S){let b=S.params[0]||1;for(;b--;)this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollBottom,1),this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollTop,0,this._activeBuffer.getBlankLine(e.DEFAULT_ATTR_DATA));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}scrollLeft(S){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const b=S.params[0]||1;for(let L=this._activeBuffer.scrollTop;L<=this._activeBuffer.scrollBottom;++L){const R=this._activeBuffer.lines.get(this._activeBuffer.ybase+L);R.deleteCells(0,b,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),R.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}scrollRight(S){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const b=S.params[0]||1;for(let L=this._activeBuffer.scrollTop;L<=this._activeBuffer.scrollBottom;++L){const R=this._activeBuffer.lines.get(this._activeBuffer.ybase+L);R.insertCells(0,b,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),R.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}insertColumns(S){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const b=S.params[0]||1;for(let L=this._activeBuffer.scrollTop;L<=this._activeBuffer.scrollBottom;++L){const R=this._activeBuffer.lines.get(this._activeBuffer.ybase+L);R.insertCells(this._activeBuffer.x,b,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),R.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}deleteColumns(S){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const b=S.params[0]||1;for(let L=this._activeBuffer.scrollTop;L<=this._activeBuffer.scrollBottom;++L){const R=this._activeBuffer.lines.get(this._activeBuffer.ybase+L);R.deleteCells(this._activeBuffer.x,b,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),R.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}eraseChars(S){this._restrictCursor();const b=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return b&&(b.replaceCells(this._activeBuffer.x,this._activeBuffer.x+(S.params[0]||1),this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),this._dirtyRowTracker.markDirty(this._activeBuffer.y)),!0}repeatPrecedingCharacter(S){if(!this._parser.precedingCodepoint)return!0;const b=S.params[0]||1,L=new Uint32Array(b);for(let R=0;R<b;++R)L[R]=this._parser.precedingCodepoint;return this.print(L,0,L.length),!0}sendDeviceAttributesPrimary(S){return S.params[0]>0||(this._is("xterm")||this._is("rxvt-unicode")||this._is("screen")?this._coreService.triggerDataEvent(c.C0.ESC+"[?1;2c"):this._is("linux")&&this._coreService.triggerDataEvent(c.C0.ESC+"[?6c")),!0}sendDeviceAttributesSecondary(S){return S.params[0]>0||(this._is("xterm")?this._coreService.triggerDataEvent(c.C0.ESC+"[>0;276;0c"):this._is("rxvt-unicode")?this._coreService.triggerDataEvent(c.C0.ESC+"[>85;95;0c"):this._is("linux")?this._coreService.triggerDataEvent(S.params[0]+"c"):this._is("screen")&&this._coreService.triggerDataEvent(c.C0.ESC+"[>83;40003;0c")),!0}_is(S){return(this._optionsService.rawOptions.termName+"").indexOf(S)===0}setMode(S){for(let b=0;b<S.length;b++)switch(S.params[b]){case 4:this._coreService.modes.insertMode=!0;break;case 20:this._optionsService.options.convertEol=!0}return!0}setModePrivate(S){for(let b=0;b<S.length;b++)switch(S.params[b]){case 1:this._coreService.decPrivateModes.applicationCursorKeys=!0;break;case 2:this._charsetService.setgCharset(0,n.DEFAULT_CHARSET),this._charsetService.setgCharset(1,n.DEFAULT_CHARSET),this._charsetService.setgCharset(2,n.DEFAULT_CHARSET),this._charsetService.setgCharset(3,n.DEFAULT_CHARSET);break;case 3:this._optionsService.rawOptions.windowOptions.setWinLines&&(this._bufferService.resize(132,this._bufferService.rows),this._onRequestReset.fire());break;case 6:this._coreService.decPrivateModes.origin=!0,this._setCursor(0,0);break;case 7:this._coreService.decPrivateModes.wraparound=!0;break;case 12:this._optionsService.options.cursorBlink=!0;break;case 45:this._coreService.decPrivateModes.reverseWraparound=!0;break;case 66:this._logService.debug("Serial port requested application keypad."),this._coreService.decPrivateModes.applicationKeypad=!0,this._onRequestSyncScrollBar.fire();break;case 9:this._coreMouseService.activeProtocol="X10";break;case 1e3:this._coreMouseService.activeProtocol="VT200";break;case 1002:this._coreMouseService.activeProtocol="DRAG";break;case 1003:this._coreMouseService.activeProtocol="ANY";break;case 1004:this._coreService.decPrivateModes.sendFocus=!0,this._onRequestSendFocus.fire();break;case 1005:this._logService.debug("DECSET 1005 not supported (see #2507)");break;case 1006:this._coreMouseService.activeEncoding="SGR";break;case 1015:this._logService.debug("DECSET 1015 not supported (see #2507)");break;case 1016:this._coreMouseService.activeEncoding="SGR_PIXELS";break;case 25:this._coreService.isCursorHidden=!1;break;case 1048:this.saveCursor();break;case 1049:this.saveCursor();case 47:case 1047:this._bufferService.buffers.activateAltBuffer(this._eraseAttrData()),this._coreService.isCursorInitialized=!0,this._onRequestRefreshRows.fire(0,this._bufferService.rows-1),this._onRequestSyncScrollBar.fire();break;case 2004:this._coreService.decPrivateModes.bracketedPasteMode=!0}return!0}resetMode(S){for(let b=0;b<S.length;b++)switch(S.params[b]){case 4:this._coreService.modes.insertMode=!1;break;case 20:this._optionsService.options.convertEol=!1}return!0}resetModePrivate(S){for(let b=0;b<S.length;b++)switch(S.params[b]){case 1:this._coreService.decPrivateModes.applicationCursorKeys=!1;break;case 3:this._optionsService.rawOptions.windowOptions.setWinLines&&(this._bufferService.resize(80,this._bufferService.rows),this._onRequestReset.fire());break;case 6:this._coreService.decPrivateModes.origin=!1,this._setCursor(0,0);break;case 7:this._coreService.decPrivateModes.wraparound=!1;break;case 12:this._optionsService.options.cursorBlink=!1;break;case 45:this._coreService.decPrivateModes.reverseWraparound=!1;break;case 66:this._logService.debug("Switching back to normal keypad."),this._coreService.decPrivateModes.applicationKeypad=!1,this._onRequestSyncScrollBar.fire();break;case 9:case 1e3:case 1002:case 1003:this._coreMouseService.activeProtocol="NONE";break;case 1004:this._coreService.decPrivateModes.sendFocus=!1;break;case 1005:this._logService.debug("DECRST 1005 not supported (see #2507)");break;case 1006:case 1016:this._coreMouseService.activeEncoding="DEFAULT";break;case 1015:this._logService.debug("DECRST 1015 not supported (see #2507)");break;case 25:this._coreService.isCursorHidden=!0;break;case 1048:this.restoreCursor();break;case 1049:case 47:case 1047:this._bufferService.buffers.activateNormalBuffer(),S.params[b]===1049&&this.restoreCursor(),this._coreService.isCursorInitialized=!0,this._onRequestRefreshRows.fire(0,this._bufferService.rows-1),this._onRequestSyncScrollBar.fire();break;case 2004:this._coreService.decPrivateModes.bracketedPasteMode=!1}return!0}requestMode(S,b){const L=this._coreService.decPrivateModes,{activeProtocol:R,activeEncoding:M}=this._coreMouseService,F=this._coreService,{buffers:N,cols:O}=this._bufferService,{active:W,alt:k}=N,E=this._optionsService.rawOptions,x=U=>U?1:2,T=S.params[0];return P=T,V=b?T===2?3:T===4?x(F.modes.insertMode):T===12?4:T===20?x(E.convertEol):0:T===1?x(L.applicationCursorKeys):T===3?E.windowOptions.setWinLines?O===80?2:O===132?1:0:0:T===6?x(L.origin):T===7?x(L.wraparound):T===8?3:T===9?x(R==="X10"):T===12?x(E.cursorBlink):T===25?x(!F.isCursorHidden):T===45?x(L.reverseWraparound):T===66?x(L.applicationKeypad):T===1e3?x(R==="VT200"):T===1002?x(R==="DRAG"):T===1003?x(R==="ANY"):T===1004?x(L.sendFocus):T===1005?4:T===1006?x(M==="SGR"):T===1015?4:T===1016?x(M==="SGR_PIXELS"):T===1048?1:T===47||T===1047||T===1049?x(W===k):T===2004?x(L.bracketedPasteMode):0,F.triggerDataEvent(`${c.C0.ESC}[${b?"":"?"}${P};${V}$y`),!0;var P,V}_updateAttrColor(S,b,L,R,M){return b===2?(S|=50331648,S&=-16777216,S|=o.AttributeData.fromColorRGB([L,R,M])):b===5&&(S&=-50331904,S|=33554432|255&L),S}_extractColor(S,b,L){const R=[0,0,-1,0,0,0];let M=0,F=0;do{if(R[F+M]=S.params[b+F],S.hasSubParams(b+F)){const N=S.getSubParams(b+F);let O=0;do R[1]===5&&(M=1),R[F+O+1+M]=N[O];while(++O<N.length&&O+F+1+M<R.length);break}if(R[1]===5&&F+M>=2||R[1]===2&&F+M>=5)break;R[1]&&(M=1)}while(++F+b<S.length&&F+M<R.length);for(let N=2;N<R.length;++N)R[N]===-1&&(R[N]=0);switch(R[0]){case 38:L.fg=this._updateAttrColor(L.fg,R[1],R[3],R[4],R[5]);break;case 48:L.bg=this._updateAttrColor(L.bg,R[1],R[3],R[4],R[5]);break;case 58:L.extended=L.extended.clone(),L.extended.underlineColor=this._updateAttrColor(L.extended.underlineColor,R[1],R[3],R[4],R[5])}return F}_processUnderline(S,b){b.extended=b.extended.clone(),(!~S||S>5)&&(S=1),b.extended.underlineStyle=S,b.fg|=268435456,S===0&&(b.fg&=-268435457),b.updateExtended()}_processSGR0(S){S.fg=e.DEFAULT_ATTR_DATA.fg,S.bg=e.DEFAULT_ATTR_DATA.bg,S.extended=S.extended.clone(),S.extended.underlineStyle=0,S.extended.underlineColor&=-67108864,S.updateExtended()}charAttributes(S){if(S.length===1&&S.params[0]===0)return this._processSGR0(this._curAttrData),!0;const b=S.length;let L;const R=this._curAttrData;for(let M=0;M<b;M++)L=S.params[M],L>=30&&L<=37?(R.fg&=-50331904,R.fg|=16777216|L-30):L>=40&&L<=47?(R.bg&=-50331904,R.bg|=16777216|L-40):L>=90&&L<=97?(R.fg&=-50331904,R.fg|=16777224|L-90):L>=100&&L<=107?(R.bg&=-50331904,R.bg|=16777224|L-100):L===0?this._processSGR0(R):L===1?R.fg|=134217728:L===3?R.bg|=67108864:L===4?(R.fg|=268435456,this._processUnderline(S.hasSubParams(M)?S.getSubParams(M)[0]:1,R)):L===5?R.fg|=536870912:L===7?R.fg|=67108864:L===8?R.fg|=1073741824:L===9?R.fg|=2147483648:L===2?R.bg|=134217728:L===21?this._processUnderline(2,R):L===22?(R.fg&=-134217729,R.bg&=-134217729):L===23?R.bg&=-67108865:L===24?(R.fg&=-268435457,this._processUnderline(0,R)):L===25?R.fg&=-536870913:L===27?R.fg&=-67108865:L===28?R.fg&=-1073741825:L===29?R.fg&=2147483647:L===39?(R.fg&=-67108864,R.fg|=16777215&e.DEFAULT_ATTR_DATA.fg):L===49?(R.bg&=-67108864,R.bg|=16777215&e.DEFAULT_ATTR_DATA.bg):L===38||L===48||L===58?M+=this._extractColor(S,M,R):L===59?(R.extended=R.extended.clone(),R.extended.underlineColor=-1,R.updateExtended()):L===100?(R.fg&=-67108864,R.fg|=16777215&e.DEFAULT_ATTR_DATA.fg,R.bg&=-67108864,R.bg|=16777215&e.DEFAULT_ATTR_DATA.bg):this._logService.debug("Unknown SGR attribute: %d.",L);return!0}deviceStatus(S){switch(S.params[0]){case 5:this._coreService.triggerDataEvent(`${c.C0.ESC}[0n`);break;case 6:const b=this._activeBuffer.y+1,L=this._activeBuffer.x+1;this._coreService.triggerDataEvent(`${c.C0.ESC}[${b};${L}R`)}return!0}deviceStatusPrivate(S){if(S.params[0]===6){const b=this._activeBuffer.y+1,L=this._activeBuffer.x+1;this._coreService.triggerDataEvent(`${c.C0.ESC}[?${b};${L}R`)}return!0}softReset(S){return this._coreService.isCursorHidden=!1,this._onRequestSyncScrollBar.fire(),this._activeBuffer.scrollTop=0,this._activeBuffer.scrollBottom=this._bufferService.rows-1,this._curAttrData=e.DEFAULT_ATTR_DATA.clone(),this._coreService.reset(),this._charsetService.reset(),this._activeBuffer.savedX=0,this._activeBuffer.savedY=this._activeBuffer.ybase,this._activeBuffer.savedCurAttrData.fg=this._curAttrData.fg,this._activeBuffer.savedCurAttrData.bg=this._curAttrData.bg,this._activeBuffer.savedCharset=this._charsetService.charset,this._coreService.decPrivateModes.origin=!1,!0}setCursorStyle(S){const b=S.params[0]||1;switch(b){case 1:case 2:this._optionsService.options.cursorStyle="block";break;case 3:case 4:this._optionsService.options.cursorStyle="underline";break;case 5:case 6:this._optionsService.options.cursorStyle="bar"}const L=b%2==1;return this._optionsService.options.cursorBlink=L,!0}setScrollRegion(S){const b=S.params[0]||1;let L;return(S.length<2||(L=S.params[1])>this._bufferService.rows||L===0)&&(L=this._bufferService.rows),L>b&&(this._activeBuffer.scrollTop=b-1,this._activeBuffer.scrollBottom=L-1,this._setCursor(0,0)),!0}windowOptions(S){if(!w(S.params[0],this._optionsService.rawOptions.windowOptions))return!0;const b=S.length>1?S.params[1]:0;switch(S.params[0]){case 14:b!==2&&this._onRequestWindowsOptionsReport.fire(y.GET_WIN_SIZE_PIXELS);break;case 16:this._onRequestWindowsOptionsReport.fire(y.GET_CELL_SIZE_PIXELS);break;case 18:this._bufferService&&this._coreService.triggerDataEvent(`${c.C0.ESC}[8;${this._bufferService.rows};${this._bufferService.cols}t`);break;case 22:b!==0&&b!==2||(this._windowTitleStack.push(this._windowTitle),this._windowTitleStack.length>10&&this._windowTitleStack.shift()),b!==0&&b!==1||(this._iconNameStack.push(this._iconName),this._iconNameStack.length>10&&this._iconNameStack.shift());break;case 23:b!==0&&b!==2||this._windowTitleStack.length&&this.setTitle(this._windowTitleStack.pop()),b!==0&&b!==1||this._iconNameStack.length&&this.setIconName(this._iconNameStack.pop())}return!0}saveCursor(S){return this._activeBuffer.savedX=this._activeBuffer.x,this._activeBuffer.savedY=this._activeBuffer.ybase+this._activeBuffer.y,this._activeBuffer.savedCurAttrData.fg=this._curAttrData.fg,this._activeBuffer.savedCurAttrData.bg=this._curAttrData.bg,this._activeBuffer.savedCharset=this._charsetService.charset,!0}restoreCursor(S){return this._activeBuffer.x=this._activeBuffer.savedX||0,this._activeBuffer.y=Math.max(this._activeBuffer.savedY-this._activeBuffer.ybase,0),this._curAttrData.fg=this._activeBuffer.savedCurAttrData.fg,this._curAttrData.bg=this._activeBuffer.savedCurAttrData.bg,this._charsetService.charset=this._savedCharset,this._activeBuffer.savedCharset&&(this._charsetService.charset=this._activeBuffer.savedCharset),this._restrictCursor(),!0}setTitle(S){return this._windowTitle=S,this._onTitleChange.fire(S),!0}setIconName(S){return this._iconName=S,!0}setOrReportIndexedColor(S){const b=[],L=S.split(";");for(;L.length>1;){const R=L.shift(),M=L.shift();if(/^\d+$/.exec(R)){const F=parseInt(R);if(0<=F&&F<256)if(M==="?")b.push({type:0,index:F});else{const N=(0,h.parseColor)(M);N&&b.push({type:1,index:F,color:N})}}}return b.length&&this._onColor.fire(b),!0}setHyperlink(S){const b=S.split(";");return!(b.length<2)&&(b[1]?this._createHyperlink(b[0],b[1]):!b[0]&&this._finishHyperlink())}_createHyperlink(S,b){this._getCurrentLinkId()&&this._finishHyperlink();const L=S.split(":");let R;const M=L.findIndex(F=>F.startsWith("id="));return M!==-1&&(R=L[M].slice(3)||void 0),this._curAttrData.extended=this._curAttrData.extended.clone(),this._curAttrData.extended.urlId=this._oscLinkService.registerLink({id:R,uri:b}),this._curAttrData.updateExtended(),!0}_finishHyperlink(){return this._curAttrData.extended=this._curAttrData.extended.clone(),this._curAttrData.extended.urlId=0,this._curAttrData.updateExtended(),!0}_setOrReportSpecialColor(S,b){const L=S.split(";");for(let R=0;R<L.length&&!(b>=this._specialColors.length);++R,++b)if(L[R]==="?")this._onColor.fire([{type:0,index:this._specialColors[b]}]);else{const M=(0,h.parseColor)(L[R]);M&&this._onColor.fire([{type:1,index:this._specialColors[b],color:M}])}return!0}setOrReportFgColor(S){return this._setOrReportSpecialColor(S,0)}setOrReportBgColor(S){return this._setOrReportSpecialColor(S,1)}setOrReportCursorColor(S){return this._setOrReportSpecialColor(S,2)}restoreIndexedColor(S){if(!S)return this._onColor.fire([{type:2}]),!0;const b=[],L=S.split(";");for(let R=0;R<L.length;++R)if(/^\d+$/.exec(L[R])){const M=parseInt(L[R]);0<=M&&M<256&&b.push({type:2,index:M})}return b.length&&this._onColor.fire(b),!0}restoreFgColor(S){return this._onColor.fire([{type:2,index:256}]),!0}restoreBgColor(S){return this._onColor.fire([{type:2,index:257}]),!0}restoreCursorColor(S){return this._onColor.fire([{type:2,index:258}]),!0}nextLine(){return this._activeBuffer.x=0,this.index(),!0}keypadApplicationMode(){return this._logService.debug("Serial port requested application keypad."),this._coreService.decPrivateModes.applicationKeypad=!0,this._onRequestSyncScrollBar.fire(),!0}keypadNumericMode(){return this._logService.debug("Switching back to normal keypad."),this._coreService.decPrivateModes.applicationKeypad=!1,this._onRequestSyncScrollBar.fire(),!0}selectDefaultCharset(){return this._charsetService.setgLevel(0),this._charsetService.setgCharset(0,n.DEFAULT_CHARSET),!0}selectCharset(S){return S.length!==2?(this.selectDefaultCharset(),!0):(S[0]==="/"||this._charsetService.setgCharset(p[S[0]],n.CHARSETS[S[1]]||n.DEFAULT_CHARSET),!0)}index(){return this._restrictCursor(),this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData())):this._activeBuffer.y>=this._bufferService.rows&&(this._activeBuffer.y=this._bufferService.rows-1),this._restrictCursor(),!0}tabSet(){return this._activeBuffer.tabs[this._activeBuffer.x]=!0,!0}reverseIndex(){if(this._restrictCursor(),this._activeBuffer.y===this._activeBuffer.scrollTop){const S=this._activeBuffer.scrollBottom-this._activeBuffer.scrollTop;this._activeBuffer.lines.shiftElements(this._activeBuffer.ybase+this._activeBuffer.y,S,1),this._activeBuffer.lines.set(this._activeBuffer.ybase+this._activeBuffer.y,this._activeBuffer.getBlankLine(this._eraseAttrData())),this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom)}else this._activeBuffer.y--,this._restrictCursor();return!0}fullReset(){return this._parser.reset(),this._onRequestReset.fire(),!0}reset(){this._curAttrData=e.DEFAULT_ATTR_DATA.clone(),this._eraseAttrDataInternal=e.DEFAULT_ATTR_DATA.clone()}_eraseAttrData(){return this._eraseAttrDataInternal.bg&=-67108864,this._eraseAttrDataInternal.bg|=67108863&this._curAttrData.bg,this._eraseAttrDataInternal}setgLevel(S){return this._charsetService.setgLevel(S),!0}screenAlignmentPattern(){const S=new t.CellData;S.content=4194304|"E".charCodeAt(0),S.fg=this._curAttrData.fg,S.bg=this._curAttrData.bg,this._setCursor(0,0);for(let b=0;b<this._bufferService.rows;++b){const L=this._activeBuffer.ybase+this._activeBuffer.y+b,R=this._activeBuffer.lines.get(L);R&&(R.fill(S),R.isWrapped=!1)}return this._dirtyRowTracker.markAllDirty(),this._setCursor(0,0),!0}requestStatusString(S,b){const L=this._bufferService.buffer,R=this._optionsService.rawOptions;return(M=>(this._coreService.triggerDataEvent(`${c.C0.ESC}${M}${c.C0.ESC}\\`),!0))(S==='"q'?`P1$r${this._curAttrData.isProtected()?1:0}"q`:S==='"p'?'P1$r61;1"p':S==="r"?`P1$r${L.scrollTop+1};${L.scrollBottom+1}r`:S==="m"?"P1$r0m":S===" q"?`P1$r${{block:2,underline:4,bar:6}[R.cursorStyle]-(R.cursorBlink?1:0)} q`:"P0$r")}markRangeDirty(S,b){this._dirtyRowTracker.markRangeDirty(S,b)}}i.InputHandler=B;let I=class{constructor(H){this._bufferService=H,this.clearRange()}clearRange(){this.start=this._bufferService.buffer.y,this.end=this._bufferService.buffer.y}markDirty(H){H<this.start?this.start=H:H>this.end&&(this.end=H)}markRangeDirty(H,S){H>S&&(D=H,H=S,S=D),H<this.start&&(this.start=H),S>this.end&&(this.end=S)}markAllDirty(){this.markRangeDirty(0,this._bufferService.rows-1)}};I=_([v(0,u.IBufferService)],I)},844:(A,i)=>{function l(_){for(const v of _)v.dispose();_.length=0}Object.defineProperty(i,"__esModule",{value:!0}),i.getDisposeArrayDisposable=i.disposeArray=i.toDisposable=i.Disposable=void 0,i.Disposable=class{constructor(){this._disposables=[],this._isDisposed=!1}dispose(){this._isDisposed=!0;for(const _ of this._disposables)_.dispose();this._disposables.length=0}register(_){return this._disposables.push(_),_}unregister(_){const v=this._disposables.indexOf(_);v!==-1&&this._disposables.splice(v,1)}},i.toDisposable=function(_){return{dispose:_}},i.disposeArray=l,i.getDisposeArrayDisposable=function(_){return{dispose:()=>l(_)}}},1505:(A,i)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.FourKeyMap=i.TwoKeyMap=void 0;class l{constructor(){this._data={}}set(v,c,n){this._data[v]||(this._data[v]={}),this._data[v][c]=n}get(v,c){return this._data[v]?this._data[v][c]:void 0}clear(){this._data={}}}i.TwoKeyMap=l,i.FourKeyMap=class{constructor(){this._data=new l}set(_,v,c,n,f){this._data.get(_,v)||this._data.set(_,v,new l),this._data.get(_,v).set(c,n,f)}get(_,v,c,n){var f;return(f=this._data.get(_,v))===null||f===void 0?void 0:f.get(c,n)}clear(){this._data.clear()}}},6114:(A,i)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.isChromeOS=i.isLinux=i.isWindows=i.isIphone=i.isIpad=i.isMac=i.getSafariVersion=i.isSafari=i.isLegacyEdge=i.isFirefox=i.isNode=void 0,i.isNode=typeof navigator>"u";const l=i.isNode?"node":navigator.userAgent,_=i.isNode?"node":navigator.platform;i.isFirefox=l.includes("Firefox"),i.isLegacyEdge=l.includes("Edge"),i.isSafari=/^((?!chrome|android).)*safari/i.test(l),i.getSafariVersion=function(){if(!i.isSafari)return 0;const v=l.match(/Version\/(\d+)/);return v===null||v.length<2?0:parseInt(v[1])},i.isMac=["Macintosh","MacIntel","MacPPC","Mac68K"].includes(_),i.isIpad=_==="iPad",i.isIphone=_==="iPhone",i.isWindows=["Windows","Win16","Win32","WinCE"].includes(_),i.isLinux=_.indexOf("Linux")>=0,i.isChromeOS=/\bCrOS\b/.test(l)},6106:(A,i)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.SortedList=void 0;let l=0;i.SortedList=class{constructor(_){this._getKey=_,this._array=[]}clear(){this._array.length=0}insert(_){this._array.length!==0?(l=this._search(this._getKey(_),0,this._array.length-1),this._array.splice(l,0,_)):this._array.push(_)}delete(_){if(this._array.length===0)return!1;const v=this._getKey(_);if(v===void 0||(l=this._search(v,0,this._array.length-1),l===-1)||this._getKey(this._array[l])!==v)return!1;do if(this._array[l]===_)return this._array.splice(l,1),!0;while(++l<this._array.length&&this._getKey(this._array[l])===v);return!1}*getKeyIterator(_){if(this._array.length!==0&&(l=this._search(_,0,this._array.length-1),!(l<0||l>=this._array.length)&&this._getKey(this._array[l])===_))do yield this._array[l];while(++l<this._array.length&&this._getKey(this._array[l])===_)}forEachByKey(_,v){if(this._array.length!==0&&(l=this._search(_,0,this._array.length-1),!(l<0||l>=this._array.length)&&this._getKey(this._array[l])===_))do v(this._array[l]);while(++l<this._array.length&&this._getKey(this._array[l])===_)}values(){return this._array.values()}_search(_,v,c){if(c<v)return v;let n=Math.floor((v+c)/2);const f=this._getKey(this._array[n]);if(f>_)return this._search(_,v,n-1);if(f<_)return this._search(_,n+1,c);for(;n>0&&this._getKey(this._array[n-1])===_;)n--;return n}}},7226:(A,i,l)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.DebouncedIdleTask=i.IdleTaskQueue=i.PriorityTaskQueue=void 0;const _=l(6114);class v{constructor(){this._tasks=[],this._i=0}enqueue(f){this._tasks.push(f),this._start()}flush(){for(;this._i<this._tasks.length;)this._tasks[this._i]()||this._i++;this.clear()}clear(){this._idleCallback&&(this._cancelCallback(this._idleCallback),this._idleCallback=void 0),this._i=0,this._tasks.length=0}_start(){this._idleCallback||(this._idleCallback=this._requestCallback(this._process.bind(this)))}_process(f){this._idleCallback=void 0;let d=0,a=0,e=f.timeRemaining(),s=0;for(;this._i<this._tasks.length;){if(d=Date.now(),this._tasks[this._i]()||this._i++,d=Math.max(1,Date.now()-d),a=Math.max(d,a),s=f.timeRemaining(),1.5*a>s)return e-d<-20&&console.warn(`task queue exceeded allotted deadline by ${Math.abs(Math.round(e-d))}ms`),void this._start();e=s}this.clear()}}class c extends v{_requestCallback(f){return setTimeout(()=>f(this._createDeadline(16)))}_cancelCallback(f){clearTimeout(f)}_createDeadline(f){const d=Date.now()+f;return{timeRemaining:()=>Math.max(0,d-Date.now())}}}i.PriorityTaskQueue=c,i.IdleTaskQueue=!_.isNode&&"requestIdleCallback"in window?class extends v{_requestCallback(n){return requestIdleCallback(n)}_cancelCallback(n){cancelIdleCallback(n)}}:c,i.DebouncedIdleTask=class{constructor(){this._queue=new i.IdleTaskQueue}set(n){this._queue.clear(),this._queue.enqueue(n)}flush(){this._queue.flush()}}},9282:(A,i,l)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.updateWindowsModeWrappedState=void 0;const _=l(643);i.updateWindowsModeWrappedState=function(v){const c=v.buffer.lines.get(v.buffer.ybase+v.buffer.y-1),n=c==null?void 0:c.get(v.cols-1),f=v.buffer.lines.get(v.buffer.ybase+v.buffer.y);f&&n&&(f.isWrapped=n[_.CHAR_DATA_CODE_INDEX]!==_.NULL_CELL_CODE&&n[_.CHAR_DATA_CODE_INDEX]!==_.WHITESPACE_CELL_CODE)}},3734:(A,i)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.ExtendedAttrs=i.AttributeData=void 0;class l{constructor(){this.fg=0,this.bg=0,this.extended=new _}static toColorRGB(c){return[c>>>16&255,c>>>8&255,255&c]}static fromColorRGB(c){return(255&c[0])<<16|(255&c[1])<<8|255&c[2]}clone(){const c=new l;return c.fg=this.fg,c.bg=this.bg,c.extended=this.extended.clone(),c}isInverse(){return 67108864&this.fg}isBold(){return 134217728&this.fg}isUnderline(){return this.hasExtendedAttrs()&&this.extended.underlineStyle!==0?1:268435456&this.fg}isBlink(){return 536870912&this.fg}isInvisible(){return 1073741824&this.fg}isItalic(){return 67108864&this.bg}isDim(){return 134217728&this.bg}isStrikethrough(){return 2147483648&this.fg}isProtected(){return 536870912&this.bg}getFgColorMode(){return 50331648&this.fg}getBgColorMode(){return 50331648&this.bg}isFgRGB(){return(50331648&this.fg)==50331648}isBgRGB(){return(50331648&this.bg)==50331648}isFgPalette(){return(50331648&this.fg)==16777216||(50331648&this.fg)==33554432}isBgPalette(){return(50331648&this.bg)==16777216||(50331648&this.bg)==33554432}isFgDefault(){return(50331648&this.fg)==0}isBgDefault(){return(50331648&this.bg)==0}isAttributeDefault(){return this.fg===0&&this.bg===0}getFgColor(){switch(50331648&this.fg){case 16777216:case 33554432:return 255&this.fg;case 50331648:return 16777215&this.fg;default:return-1}}getBgColor(){switch(50331648&this.bg){case 16777216:case 33554432:return 255&this.bg;case 50331648:return 16777215&this.bg;default:return-1}}hasExtendedAttrs(){return 268435456&this.bg}updateExtended(){this.extended.isEmpty()?this.bg&=-268435457:this.bg|=268435456}getUnderlineColor(){if(268435456&this.bg&&~this.extended.underlineColor)switch(50331648&this.extended.underlineColor){case 16777216:case 33554432:return 255&this.extended.underlineColor;case 50331648:return 16777215&this.extended.underlineColor;default:return this.getFgColor()}return this.getFgColor()}getUnderlineColorMode(){return 268435456&this.bg&&~this.extended.underlineColor?50331648&this.extended.underlineColor:this.getFgColorMode()}isUnderlineColorRGB(){return 268435456&this.bg&&~this.extended.underlineColor?(50331648&this.extended.underlineColor)==50331648:this.isFgRGB()}isUnderlineColorPalette(){return 268435456&this.bg&&~this.extended.underlineColor?(50331648&this.extended.underlineColor)==16777216||(50331648&this.extended.underlineColor)==33554432:this.isFgPalette()}isUnderlineColorDefault(){return 268435456&this.bg&&~this.extended.underlineColor?(50331648&this.extended.underlineColor)==0:this.isFgDefault()}getUnderlineStyle(){return 268435456&this.fg?268435456&this.bg?this.extended.underlineStyle:1:0}}i.AttributeData=l;class _{constructor(c=0,n=0){this._ext=0,this._urlId=0,this._ext=c,this._urlId=n}get ext(){return this._urlId?-469762049&this._ext|this.underlineStyle<<26:this._ext}set ext(c){this._ext=c}get underlineStyle(){return this._urlId?5:(469762048&this._ext)>>26}set underlineStyle(c){this._ext&=-469762049,this._ext|=c<<26&469762048}get underlineColor(){return 67108863&this._ext}set underlineColor(c){this._ext&=-67108864,this._ext|=67108863&c}get urlId(){return this._urlId}set urlId(c){this._urlId=c}clone(){return new _(this._ext,this._urlId)}isEmpty(){return this.underlineStyle===0&&this._urlId===0}}i.ExtendedAttrs=_},9092:(A,i,l)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.BufferStringIterator=i.Buffer=i.MAX_BUFFER_SIZE=void 0;const _=l(6349),v=l(8437),c=l(511),n=l(643),f=l(4634),d=l(4863),a=l(7116),e=l(3734),s=l(7226);i.MAX_BUFFER_SIZE=4294967295,i.Buffer=class{constructor(t,o,u){this._hasScrollback=t,this._optionsService=o,this._bufferService=u,this.ydisp=0,this.ybase=0,this.y=0,this.x=0,this.tabs={},this.savedY=0,this.savedX=0,this.savedCurAttrData=v.DEFAULT_ATTR_DATA.clone(),this.savedCharset=a.DEFAULT_CHARSET,this.markers=[],this._nullCell=c.CellData.fromCharData([0,n.NULL_CELL_CHAR,n.NULL_CELL_WIDTH,n.NULL_CELL_CODE]),this._whitespaceCell=c.CellData.fromCharData([0,n.WHITESPACE_CELL_CHAR,n.WHITESPACE_CELL_WIDTH,n.WHITESPACE_CELL_CODE]),this._isClearing=!1,this._memoryCleanupQueue=new s.IdleTaskQueue,this._memoryCleanupPosition=0,this._cols=this._bufferService.cols,this._rows=this._bufferService.rows,this.lines=new _.CircularList(this._getCorrectBufferLength(this._rows)),this.scrollTop=0,this.scrollBottom=this._rows-1,this.setupTabStops()}getNullCell(t){return t?(this._nullCell.fg=t.fg,this._nullCell.bg=t.bg,this._nullCell.extended=t.extended):(this._nullCell.fg=0,this._nullCell.bg=0,this._nullCell.extended=new e.ExtendedAttrs),this._nullCell}getWhitespaceCell(t){return t?(this._whitespaceCell.fg=t.fg,this._whitespaceCell.bg=t.bg,this._whitespaceCell.extended=t.extended):(this._whitespaceCell.fg=0,this._whitespaceCell.bg=0,this._whitespaceCell.extended=new e.ExtendedAttrs),this._whitespaceCell}getBlankLine(t,o){return new v.BufferLine(this._bufferService.cols,this.getNullCell(t),o)}get hasScrollback(){return this._hasScrollback&&this.lines.maxLength>this._rows}get isCursorInViewport(){const t=this.ybase+this.y-this.ydisp;return t>=0&&t<this._rows}_getCorrectBufferLength(t){if(!this._hasScrollback)return t;const o=t+this._optionsService.rawOptions.scrollback;return o>i.MAX_BUFFER_SIZE?i.MAX_BUFFER_SIZE:o}fillViewportRows(t){if(this.lines.length===0){t===void 0&&(t=v.DEFAULT_ATTR_DATA);let o=this._rows;for(;o--;)this.lines.push(this.getBlankLine(t))}}clear(){this.ydisp=0,this.ybase=0,this.y=0,this.x=0,this.lines=new _.CircularList(this._getCorrectBufferLength(this._rows)),this.scrollTop=0,this.scrollBottom=this._rows-1,this.setupTabStops()}resize(t,o){const u=this.getNullCell(v.DEFAULT_ATTR_DATA);let g=0;const m=this._getCorrectBufferLength(o);if(m>this.lines.maxLength&&(this.lines.maxLength=m),this.lines.length>0){if(this._cols<t)for(let p=0;p<this.lines.length;p++)g+=+this.lines.get(p).resize(t,u);let h=0;if(this._rows<o)for(let p=this._rows;p<o;p++)this.lines.length<o+this.ybase&&(this._optionsService.rawOptions.windowsMode?this.lines.push(new v.BufferLine(t,u)):this.ybase>0&&this.lines.length<=this.ybase+this.y+h+1?(this.ybase--,h++,this.ydisp>0&&this.ydisp--):this.lines.push(new v.BufferLine(t,u)));else for(let p=this._rows;p>o;p--)this.lines.length>o+this.ybase&&(this.lines.length>this.ybase+this.y+1?this.lines.pop():(this.ybase++,this.ydisp++));if(m<this.lines.maxLength){const p=this.lines.length-m;p>0&&(this.lines.trimStart(p),this.ybase=Math.max(this.ybase-p,0),this.ydisp=Math.max(this.ydisp-p,0),this.savedY=Math.max(this.savedY-p,0)),this.lines.maxLength=m}this.x=Math.min(this.x,t-1),this.y=Math.min(this.y,o-1),h&&(this.y+=h),this.savedX=Math.min(this.savedX,t-1),this.scrollTop=0}if(this.scrollBottom=o-1,this._isReflowEnabled&&(this._reflow(t,o),this._cols>t))for(let h=0;h<this.lines.length;h++)g+=+this.lines.get(h).resize(t,u);this._cols=t,this._rows=o,this._memoryCleanupQueue.clear(),g>.1*this.lines.length&&(this._memoryCleanupPosition=0,this._memoryCleanupQueue.enqueue(()=>this._batchedMemoryCleanup()))}_batchedMemoryCleanup(){let t=!0;this._memoryCleanupPosition>=this.lines.length&&(this._memoryCleanupPosition=0,t=!1);let o=0;for(;this._memoryCleanupPosition<this.lines.length;)if(o+=this.lines.get(this._memoryCleanupPosition++).cleanupMemory(),o>100)return!0;return t}get _isReflowEnabled(){return this._hasScrollback&&!this._optionsService.rawOptions.windowsMode}_reflow(t,o){this._cols!==t&&(t>this._cols?this._reflowLarger(t,o):this._reflowSmaller(t,o))}_reflowLarger(t,o){const u=(0,f.reflowLargerGetLinesToRemove)(this.lines,this._cols,t,this.ybase+this.y,this.getNullCell(v.DEFAULT_ATTR_DATA));if(u.length>0){const g=(0,f.reflowLargerCreateNewLayout)(this.lines,u);(0,f.reflowLargerApplyNewLayout)(this.lines,g.layout),this._reflowLargerAdjustViewport(t,o,g.countRemoved)}}_reflowLargerAdjustViewport(t,o,u){const g=this.getNullCell(v.DEFAULT_ATTR_DATA);let m=u;for(;m-- >0;)this.ybase===0?(this.y>0&&this.y--,this.lines.length<o&&this.lines.push(new v.BufferLine(t,g))):(this.ydisp===this.ybase&&this.ydisp--,this.ybase--);this.savedY=Math.max(this.savedY-u,0)}_reflowSmaller(t,o){const u=this.getNullCell(v.DEFAULT_ATTR_DATA),g=[];let m=0;for(let h=this.lines.length-1;h>=0;h--){let p=this.lines.get(h);if(!p||!p.isWrapped&&p.getTrimmedLength()<=t)continue;const C=[p];for(;p.isWrapped&&h>0;)p=this.lines.get(--h),C.unshift(p);const w=this.ybase+this.y;if(w>=h&&w<h+C.length)continue;const y=C[C.length-1].getTrimmedLength(),D=(0,f.reflowSmallerGetNewLineLengths)(C,this._cols,t),B=D.length-C.length;let I;I=this.ybase===0&&this.y!==this.lines.length-1?Math.max(0,this.y-this.lines.maxLength+B):Math.max(0,this.lines.length-this.lines.maxLength+B);const H=[];for(let F=0;F<B;F++){const N=this.getBlankLine(v.DEFAULT_ATTR_DATA,!0);H.push(N)}H.length>0&&(g.push({start:h+C.length+m,newLines:H}),m+=H.length),C.push(...H);let S=D.length-1,b=D[S];b===0&&(S--,b=D[S]);let L=C.length-B-1,R=y;for(;L>=0;){const F=Math.min(R,b);if(C[S]===void 0)break;if(C[S].copyCellsFrom(C[L],R-F,b-F,F,!0),b-=F,b===0&&(S--,b=D[S]),R-=F,R===0){L--;const N=Math.max(L,0);R=(0,f.getWrappedLineTrimmedLength)(C,N,this._cols)}}for(let F=0;F<C.length;F++)D[F]<t&&C[F].setCell(D[F],u);let M=B-I;for(;M-- >0;)this.ybase===0?this.y<o-1?(this.y++,this.lines.pop()):(this.ybase++,this.ydisp++):this.ybase<Math.min(this.lines.maxLength,this.lines.length+m)-o&&(this.ybase===this.ydisp&&this.ydisp++,this.ybase++);this.savedY=Math.min(this.savedY+B,this.ybase+o-1)}if(g.length>0){const h=[],p=[];for(let S=0;S<this.lines.length;S++)p.push(this.lines.get(S));const C=this.lines.length;let w=C-1,y=0,D=g[y];this.lines.length=Math.min(this.lines.maxLength,this.lines.length+m);let B=0;for(let S=Math.min(this.lines.maxLength-1,C+m-1);S>=0;S--)if(D&&D.start>w+B){for(let b=D.newLines.length-1;b>=0;b--)this.lines.set(S--,D.newLines[b]);S++,h.push({index:w+1,amount:D.newLines.length}),B+=D.newLines.length,D=g[++y]}else this.lines.set(S,p[w--]);let I=0;for(let S=h.length-1;S>=0;S--)h[S].index+=I,this.lines.onInsertEmitter.fire(h[S]),I+=h[S].amount;const H=Math.max(0,C+m-this.lines.maxLength);H>0&&this.lines.onTrimEmitter.fire(H)}}stringIndexToBufferIndex(t,o,u=!1){for(;o;){const g=this.lines.get(t);if(!g)return[-1,-1];const m=u?g.getTrimmedLength():g.length;for(let h=0;h<m;++h)if(g.get(h)[n.CHAR_DATA_WIDTH_INDEX]&&(o-=g.get(h)[n.CHAR_DATA_CHAR_INDEX].length||1),o<0)return[t,h];t++}return[t,0]}translateBufferLineToString(t,o,u=0,g){const m=this.lines.get(t);return m?m.translateToString(o,u,g):""}getWrappedRangeForLine(t){let o=t,u=t;for(;o>0&&this.lines.get(o).isWrapped;)o--;for(;u+1<this.lines.length&&this.lines.get(u+1).isWrapped;)u++;return{first:o,last:u}}setupTabStops(t){for(t!=null?this.tabs[t]||(t=this.prevStop(t)):(this.tabs={},t=0);t<this._cols;t+=this._optionsService.rawOptions.tabStopWidth)this.tabs[t]=!0}prevStop(t){for(t==null&&(t=this.x);!this.tabs[--t]&&t>0;);return t>=this._cols?this._cols-1:t<0?0:t}nextStop(t){for(t==null&&(t=this.x);!this.tabs[++t]&&t<this._cols;);return t>=this._cols?this._cols-1:t<0?0:t}clearMarkers(t){this._isClearing=!0;for(let o=0;o<this.markers.length;o++)this.markers[o].line===t&&(this.markers[o].dispose(),this.markers.splice(o--,1));this._isClearing=!1}clearAllMarkers(){this._isClearing=!0;for(let t=0;t<this.markers.length;t++)this.markers[t].dispose(),this.markers.splice(t--,1);this._isClearing=!1}addMarker(t){const o=new d.Marker(t);return this.markers.push(o),o.register(this.lines.onTrim(u=>{o.line-=u,o.line<0&&o.dispose()})),o.register(this.lines.onInsert(u=>{o.line>=u.index&&(o.line+=u.amount)})),o.register(this.lines.onDelete(u=>{o.line>=u.index&&o.line<u.index+u.amount&&o.dispose(),o.line>u.index&&(o.line-=u.amount)})),o.register(o.onDispose(()=>this._removeMarker(o))),o}_removeMarker(t){this._isClearing||this.markers.splice(this.markers.indexOf(t),1)}iterator(t,o,u,g,m){return new r(this,t,o,u,g,m)}};class r{constructor(o,u,g=0,m=o.lines.length,h=0,p=0){this._buffer=o,this._trimRight=u,this._startIndex=g,this._endIndex=m,this._startOverscan=h,this._endOverscan=p,this._startIndex<0&&(this._startIndex=0),this._endIndex>this._buffer.lines.length&&(this._endIndex=this._buffer.lines.length),this._current=this._startIndex}hasNext(){return this._current<this._endIndex}next(){const o=this._buffer.getWrappedRangeForLine(this._current);o.first<this._startIndex-this._startOverscan&&(o.first=this._startIndex-this._startOverscan),o.last>this._endIndex+this._endOverscan&&(o.last=this._endIndex+this._endOverscan),o.first=Math.max(o.first,0),o.last=Math.min(o.last,this._buffer.lines.length);let u="";for(let g=o.first;g<=o.last;++g)u+=this._buffer.translateBufferLineToString(g,this._trimRight);return this._current=o.last+1,{range:o,content:u}}}i.BufferStringIterator=r},8437:(A,i,l)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.BufferLine=i.DEFAULT_ATTR_DATA=void 0;const _=l(482),v=l(643),c=l(511),n=l(3734);i.DEFAULT_ATTR_DATA=Object.freeze(new n.AttributeData);let f=0;class d{constructor(e,s,r=!1){this.isWrapped=r,this._combined={},this._extendedAttrs={},this._data=new Uint32Array(3*e);const t=s||c.CellData.fromCharData([0,v.NULL_CELL_CHAR,v.NULL_CELL_WIDTH,v.NULL_CELL_CODE]);for(let o=0;o<e;++o)this.setCell(o,t);this.length=e}get(e){const s=this._data[3*e+0],r=2097151&s;return[this._data[3*e+1],2097152&s?this._combined[e]:r?(0,_.stringFromCodePoint)(r):"",s>>22,2097152&s?this._combined[e].charCodeAt(this._combined[e].length-1):r]}set(e,s){this._data[3*e+1]=s[v.CHAR_DATA_ATTR_INDEX],s[v.CHAR_DATA_CHAR_INDEX].length>1?(this._combined[e]=s[1],this._data[3*e+0]=2097152|e|s[v.CHAR_DATA_WIDTH_INDEX]<<22):this._data[3*e+0]=s[v.CHAR_DATA_CHAR_INDEX].charCodeAt(0)|s[v.CHAR_DATA_WIDTH_INDEX]<<22}getWidth(e){return this._data[3*e+0]>>22}hasWidth(e){return 12582912&this._data[3*e+0]}getFg(e){return this._data[3*e+1]}getBg(e){return this._data[3*e+2]}hasContent(e){return 4194303&this._data[3*e+0]}getCodePoint(e){const s=this._data[3*e+0];return 2097152&s?this._combined[e].charCodeAt(this._combined[e].length-1):2097151&s}isCombined(e){return 2097152&this._data[3*e+0]}getString(e){const s=this._data[3*e+0];return 2097152&s?this._combined[e]:2097151&s?(0,_.stringFromCodePoint)(2097151&s):""}isProtected(e){return 536870912&this._data[3*e+2]}loadCell(e,s){return f=3*e,s.content=this._data[f+0],s.fg=this._data[f+1],s.bg=this._data[f+2],2097152&s.content&&(s.combinedData=this._combined[e]),268435456&s.bg&&(s.extended=this._extendedAttrs[e]),s}setCell(e,s){2097152&s.content&&(this._combined[e]=s.combinedData),268435456&s.bg&&(this._extendedAttrs[e]=s.extended),this._data[3*e+0]=s.content,this._data[3*e+1]=s.fg,this._data[3*e+2]=s.bg}setCellFromCodePoint(e,s,r,t,o,u){268435456&o&&(this._extendedAttrs[e]=u),this._data[3*e+0]=s|r<<22,this._data[3*e+1]=t,this._data[3*e+2]=o}addCodepointToCell(e,s){let r=this._data[3*e+0];2097152&r?this._combined[e]+=(0,_.stringFromCodePoint)(s):(2097151&r?(this._combined[e]=(0,_.stringFromCodePoint)(2097151&r)+(0,_.stringFromCodePoint)(s),r&=-2097152,r|=2097152):r=s|4194304,this._data[3*e+0]=r)}insertCells(e,s,r,t){if((e%=this.length)&&this.getWidth(e-1)===2&&this.setCellFromCodePoint(e-1,0,1,(t==null?void 0:t.fg)||0,(t==null?void 0:t.bg)||0,(t==null?void 0:t.extended)||new n.ExtendedAttrs),s<this.length-e){const o=new c.CellData;for(let u=this.length-e-s-1;u>=0;--u)this.setCell(e+s+u,this.loadCell(e+u,o));for(let u=0;u<s;++u)this.setCell(e+u,r)}else for(let o=e;o<this.length;++o)this.setCell(o,r);this.getWidth(this.length-1)===2&&this.setCellFromCodePoint(this.length-1,0,1,(t==null?void 0:t.fg)||0,(t==null?void 0:t.bg)||0,(t==null?void 0:t.extended)||new n.ExtendedAttrs)}deleteCells(e,s,r,t){if(e%=this.length,s<this.length-e){const o=new c.CellData;for(let u=0;u<this.length-e-s;++u)this.setCell(e+u,this.loadCell(e+s+u,o));for(let u=this.length-s;u<this.length;++u)this.setCell(u,r)}else for(let o=e;o<this.length;++o)this.setCell(o,r);e&&this.getWidth(e-1)===2&&this.setCellFromCodePoint(e-1,0,1,(t==null?void 0:t.fg)||0,(t==null?void 0:t.bg)||0,(t==null?void 0:t.extended)||new n.ExtendedAttrs),this.getWidth(e)!==0||this.hasContent(e)||this.setCellFromCodePoint(e,0,1,(t==null?void 0:t.fg)||0,(t==null?void 0:t.bg)||0,(t==null?void 0:t.extended)||new n.ExtendedAttrs)}replaceCells(e,s,r,t,o=!1){if(o)for(e&&this.getWidth(e-1)===2&&!this.isProtected(e-1)&&this.setCellFromCodePoint(e-1,0,1,(t==null?void 0:t.fg)||0,(t==null?void 0:t.bg)||0,(t==null?void 0:t.extended)||new n.ExtendedAttrs),s<this.length&&this.getWidth(s-1)===2&&!this.isProtected(s)&&this.setCellFromCodePoint(s,0,1,(t==null?void 0:t.fg)||0,(t==null?void 0:t.bg)||0,(t==null?void 0:t.extended)||new n.ExtendedAttrs);e<s&&e<this.length;)this.isProtected(e)||this.setCell(e,r),e++;else for(e&&this.getWidth(e-1)===2&&this.setCellFromCodePoint(e-1,0,1,(t==null?void 0:t.fg)||0,(t==null?void 0:t.bg)||0,(t==null?void 0:t.extended)||new n.ExtendedAttrs),s<this.length&&this.getWidth(s-1)===2&&this.setCellFromCodePoint(s,0,1,(t==null?void 0:t.fg)||0,(t==null?void 0:t.bg)||0,(t==null?void 0:t.extended)||new n.ExtendedAttrs);e<s&&e<this.length;)this.setCell(e++,r)}resize(e,s){if(e===this.length)return 4*this._data.length*2<this._data.buffer.byteLength;const r=3*e;if(e>this.length){if(this._data.buffer.byteLength>=4*r)this._data=new Uint32Array(this._data.buffer,0,r);else{const t=new Uint32Array(r);t.set(this._data),this._data=t}for(let t=this.length;t<e;++t)this.setCell(t,s)}else{this._data=this._data.subarray(0,r);const t=Object.keys(this._combined);for(let u=0;u<t.length;u++){const g=parseInt(t[u],10);g>=e&&delete this._combined[g]}const o=Object.keys(this._extendedAttrs);for(let u=0;u<o.length;u++){const g=parseInt(o[u],10);g>=e&&delete this._extendedAttrs[g]}}return this.length=e,4*r*2<this._data.buffer.byteLength}cleanupMemory(){if(4*this._data.length*2<this._data.buffer.byteLength){const e=new Uint32Array(this._data.length);return e.set(this._data),this._data=e,1}return 0}fill(e,s=!1){if(s)for(let r=0;r<this.length;++r)this.isProtected(r)||this.setCell(r,e);else{this._combined={},this._extendedAttrs={};for(let r=0;r<this.length;++r)this.setCell(r,e)}}copyFrom(e){this.length!==e.length?this._data=new Uint32Array(e._data):this._data.set(e._data),this.length=e.length,this._combined={};for(const s in e._combined)this._combined[s]=e._combined[s];this._extendedAttrs={};for(const s in e._extendedAttrs)this._extendedAttrs[s]=e._extendedAttrs[s];this.isWrapped=e.isWrapped}clone(){const e=new d(0);e._data=new Uint32Array(this._data),e.length=this.length;for(const s in this._combined)e._combined[s]=this._combined[s];for(const s in this._extendedAttrs)e._extendedAttrs[s]=this._extendedAttrs[s];return e.isWrapped=this.isWrapped,e}getTrimmedLength(){for(let e=this.length-1;e>=0;--e)if(4194303&this._data[3*e+0])return e+(this._data[3*e+0]>>22);return 0}copyCellsFrom(e,s,r,t,o){const u=e._data;if(o)for(let m=t-1;m>=0;m--){for(let h=0;h<3;h++)this._data[3*(r+m)+h]=u[3*(s+m)+h];268435456&u[3*(s+m)+2]&&(this._extendedAttrs[r+m]=e._extendedAttrs[s+m])}else for(let m=0;m<t;m++){for(let h=0;h<3;h++)this._data[3*(r+m)+h]=u[3*(s+m)+h];268435456&u[3*(s+m)+2]&&(this._extendedAttrs[r+m]=e._extendedAttrs[s+m])}const g=Object.keys(e._combined);for(let m=0;m<g.length;m++){const h=parseInt(g[m],10);h>=s&&(this._combined[h-s+r]=e._combined[h])}}translateToString(e=!1,s=0,r=this.length){e&&(r=Math.min(r,this.getTrimmedLength()));let t="";for(;s<r;){const o=this._data[3*s+0],u=2097151&o;t+=2097152&o?this._combined[s]:u?(0,_.stringFromCodePoint)(u):v.WHITESPACE_CELL_CHAR,s+=o>>22||1}return t}}i.BufferLine=d},4841:(A,i)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.getRangeLength=void 0,i.getRangeLength=function(l,_){if(l.start.y>l.end.y)throw new Error(`Buffer range end (${l.end.x}, ${l.end.y}) cannot be before start (${l.start.x}, ${l.start.y})`);return _*(l.end.y-l.start.y)+(l.end.x-l.start.x+1)}},4634:(A,i)=>{function l(_,v,c){if(v===_.length-1)return _[v].getTrimmedLength();const n=!_[v].hasContent(c-1)&&_[v].getWidth(c-1)===1,f=_[v+1].getWidth(0)===2;return n&&f?c-1:c}Object.defineProperty(i,"__esModule",{value:!0}),i.getWrappedLineTrimmedLength=i.reflowSmallerGetNewLineLengths=i.reflowLargerApplyNewLayout=i.reflowLargerCreateNewLayout=i.reflowLargerGetLinesToRemove=void 0,i.reflowLargerGetLinesToRemove=function(_,v,c,n,f){const d=[];for(let a=0;a<_.length-1;a++){let e=a,s=_.get(++e);if(!s.isWrapped)continue;const r=[_.get(a)];for(;e<_.length&&s.isWrapped;)r.push(s),s=_.get(++e);if(n>=a&&n<e){a+=r.length-1;continue}let t=0,o=l(r,t,v),u=1,g=0;for(;u<r.length;){const h=l(r,u,v),p=h-g,C=c-o,w=Math.min(p,C);r[t].copyCellsFrom(r[u],g,o,w,!1),o+=w,o===c&&(t++,o=0),g+=w,g===h&&(u++,g=0),o===0&&t!==0&&r[t-1].getWidth(c-1)===2&&(r[t].copyCellsFrom(r[t-1],c-1,o++,1,!1),r[t-1].setCell(c-1,f))}r[t].replaceCells(o,c,f);let m=0;for(let h=r.length-1;h>0&&(h>t||r[h].getTrimmedLength()===0);h--)m++;m>0&&(d.push(a+r.length-m),d.push(m)),a+=r.length-1}return d},i.reflowLargerCreateNewLayout=function(_,v){const c=[];let n=0,f=v[n],d=0;for(let a=0;a<_.length;a++)if(f===a){const e=v[++n];_.onDeleteEmitter.fire({index:a-d,amount:e}),a+=e-1,d+=e,f=v[++n]}else c.push(a);return{layout:c,countRemoved:d}},i.reflowLargerApplyNewLayout=function(_,v){const c=[];for(let n=0;n<v.length;n++)c.push(_.get(v[n]));for(let n=0;n<c.length;n++)_.set(n,c[n]);_.length=v.length},i.reflowSmallerGetNewLineLengths=function(_,v,c){const n=[],f=_.map((s,r)=>l(_,r,v)).reduce((s,r)=>s+r);let d=0,a=0,e=0;for(;e<f;){if(f-e<c){n.push(f-e);break}d+=c;const s=l(_,a,v);d>s&&(d-=s,a++);const r=_[a].getWidth(d-1)===2;r&&d--;const t=r?c-1:c;n.push(t),e+=t}return n},i.getWrappedLineTrimmedLength=l},5295:(A,i,l)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.BufferSet=void 0;const _=l(9092),v=l(8460),c=l(844);class n extends c.Disposable{constructor(d,a){super(),this._optionsService=d,this._bufferService=a,this._onBufferActivate=this.register(new v.EventEmitter),this.onBufferActivate=this._onBufferActivate.event,this.reset(),this.register(this._optionsService.onSpecificOptionChange("scrollback",()=>this.resize(this._bufferService.cols,this._bufferService.rows))),this.register(this._optionsService.onSpecificOptionChange("tabStopWidth",()=>this.setupTabStops()))}reset(){this._normal=new _.Buffer(!0,this._optionsService,this._bufferService),this._normal.fillViewportRows(),this._alt=new _.Buffer(!1,this._optionsService,this._bufferService),this._activeBuffer=this._normal,this._onBufferActivate.fire({activeBuffer:this._normal,inactiveBuffer:this._alt}),this.setupTabStops()}get alt(){return this._alt}get active(){return this._activeBuffer}get normal(){return this._normal}activateNormalBuffer(){this._activeBuffer!==this._normal&&(this._normal.x=this._alt.x,this._normal.y=this._alt.y,this._alt.clearAllMarkers(),this._alt.clear(),this._activeBuffer=this._normal,this._onBufferActivate.fire({activeBuffer:this._normal,inactiveBuffer:this._alt}))}activateAltBuffer(d){this._activeBuffer!==this._alt&&(this._alt.fillViewportRows(d),this._alt.x=this._normal.x,this._alt.y=this._normal.y,this._activeBuffer=this._alt,this._onBufferActivate.fire({activeBuffer:this._alt,inactiveBuffer:this._normal}))}resize(d,a){this._normal.resize(d,a),this._alt.resize(d,a),this.setupTabStops(d)}setupTabStops(d){this._normal.setupTabStops(d),this._alt.setupTabStops(d)}}i.BufferSet=n},511:(A,i,l)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.CellData=void 0;const _=l(482),v=l(643),c=l(3734);class n extends c.AttributeData{constructor(){super(...arguments),this.content=0,this.fg=0,this.bg=0,this.extended=new c.ExtendedAttrs,this.combinedData=""}static fromCharData(d){const a=new n;return a.setFromCharData(d),a}isCombined(){return 2097152&this.content}getWidth(){return this.content>>22}getChars(){return 2097152&this.content?this.combinedData:2097151&this.content?(0,_.stringFromCodePoint)(2097151&this.content):""}getCode(){return this.isCombined()?this.combinedData.charCodeAt(this.combinedData.length-1):2097151&this.content}setFromCharData(d){this.fg=d[v.CHAR_DATA_ATTR_INDEX],this.bg=0;let a=!1;if(d[v.CHAR_DATA_CHAR_INDEX].length>2)a=!0;else if(d[v.CHAR_DATA_CHAR_INDEX].length===2){const e=d[v.CHAR_DATA_CHAR_INDEX].charCodeAt(0);if(55296<=e&&e<=56319){const s=d[v.CHAR_DATA_CHAR_INDEX].charCodeAt(1);56320<=s&&s<=57343?this.content=1024*(e-55296)+s-56320+65536|d[v.CHAR_DATA_WIDTH_INDEX]<<22:a=!0}else a=!0}else this.content=d[v.CHAR_DATA_CHAR_INDEX].charCodeAt(0)|d[v.CHAR_DATA_WIDTH_INDEX]<<22;a&&(this.combinedData=d[v.CHAR_DATA_CHAR_INDEX],this.content=2097152|d[v.CHAR_DATA_WIDTH_INDEX]<<22)}getAsCharData(){return[this.fg,this.getChars(),this.getWidth(),this.getCode()]}}i.CellData=n},643:(A,i)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.WHITESPACE_CELL_CODE=i.WHITESPACE_CELL_WIDTH=i.WHITESPACE_CELL_CHAR=i.NULL_CELL_CODE=i.NULL_CELL_WIDTH=i.NULL_CELL_CHAR=i.CHAR_DATA_CODE_INDEX=i.CHAR_DATA_WIDTH_INDEX=i.CHAR_DATA_CHAR_INDEX=i.CHAR_DATA_ATTR_INDEX=i.DEFAULT_EXT=i.DEFAULT_ATTR=i.DEFAULT_COLOR=void 0,i.DEFAULT_COLOR=0,i.DEFAULT_ATTR=256|i.DEFAULT_COLOR<<9,i.DEFAULT_EXT=0,i.CHAR_DATA_ATTR_INDEX=0,i.CHAR_DATA_CHAR_INDEX=1,i.CHAR_DATA_WIDTH_INDEX=2,i.CHAR_DATA_CODE_INDEX=3,i.NULL_CELL_CHAR="",i.NULL_CELL_WIDTH=1,i.NULL_CELL_CODE=0,i.WHITESPACE_CELL_CHAR=" ",i.WHITESPACE_CELL_WIDTH=1,i.WHITESPACE_CELL_CODE=32},4863:(A,i,l)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.Marker=void 0;const _=l(8460),v=l(844);class c{constructor(f){this.line=f,this.isDisposed=!1,this._disposables=[],this._id=c._nextId++,this._onDispose=this.register(new _.EventEmitter),this.onDispose=this._onDispose.event}get id(){return this._id}dispose(){this.isDisposed||(this.isDisposed=!0,this.line=-1,this._onDispose.fire(),(0,v.disposeArray)(this._disposables),this._disposables.length=0)}register(f){return this._disposables.push(f),f}}i.Marker=c,c._nextId=1},7116:(A,i)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.DEFAULT_CHARSET=i.CHARSETS=void 0,i.CHARSETS={},i.DEFAULT_CHARSET=i.CHARSETS.B,i.CHARSETS[0]={"`":"â",a:"â",b:"â",c:"â",d:"â",e:"â",f:"Â°",g:"Â±",h:"â¤",i:"â",j:"â",k:"â",l:"â",m:"â",n:"â¼",o:"âº",p:"â»",q:"â",r:"â¼",s:"â½",t:"â",u:"â¤",v:"â´",w:"â¬",x:"â",y:"â¤",z:"â¥","{":"Ï","|":"â ","}":"Â£","~":"Â·"},i.CHARSETS.A={"#":"Â£"},i.CHARSETS.B=void 0,i.CHARSETS[4]={"#":"Â£","@":"Â¾","[":"ij","\\":"Â½","]":"|","{":"Â¨","|":"f","}":"Â¼","~":"Â´"},i.CHARSETS.C=i.CHARSETS[5]={"[":"Ã","\\":"Ã","]":"Ã","^":"Ã","`":"Ã©","{":"Ã¤","|":"Ã¶","}":"Ã¥","~":"Ã¼"},i.CHARSETS.R={"#":"Â£","@":"Ã ","[":"Â°","\\":"Ã§","]":"Â§","{":"Ã©","|":"Ã¹","}":"Ã¨","~":"Â¨"},i.CHARSETS.Q={"@":"Ã ","[":"Ã¢","\\":"Ã§","]":"Ãª","^":"Ã®","`":"Ã´","{":"Ã©","|":"Ã¹","}":"Ã¨","~":"Ã»"},i.CHARSETS.K={"@":"Â§","[":"Ã","\\":"Ã","]":"Ã","{":"Ã¤","|":"Ã¶","}":"Ã¼","~":"Ã"},i.CHARSETS.Y={"#":"Â£","@":"Â§","[":"Â°","\\":"Ã§","]":"Ã©","`":"Ã¹","{":"Ã ","|":"Ã²","}":"Ã¨","~":"Ã¬"},i.CHARSETS.E=i.CHARSETS[6]={"@":"Ã","[":"Ã","\\":"Ã","]":"Ã","^":"Ã","`":"Ã¤","{":"Ã¦","|":"Ã¸","}":"Ã¥","~":"Ã¼"},i.CHARSETS.Z={"#":"Â£","@":"Â§","[":"Â¡","\\":"Ã","]":"Â¿","{":"Â°","|":"Ã±","}":"Ã§"},i.CHARSETS.H=i.CHARSETS[7]={"@":"Ã","[":"Ã","\\":"Ã","]":"Ã","^":"Ã","`":"Ã©","{":"Ã¤","|":"Ã¶","}":"Ã¥","~":"Ã¼"},i.CHARSETS["="]={"#":"Ã¹","@":"Ã ","[":"Ã©","\\":"Ã§","]":"Ãª","^":"Ã®",_:"Ã¨","`":"Ã´","{":"Ã¤","|":"Ã¶","}":"Ã¼","~":"Ã»"}},2584:(A,i)=>{var l,_;Object.defineProperty(i,"__esModule",{value:!0}),i.C1_ESCAPED=i.C1=i.C0=void 0,function(v){v.NUL="\0",v.SOH="",v.STX="",v.ETX="",v.EOT="",v.ENQ="",v.ACK="",v.BEL="\x07",v.BS="\b",v.HT="	",v.LF=`
`,v.VT="\v",v.FF="\f",v.CR="\r",v.SO="",v.SI="",v.DLE="",v.DC1="",v.DC2="",v.DC3="",v.DC4="",v.NAK="",v.SYN="",v.ETB="",v.CAN="",v.EM="",v.SUB="",v.ESC="\x1B",v.FS="",v.GS="",v.RS="",v.US="",v.SP=" ",v.DEL=""}(l=i.C0||(i.C0={})),(_=i.C1||(i.C1={})).PAD="Â",_.HOP="Â",_.BPH="Â",_.NBH="Â",_.IND="Â",_.NEL="Â",_.SSA="Â",_.ESA="Â",_.HTS="Â",_.HTJ="Â",_.VTS="Â",_.PLD="Â",_.PLU="Â",_.RI="Â",_.SS2="Â",_.SS3="Â",_.DCS="Â",_.PU1="Â",_.PU2="Â",_.STS="Â",_.CCH="Â",_.MW="Â",_.SPA="Â",_.EPA="Â",_.SOS="Â",_.SGCI="Â",_.SCI="Â",_.CSI="Â",_.ST="Â",_.OSC="Â",_.PM="Â",_.APC="Â",(i.C1_ESCAPED||(i.C1_ESCAPED={})).ST=`${l.ESC}\\`},7399:(A,i,l)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.evaluateKeyboardEvent=void 0;const _=l(2584),v={48:["0",")"],49:["1","!"],50:["2","@"],51:["3","#"],52:["4","$"],53:["5","%"],54:["6","^"],55:["7","&"],56:["8","*"],57:["9","("],186:[";",":"],187:["=","+"],188:[",","<"],189:["-","_"],190:[".",">"],191:["/","?"],192:["`","~"],219:["[","{"],220:["\\","|"],221:["]","}"],222:["'",'"']};i.evaluateKeyboardEvent=function(c,n,f,d){const a={type:0,cancel:!1,key:void 0},e=(c.shiftKey?1:0)|(c.altKey?2:0)|(c.ctrlKey?4:0)|(c.metaKey?8:0);switch(c.keyCode){case 0:c.key==="UIKeyInputUpArrow"?a.key=n?_.C0.ESC+"OA":_.C0.ESC+"[A":c.key==="UIKeyInputLeftArrow"?a.key=n?_.C0.ESC+"OD":_.C0.ESC+"[D":c.key==="UIKeyInputRightArrow"?a.key=n?_.C0.ESC+"OC":_.C0.ESC+"[C":c.key==="UIKeyInputDownArrow"&&(a.key=n?_.C0.ESC+"OB":_.C0.ESC+"[B");break;case 8:if(c.altKey){a.key=_.C0.ESC+_.C0.DEL;break}a.key=_.C0.DEL;break;case 9:if(c.shiftKey){a.key=_.C0.ESC+"[Z";break}a.key=_.C0.HT,a.cancel=!0;break;case 13:a.key=c.altKey?_.C0.ESC+_.C0.CR:_.C0.CR,a.cancel=!0;break;case 27:a.key=_.C0.ESC,c.altKey&&(a.key=_.C0.ESC+_.C0.ESC),a.cancel=!0;break;case 37:if(c.metaKey)break;e?(a.key=_.C0.ESC+"[1;"+(e+1)+"D",a.key===_.C0.ESC+"[1;3D"&&(a.key=_.C0.ESC+(f?"b":"[1;5D"))):a.key=n?_.C0.ESC+"OD":_.C0.ESC+"[D";break;case 39:if(c.metaKey)break;e?(a.key=_.C0.ESC+"[1;"+(e+1)+"C",a.key===_.C0.ESC+"[1;3C"&&(a.key=_.C0.ESC+(f?"f":"[1;5C"))):a.key=n?_.C0.ESC+"OC":_.C0.ESC+"[C";break;case 38:if(c.metaKey)break;e?(a.key=_.C0.ESC+"[1;"+(e+1)+"A",f||a.key!==_.C0.ESC+"[1;3A"||(a.key=_.C0.ESC+"[1;5A")):a.key=n?_.C0.ESC+"OA":_.C0.ESC+"[A";break;case 40:if(c.metaKey)break;e?(a.key=_.C0.ESC+"[1;"+(e+1)+"B",f||a.key!==_.C0.ESC+"[1;3B"||(a.key=_.C0.ESC+"[1;5B")):a.key=n?_.C0.ESC+"OB":_.C0.ESC+"[B";break;case 45:c.shiftKey||c.ctrlKey||(a.key=_.C0.ESC+"[2~");break;case 46:a.key=e?_.C0.ESC+"[3;"+(e+1)+"~":_.C0.ESC+"[3~";break;case 36:a.key=e?_.C0.ESC+"[1;"+(e+1)+"H":n?_.C0.ESC+"OH":_.C0.ESC+"[H";break;case 35:a.key=e?_.C0.ESC+"[1;"+(e+1)+"F":n?_.C0.ESC+"OF":_.C0.ESC+"[F";break;case 33:c.shiftKey?a.type=2:c.ctrlKey?a.key=_.C0.ESC+"[5;"+(e+1)+"~":a.key=_.C0.ESC+"[5~";break;case 34:c.shiftKey?a.type=3:c.ctrlKey?a.key=_.C0.ESC+"[6;"+(e+1)+"~":a.key=_.C0.ESC+"[6~";break;case 112:a.key=e?_.C0.ESC+"[1;"+(e+1)+"P":_.C0.ESC+"OP";break;case 113:a.key=e?_.C0.ESC+"[1;"+(e+1)+"Q":_.C0.ESC+"OQ";break;case 114:a.key=e?_.C0.ESC+"[1;"+(e+1)+"R":_.C0.ESC+"OR";break;case 115:a.key=e?_.C0.ESC+"[1;"+(e+1)+"S":_.C0.ESC+"OS";break;case 116:a.key=e?_.C0.ESC+"[15;"+(e+1)+"~":_.C0.ESC+"[15~";break;case 117:a.key=e?_.C0.ESC+"[17;"+(e+1)+"~":_.C0.ESC+"[17~";break;case 118:a.key=e?_.C0.ESC+"[18;"+(e+1)+"~":_.C0.ESC+"[18~";break;case 119:a.key=e?_.C0.ESC+"[19;"+(e+1)+"~":_.C0.ESC+"[19~";break;case 120:a.key=e?_.C0.ESC+"[20;"+(e+1)+"~":_.C0.ESC+"[20~";break;case 121:a.key=e?_.C0.ESC+"[21;"+(e+1)+"~":_.C0.ESC+"[21~";break;case 122:a.key=e?_.C0.ESC+"[23;"+(e+1)+"~":_.C0.ESC+"[23~";break;case 123:a.key=e?_.C0.ESC+"[24;"+(e+1)+"~":_.C0.ESC+"[24~";break;default:if(!c.ctrlKey||c.shiftKey||c.altKey||c.metaKey)if(f&&!d||!c.altKey||c.metaKey)!f||c.altKey||c.ctrlKey||c.shiftKey||!c.metaKey?c.key&&!c.ctrlKey&&!c.altKey&&!c.metaKey&&c.keyCode>=48&&c.key.length===1?a.key=c.key:c.key&&c.ctrlKey&&(c.key==="_"&&(a.key=_.C0.US),c.key==="@"&&(a.key=_.C0.NUL)):c.keyCode===65&&(a.type=1);else{const s=v[c.keyCode],r=s==null?void 0:s[c.shiftKey?1:0];if(r)a.key=_.C0.ESC+r;else if(c.keyCode>=65&&c.keyCode<=90){const t=c.ctrlKey?c.keyCode-64:c.keyCode+32;let o=String.fromCharCode(t);c.shiftKey&&(o=o.toUpperCase()),a.key=_.C0.ESC+o}else if(c.keyCode===32)a.key=_.C0.ESC+(c.ctrlKey?_.C0.NUL:" ");else if(c.key==="Dead"&&c.code.startsWith("Key")){let t=c.code.slice(3,4);c.shiftKey||(t=t.toLowerCase()),a.key=_.C0.ESC+t,a.cancel=!0}}else c.keyCode>=65&&c.keyCode<=90?a.key=String.fromCharCode(c.keyCode-64):c.keyCode===32?a.key=_.C0.NUL:c.keyCode>=51&&c.keyCode<=55?a.key=String.fromCharCode(c.keyCode-51+27):c.keyCode===56?a.key=_.C0.DEL:c.keyCode===219?a.key=_.C0.ESC:c.keyCode===220?a.key=_.C0.FS:c.keyCode===221&&(a.key=_.C0.GS)}return a}},482:(A,i)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.Utf8ToUtf32=i.StringToUtf32=i.utf32ToString=i.stringFromCodePoint=void 0,i.stringFromCodePoint=function(l){return l>65535?(l-=65536,String.fromCharCode(55296+(l>>10))+String.fromCharCode(l%1024+56320)):String.fromCharCode(l)},i.utf32ToString=function(l,_=0,v=l.length){let c="";for(let n=_;n<v;++n){let f=l[n];f>65535?(f-=65536,c+=String.fromCharCode(55296+(f>>10))+String.fromCharCode(f%1024+56320)):c+=String.fromCharCode(f)}return c},i.StringToUtf32=class{constructor(){this._interim=0}clear(){this._interim=0}decode(l,_){const v=l.length;if(!v)return 0;let c=0,n=0;if(this._interim){const f=l.charCodeAt(n++);56320<=f&&f<=57343?_[c++]=1024*(this._interim-55296)+f-56320+65536:(_[c++]=this._interim,_[c++]=f),this._interim=0}for(let f=n;f<v;++f){const d=l.charCodeAt(f);if(55296<=d&&d<=56319){if(++f>=v)return this._interim=d,c;const a=l.charCodeAt(f);56320<=a&&a<=57343?_[c++]=1024*(d-55296)+a-56320+65536:(_[c++]=d,_[c++]=a)}else d!==65279&&(_[c++]=d)}return c}},i.Utf8ToUtf32=class{constructor(){this.interim=new Uint8Array(3)}clear(){this.interim.fill(0)}decode(l,_){const v=l.length;if(!v)return 0;let c,n,f,d,a=0,e=0,s=0;if(this.interim[0]){let o=!1,u=this.interim[0];u&=(224&u)==192?31:(240&u)==224?15:7;let g,m=0;for(;(g=63&this.interim[++m])&&m<4;)u<<=6,u|=g;const h=(224&this.interim[0])==192?2:(240&this.interim[0])==224?3:4,p=h-m;for(;s<p;){if(s>=v)return 0;if(g=l[s++],(192&g)!=128){s--,o=!0;break}this.interim[m++]=g,u<<=6,u|=63&g}o||(h===2?u<128?s--:_[a++]=u:h===3?u<2048||u>=55296&&u<=57343||u===65279||(_[a++]=u):u<65536||u>1114111||(_[a++]=u)),this.interim.fill(0)}const r=v-4;let t=s;for(;t<v;){for(;!(!(t<r)||128&(c=l[t])||128&(n=l[t+1])||128&(f=l[t+2])||128&(d=l[t+3]));)_[a++]=c,_[a++]=n,_[a++]=f,_[a++]=d,t+=4;if(c=l[t++],c<128)_[a++]=c;else if((224&c)==192){if(t>=v)return this.interim[0]=c,a;if(n=l[t++],(192&n)!=128){t--;continue}if(e=(31&c)<<6|63&n,e<128){t--;continue}_[a++]=e}else if((240&c)==224){if(t>=v)return this.interim[0]=c,a;if(n=l[t++],(192&n)!=128){t--;continue}if(t>=v)return this.interim[0]=c,this.interim[1]=n,a;if(f=l[t++],(192&f)!=128){t--;continue}if(e=(15&c)<<12|(63&n)<<6|63&f,e<2048||e>=55296&&e<=57343||e===65279)continue;_[a++]=e}else if((248&c)==240){if(t>=v)return this.interim[0]=c,a;if(n=l[t++],(192&n)!=128){t--;continue}if(t>=v)return this.interim[0]=c,this.interim[1]=n,a;if(f=l[t++],(192&f)!=128){t--;continue}if(t>=v)return this.interim[0]=c,this.interim[1]=n,this.interim[2]=f,a;if(d=l[t++],(192&d)!=128){t--;continue}if(e=(7&c)<<18|(63&n)<<12|(63&f)<<6|63&d,e<65536||e>1114111)continue;_[a++]=e}}return a}}},225:(A,i)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.UnicodeV6=void 0;const l=[[768,879],[1155,1158],[1160,1161],[1425,1469],[1471,1471],[1473,1474],[1476,1477],[1479,1479],[1536,1539],[1552,1557],[1611,1630],[1648,1648],[1750,1764],[1767,1768],[1770,1773],[1807,1807],[1809,1809],[1840,1866],[1958,1968],[2027,2035],[2305,2306],[2364,2364],[2369,2376],[2381,2381],[2385,2388],[2402,2403],[2433,2433],[2492,2492],[2497,2500],[2509,2509],[2530,2531],[2561,2562],[2620,2620],[2625,2626],[2631,2632],[2635,2637],[2672,2673],[2689,2690],[2748,2748],[2753,2757],[2759,2760],[2765,2765],[2786,2787],[2817,2817],[2876,2876],[2879,2879],[2881,2883],[2893,2893],[2902,2902],[2946,2946],[3008,3008],[3021,3021],[3134,3136],[3142,3144],[3146,3149],[3157,3158],[3260,3260],[3263,3263],[3270,3270],[3276,3277],[3298,3299],[3393,3395],[3405,3405],[3530,3530],[3538,3540],[3542,3542],[3633,3633],[3636,3642],[3655,3662],[3761,3761],[3764,3769],[3771,3772],[3784,3789],[3864,3865],[3893,3893],[3895,3895],[3897,3897],[3953,3966],[3968,3972],[3974,3975],[3984,3991],[3993,4028],[4038,4038],[4141,4144],[4146,4146],[4150,4151],[4153,4153],[4184,4185],[4448,4607],[4959,4959],[5906,5908],[5938,5940],[5970,5971],[6002,6003],[6068,6069],[6071,6077],[6086,6086],[6089,6099],[6109,6109],[6155,6157],[6313,6313],[6432,6434],[6439,6440],[6450,6450],[6457,6459],[6679,6680],[6912,6915],[6964,6964],[6966,6970],[6972,6972],[6978,6978],[7019,7027],[7616,7626],[7678,7679],[8203,8207],[8234,8238],[8288,8291],[8298,8303],[8400,8431],[12330,12335],[12441,12442],[43014,43014],[43019,43019],[43045,43046],[64286,64286],[65024,65039],[65056,65059],[65279,65279],[65529,65531]],_=[[68097,68099],[68101,68102],[68108,68111],[68152,68154],[68159,68159],[119143,119145],[119155,119170],[119173,119179],[119210,119213],[119362,119364],[917505,917505],[917536,917631],[917760,917999]];let v;i.UnicodeV6=class{constructor(){if(this.version="6",!v){v=new Uint8Array(65536),v.fill(1),v[0]=0,v.fill(0,1,32),v.fill(0,127,160),v.fill(2,4352,4448),v[9001]=2,v[9002]=2,v.fill(2,11904,42192),v[12351]=1,v.fill(2,44032,55204),v.fill(2,63744,64256),v.fill(2,65040,65050),v.fill(2,65072,65136),v.fill(2,65280,65377),v.fill(2,65504,65511);for(let c=0;c<l.length;++c)v.fill(0,l[c][0],l[c][1]+1)}}wcwidth(c){return c<32?0:c<127?1:c<65536?v[c]:function(n,f){let d,a=0,e=f.length-1;if(n<f[0][0]||n>f[e][1])return!1;for(;e>=a;)if(d=a+e>>1,n>f[d][1])a=d+1;else{if(!(n<f[d][0]))return!0;e=d-1}return!1}(c,_)?0:c>=131072&&c<=196605||c>=196608&&c<=262141?2:1}}},5981:(A,i,l)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.WriteBuffer=void 0;const _=l(8460),v=l(844);class c extends v.Disposable{constructor(f){super(),this._action=f,this._writeBuffer=[],this._callbacks=[],this._pendingData=0,this._bufferOffset=0,this._isSyncWriting=!1,this._syncCalls=0,this._didUserInput=!1,this._onWriteParsed=this.register(new _.EventEmitter),this.onWriteParsed=this._onWriteParsed.event}handleUserInput(){this._didUserInput=!0}writeSync(f,d){if(d!==void 0&&this._syncCalls>d)return void(this._syncCalls=0);if(this._pendingData+=f.length,this._writeBuffer.push(f),this._callbacks.push(void 0),this._syncCalls++,this._isSyncWriting)return;let a;for(this._isSyncWriting=!0;a=this._writeBuffer.shift();){this._action(a);const e=this._callbacks.shift();e&&e()}this._pendingData=0,this._bufferOffset=2147483647,this._isSyncWriting=!1,this._syncCalls=0}write(f,d){if(this._pendingData>5e7)throw new Error("write data discarded, use flow control to avoid losing data");if(!this._writeBuffer.length){if(this._bufferOffset=0,this._didUserInput)return this._didUserInput=!1,this._pendingData+=f.length,this._writeBuffer.push(f),this._callbacks.push(d),void this._innerWrite();setTimeout(()=>this._innerWrite())}this._pendingData+=f.length,this._writeBuffer.push(f),this._callbacks.push(d)}_innerWrite(f=0,d=!0){const a=f||Date.now();for(;this._writeBuffer.length>this._bufferOffset;){const e=this._writeBuffer[this._bufferOffset],s=this._action(e,d);if(s){const t=o=>Date.now()-a>=12?setTimeout(()=>this._innerWrite(0,o)):this._innerWrite(a,o);return void s.catch(o=>(queueMicrotask(()=>{throw o}),Promise.resolve(!1))).then(t)}const r=this._callbacks[this._bufferOffset];if(r&&r(),this._bufferOffset++,this._pendingData-=e.length,Date.now()-a>=12)break}this._writeBuffer.length>this._bufferOffset?(this._bufferOffset>50&&(this._writeBuffer=this._writeBuffer.slice(this._bufferOffset),this._callbacks=this._callbacks.slice(this._bufferOffset),this._bufferOffset=0),setTimeout(()=>this._innerWrite())):(this._writeBuffer.length=0,this._callbacks.length=0,this._pendingData=0,this._bufferOffset=0),this._onWriteParsed.fire()}}i.WriteBuffer=c},5941:(A,i)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.toRgbString=i.parseColor=void 0;const l=/^([\da-f])\/([\da-f])\/([\da-f])$|^([\da-f]{2})\/([\da-f]{2})\/([\da-f]{2})$|^([\da-f]{3})\/([\da-f]{3})\/([\da-f]{3})$|^([\da-f]{4})\/([\da-f]{4})\/([\da-f]{4})$/,_=/^[\da-f]+$/;function v(c,n){const f=c.toString(16),d=f.length<2?"0"+f:f;switch(n){case 4:return f[0];case 8:return d;case 12:return(d+d).slice(0,3);default:return d+d}}i.parseColor=function(c){if(!c)return;let n=c.toLowerCase();if(n.indexOf("rgb:")===0){n=n.slice(4);const f=l.exec(n);if(f){const d=f[1]?15:f[4]?255:f[7]?4095:65535;return[Math.round(parseInt(f[1]||f[4]||f[7]||f[10],16)/d*255),Math.round(parseInt(f[2]||f[5]||f[8]||f[11],16)/d*255),Math.round(parseInt(f[3]||f[6]||f[9]||f[12],16)/d*255)]}}else if(n.indexOf("#")===0&&(n=n.slice(1),_.exec(n)&&[3,6,9,12].includes(n.length))){const f=n.length/3,d=[0,0,0];for(let a=0;a<3;++a){const e=parseInt(n.slice(f*a,f*a+f),16);d[a]=f===1?e<<4:f===2?e:f===3?e>>4:e>>8}return d}},i.toRgbString=function(c,n=16){const[f,d,a]=c;return`rgb:${v(f,n)}/${v(d,n)}/${v(a,n)}`}},5770:(A,i)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.PAYLOAD_LIMIT=void 0,i.PAYLOAD_LIMIT=1e7},6351:(A,i,l)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.DcsHandler=i.DcsParser=void 0;const _=l(482),v=l(8742),c=l(5770),n=[];i.DcsParser=class{constructor(){this._handlers=Object.create(null),this._active=n,this._ident=0,this._handlerFb=()=>{},this._stack={paused:!1,loopPosition:0,fallThrough:!1}}dispose(){this._handlers=Object.create(null),this._handlerFb=()=>{},this._active=n}registerHandler(d,a){this._handlers[d]===void 0&&(this._handlers[d]=[]);const e=this._handlers[d];return e.push(a),{dispose:()=>{const s=e.indexOf(a);s!==-1&&e.splice(s,1)}}}clearHandler(d){this._handlers[d]&&delete this._handlers[d]}setHandlerFallback(d){this._handlerFb=d}reset(){if(this._active.length)for(let d=this._stack.paused?this._stack.loopPosition-1:this._active.length-1;d>=0;--d)this._active[d].unhook(!1);this._stack.paused=!1,this._active=n,this._ident=0}hook(d,a){if(this.reset(),this._ident=d,this._active=this._handlers[d]||n,this._active.length)for(let e=this._active.length-1;e>=0;e--)this._active[e].hook(a);else this._handlerFb(this._ident,"HOOK",a)}put(d,a,e){if(this._active.length)for(let s=this._active.length-1;s>=0;s--)this._active[s].put(d,a,e);else this._handlerFb(this._ident,"PUT",(0,_.utf32ToString)(d,a,e))}unhook(d,a=!0){if(this._active.length){let e=!1,s=this._active.length-1,r=!1;if(this._stack.paused&&(s=this._stack.loopPosition-1,e=a,r=this._stack.fallThrough,this._stack.paused=!1),!r&&e===!1){for(;s>=0&&(e=this._active[s].unhook(d),e!==!0);s--)if(e instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=s,this._stack.fallThrough=!1,e;s--}for(;s>=0;s--)if(e=this._active[s].unhook(!1),e instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=s,this._stack.fallThrough=!0,e}else this._handlerFb(this._ident,"UNHOOK",d);this._active=n,this._ident=0}};const f=new v.Params;f.addParam(0),i.DcsHandler=class{constructor(d){this._handler=d,this._data="",this._params=f,this._hitLimit=!1}hook(d){this._params=d.length>1||d.params[0]?d.clone():f,this._data="",this._hitLimit=!1}put(d,a,e){this._hitLimit||(this._data+=(0,_.utf32ToString)(d,a,e),this._data.length>c.PAYLOAD_LIMIT&&(this._data="",this._hitLimit=!0))}unhook(d){let a=!1;if(this._hitLimit)a=!1;else if(d&&(a=this._handler(this._data,this._params),a instanceof Promise))return a.then(e=>(this._params=f,this._data="",this._hitLimit=!1,e));return this._params=f,this._data="",this._hitLimit=!1,a}}},2015:(A,i,l)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.EscapeSequenceParser=i.VT500_TRANSITION_TABLE=i.TransitionTable=void 0;const _=l(844),v=l(8742),c=l(6242),n=l(6351);class f{constructor(s){this.table=new Uint8Array(s)}setDefault(s,r){this.table.fill(s<<4|r)}add(s,r,t,o){this.table[r<<8|s]=t<<4|o}addMany(s,r,t,o){for(let u=0;u<s.length;u++)this.table[r<<8|s[u]]=t<<4|o}}i.TransitionTable=f;const d=160;i.VT500_TRANSITION_TABLE=function(){const e=new f(4095),s=Array.apply(null,Array(256)).map((m,h)=>h),r=(m,h)=>s.slice(m,h),t=r(32,127),o=r(0,24);o.push(25),o.push.apply(o,r(28,32));const u=r(0,14);let g;for(g in e.setDefault(1,0),e.addMany(t,0,2,0),u)e.addMany([24,26,153,154],g,3,0),e.addMany(r(128,144),g,3,0),e.addMany(r(144,152),g,3,0),e.add(156,g,0,0),e.add(27,g,11,1),e.add(157,g,4,8),e.addMany([152,158,159],g,0,7),e.add(155,g,11,3),e.add(144,g,11,9);return e.addMany(o,0,3,0),e.addMany(o,1,3,1),e.add(127,1,0,1),e.addMany(o,8,0,8),e.addMany(o,3,3,3),e.add(127,3,0,3),e.addMany(o,4,3,4),e.add(127,4,0,4),e.addMany(o,6,3,6),e.addMany(o,5,3,5),e.add(127,5,0,5),e.addMany(o,2,3,2),e.add(127,2,0,2),e.add(93,1,4,8),e.addMany(t,8,5,8),e.add(127,8,5,8),e.addMany([156,27,24,26,7],8,6,0),e.addMany(r(28,32),8,0,8),e.addMany([88,94,95],1,0,7),e.addMany(t,7,0,7),e.addMany(o,7,0,7),e.add(156,7,0,0),e.add(127,7,0,7),e.add(91,1,11,3),e.addMany(r(64,127),3,7,0),e.addMany(r(48,60),3,8,4),e.addMany([60,61,62,63],3,9,4),e.addMany(r(48,60),4,8,4),e.addMany(r(64,127),4,7,0),e.addMany([60,61,62,63],4,0,6),e.addMany(r(32,64),6,0,6),e.add(127,6,0,6),e.addMany(r(64,127),6,0,0),e.addMany(r(32,48),3,9,5),e.addMany(r(32,48),5,9,5),e.addMany(r(48,64),5,0,6),e.addMany(r(64,127),5,7,0),e.addMany(r(32,48),4,9,5),e.addMany(r(32,48),1,9,2),e.addMany(r(32,48),2,9,2),e.addMany(r(48,127),2,10,0),e.addMany(r(48,80),1,10,0),e.addMany(r(81,88),1,10,0),e.addMany([89,90,92],1,10,0),e.addMany(r(96,127),1,10,0),e.add(80,1,11,9),e.addMany(o,9,0,9),e.add(127,9,0,9),e.addMany(r(28,32),9,0,9),e.addMany(r(32,48),9,9,12),e.addMany(r(48,60),9,8,10),e.addMany([60,61,62,63],9,9,10),e.addMany(o,11,0,11),e.addMany(r(32,128),11,0,11),e.addMany(r(28,32),11,0,11),e.addMany(o,10,0,10),e.add(127,10,0,10),e.addMany(r(28,32),10,0,10),e.addMany(r(48,60),10,8,10),e.addMany([60,61,62,63],10,0,11),e.addMany(r(32,48),10,9,12),e.addMany(o,12,0,12),e.add(127,12,0,12),e.addMany(r(28,32),12,0,12),e.addMany(r(32,48),12,9,12),e.addMany(r(48,64),12,0,11),e.addMany(r(64,127),12,12,13),e.addMany(r(64,127),10,12,13),e.addMany(r(64,127),9,12,13),e.addMany(o,13,13,13),e.addMany(t,13,13,13),e.add(127,13,0,13),e.addMany([27,156,24,26],13,14,0),e.add(d,0,2,0),e.add(d,8,5,8),e.add(d,6,0,6),e.add(d,11,0,11),e.add(d,13,13,13),e}();class a extends _.Disposable{constructor(s=i.VT500_TRANSITION_TABLE){super(),this._transitions=s,this._parseStack={state:0,handlers:[],handlerPos:0,transition:0,chunkPos:0},this.initialState=0,this.currentState=this.initialState,this._params=new v.Params,this._params.addParam(0),this._collect=0,this.precedingCodepoint=0,this._printHandlerFb=(r,t,o)=>{},this._executeHandlerFb=r=>{},this._csiHandlerFb=(r,t)=>{},this._escHandlerFb=r=>{},this._errorHandlerFb=r=>r,this._printHandler=this._printHandlerFb,this._executeHandlers=Object.create(null),this._csiHandlers=Object.create(null),this._escHandlers=Object.create(null),this.register((0,_.toDisposable)(()=>{this._csiHandlers=Object.create(null),this._executeHandlers=Object.create(null),this._escHandlers=Object.create(null)})),this._oscParser=this.register(new c.OscParser),this._dcsParser=this.register(new n.DcsParser),this._errorHandler=this._errorHandlerFb,this.registerEscHandler({final:"\\"},()=>!0)}_identifier(s,r=[64,126]){let t=0;if(s.prefix){if(s.prefix.length>1)throw new Error("only one byte as prefix supported");if(t=s.prefix.charCodeAt(0),t&&60>t||t>63)throw new Error("prefix must be in range 0x3c .. 0x3f")}if(s.intermediates){if(s.intermediates.length>2)throw new Error("only two bytes as intermediates are supported");for(let u=0;u<s.intermediates.length;++u){const g=s.intermediates.charCodeAt(u);if(32>g||g>47)throw new Error("intermediate must be in range 0x20 .. 0x2f");t<<=8,t|=g}}if(s.final.length!==1)throw new Error("final must be a single byte");const o=s.final.charCodeAt(0);if(r[0]>o||o>r[1])throw new Error(`final must be in range ${r[0]} .. ${r[1]}`);return t<<=8,t|=o,t}identToString(s){const r=[];for(;s;)r.push(String.fromCharCode(255&s)),s>>=8;return r.reverse().join("")}setPrintHandler(s){this._printHandler=s}clearPrintHandler(){this._printHandler=this._printHandlerFb}registerEscHandler(s,r){const t=this._identifier(s,[48,126]);this._escHandlers[t]===void 0&&(this._escHandlers[t]=[]);const o=this._escHandlers[t];return o.push(r),{dispose:()=>{const u=o.indexOf(r);u!==-1&&o.splice(u,1)}}}clearEscHandler(s){this._escHandlers[this._identifier(s,[48,126])]&&delete this._escHandlers[this._identifier(s,[48,126])]}setEscHandlerFallback(s){this._escHandlerFb=s}setExecuteHandler(s,r){this._executeHandlers[s.charCodeAt(0)]=r}clearExecuteHandler(s){this._executeHandlers[s.charCodeAt(0)]&&delete this._executeHandlers[s.charCodeAt(0)]}setExecuteHandlerFallback(s){this._executeHandlerFb=s}registerCsiHandler(s,r){const t=this._identifier(s);this._csiHandlers[t]===void 0&&(this._csiHandlers[t]=[]);const o=this._csiHandlers[t];return o.push(r),{dispose:()=>{const u=o.indexOf(r);u!==-1&&o.splice(u,1)}}}clearCsiHandler(s){this._csiHandlers[this._identifier(s)]&&delete this._csiHandlers[this._identifier(s)]}setCsiHandlerFallback(s){this._csiHandlerFb=s}registerDcsHandler(s,r){return this._dcsParser.registerHandler(this._identifier(s),r)}clearDcsHandler(s){this._dcsParser.clearHandler(this._identifier(s))}setDcsHandlerFallback(s){this._dcsParser.setHandlerFallback(s)}registerOscHandler(s,r){return this._oscParser.registerHandler(s,r)}clearOscHandler(s){this._oscParser.clearHandler(s)}setOscHandlerFallback(s){this._oscParser.setHandlerFallback(s)}setErrorHandler(s){this._errorHandler=s}clearErrorHandler(){this._errorHandler=this._errorHandlerFb}reset(){this.currentState=this.initialState,this._oscParser.reset(),this._dcsParser.reset(),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingCodepoint=0,this._parseStack.state!==0&&(this._parseStack.state=2,this._parseStack.handlers=[])}_preserveStack(s,r,t,o,u){this._parseStack.state=s,this._parseStack.handlers=r,this._parseStack.handlerPos=t,this._parseStack.transition=o,this._parseStack.chunkPos=u}parse(s,r,t){let o,u=0,g=0,m=0;if(this._parseStack.state)if(this._parseStack.state===2)this._parseStack.state=0,m=this._parseStack.chunkPos+1;else{if(t===void 0||this._parseStack.state===1)throw this._parseStack.state=1,new Error("improper continuation due to previous async handler, giving up parsing");const h=this._parseStack.handlers;let p=this._parseStack.handlerPos-1;switch(this._parseStack.state){case 3:if(t===!1&&p>-1){for(;p>=0&&(o=h[p](this._params),o!==!0);p--)if(o instanceof Promise)return this._parseStack.handlerPos=p,o}this._parseStack.handlers=[];break;case 4:if(t===!1&&p>-1){for(;p>=0&&(o=h[p](),o!==!0);p--)if(o instanceof Promise)return this._parseStack.handlerPos=p,o}this._parseStack.handlers=[];break;case 6:if(u=s[this._parseStack.chunkPos],o=this._dcsParser.unhook(u!==24&&u!==26,t),o)return o;u===27&&(this._parseStack.transition|=1),this._params.reset(),this._params.addParam(0),this._collect=0;break;case 5:if(u=s[this._parseStack.chunkPos],o=this._oscParser.end(u!==24&&u!==26,t),o)return o;u===27&&(this._parseStack.transition|=1),this._params.reset(),this._params.addParam(0),this._collect=0}this._parseStack.state=0,m=this._parseStack.chunkPos+1,this.precedingCodepoint=0,this.currentState=15&this._parseStack.transition}for(let h=m;h<r;++h){switch(u=s[h],g=this._transitions.table[this.currentState<<8|(u<160?u:d)],g>>4){case 2:for(let D=h+1;;++D){if(D>=r||(u=s[D])<32||u>126&&u<d){this._printHandler(s,h,D),h=D-1;break}if(++D>=r||(u=s[D])<32||u>126&&u<d){this._printHandler(s,h,D),h=D-1;break}if(++D>=r||(u=s[D])<32||u>126&&u<d){this._printHandler(s,h,D),h=D-1;break}if(++D>=r||(u=s[D])<32||u>126&&u<d){this._printHandler(s,h,D),h=D-1;break}}break;case 3:this._executeHandlers[u]?this._executeHandlers[u]():this._executeHandlerFb(u),this.precedingCodepoint=0;break;case 0:break;case 1:if(this._errorHandler({position:h,code:u,currentState:this.currentState,collect:this._collect,params:this._params,abort:!1}).abort)return;break;case 7:const p=this._csiHandlers[this._collect<<8|u];let C=p?p.length-1:-1;for(;C>=0&&(o=p[C](this._params),o!==!0);C--)if(o instanceof Promise)return this._preserveStack(3,p,C,g,h),o;C<0&&this._csiHandlerFb(this._collect<<8|u,this._params),this.precedingCodepoint=0;break;case 8:do switch(u){case 59:this._params.addParam(0);break;case 58:this._params.addSubParam(-1);break;default:this._params.addDigit(u-48)}while(++h<r&&(u=s[h])>47&&u<60);h--;break;case 9:this._collect<<=8,this._collect|=u;break;case 10:const w=this._escHandlers[this._collect<<8|u];let y=w?w.length-1:-1;for(;y>=0&&(o=w[y](),o!==!0);y--)if(o instanceof Promise)return this._preserveStack(4,w,y,g,h),o;y<0&&this._escHandlerFb(this._collect<<8|u),this.precedingCodepoint=0;break;case 11:this._params.reset(),this._params.addParam(0),this._collect=0;break;case 12:this._dcsParser.hook(this._collect<<8|u,this._params);break;case 13:for(let D=h+1;;++D)if(D>=r||(u=s[D])===24||u===26||u===27||u>127&&u<d){this._dcsParser.put(s,h,D),h=D-1;break}break;case 14:if(o=this._dcsParser.unhook(u!==24&&u!==26),o)return this._preserveStack(6,[],0,g,h),o;u===27&&(g|=1),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingCodepoint=0;break;case 4:this._oscParser.start();break;case 5:for(let D=h+1;;D++)if(D>=r||(u=s[D])<32||u>127&&u<d){this._oscParser.put(s,h,D),h=D-1;break}break;case 6:if(o=this._oscParser.end(u!==24&&u!==26),o)return this._preserveStack(5,[],0,g,h),o;u===27&&(g|=1),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingCodepoint=0}this.currentState=15&g}}}i.EscapeSequenceParser=a},6242:(A,i,l)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.OscHandler=i.OscParser=void 0;const _=l(5770),v=l(482),c=[];i.OscParser=class{constructor(){this._state=0,this._active=c,this._id=-1,this._handlers=Object.create(null),this._handlerFb=()=>{},this._stack={paused:!1,loopPosition:0,fallThrough:!1}}registerHandler(n,f){this._handlers[n]===void 0&&(this._handlers[n]=[]);const d=this._handlers[n];return d.push(f),{dispose:()=>{const a=d.indexOf(f);a!==-1&&d.splice(a,1)}}}clearHandler(n){this._handlers[n]&&delete this._handlers[n]}setHandlerFallback(n){this._handlerFb=n}dispose(){this._handlers=Object.create(null),this._handlerFb=()=>{},this._active=c}reset(){if(this._state===2)for(let n=this._stack.paused?this._stack.loopPosition-1:this._active.length-1;n>=0;--n)this._active[n].end(!1);this._stack.paused=!1,this._active=c,this._id=-1,this._state=0}_start(){if(this._active=this._handlers[this._id]||c,this._active.length)for(let n=this._active.length-1;n>=0;n--)this._active[n].start();else this._handlerFb(this._id,"START")}_put(n,f,d){if(this._active.length)for(let a=this._active.length-1;a>=0;a--)this._active[a].put(n,f,d);else this._handlerFb(this._id,"PUT",(0,v.utf32ToString)(n,f,d))}start(){this.reset(),this._state=1}put(n,f,d){if(this._state!==3){if(this._state===1)for(;f<d;){const a=n[f++];if(a===59){this._state=2,this._start();break}if(a<48||57<a)return void(this._state=3);this._id===-1&&(this._id=0),this._id=10*this._id+a-48}this._state===2&&d-f>0&&this._put(n,f,d)}}end(n,f=!0){if(this._state!==0){if(this._state!==3)if(this._state===1&&this._start(),this._active.length){let d=!1,a=this._active.length-1,e=!1;if(this._stack.paused&&(a=this._stack.loopPosition-1,d=f,e=this._stack.fallThrough,this._stack.paused=!1),!e&&d===!1){for(;a>=0&&(d=this._active[a].end(n),d!==!0);a--)if(d instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=a,this._stack.fallThrough=!1,d;a--}for(;a>=0;a--)if(d=this._active[a].end(!1),d instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=a,this._stack.fallThrough=!0,d}else this._handlerFb(this._id,"END",n);this._active=c,this._id=-1,this._state=0}}},i.OscHandler=class{constructor(n){this._handler=n,this._data="",this._hitLimit=!1}start(){this._data="",this._hitLimit=!1}put(n,f,d){this._hitLimit||(this._data+=(0,v.utf32ToString)(n,f,d),this._data.length>_.PAYLOAD_LIMIT&&(this._data="",this._hitLimit=!0))}end(n){let f=!1;if(this._hitLimit)f=!1;else if(n&&(f=this._handler(this._data),f instanceof Promise))return f.then(d=>(this._data="",this._hitLimit=!1,d));return this._data="",this._hitLimit=!1,f}}},8742:(A,i)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.Params=void 0;const l=2147483647;class _{constructor(c=32,n=32){if(this.maxLength=c,this.maxSubParamsLength=n,n>256)throw new Error("maxSubParamsLength must not be greater than 256");this.params=new Int32Array(c),this.length=0,this._subParams=new Int32Array(n),this._subParamsLength=0,this._subParamsIdx=new Uint16Array(c),this._rejectDigits=!1,this._rejectSubDigits=!1,this._digitIsSub=!1}static fromArray(c){const n=new _;if(!c.length)return n;for(let f=Array.isArray(c[0])?1:0;f<c.length;++f){const d=c[f];if(Array.isArray(d))for(let a=0;a<d.length;++a)n.addSubParam(d[a]);else n.addParam(d)}return n}clone(){const c=new _(this.maxLength,this.maxSubParamsLength);return c.params.set(this.params),c.length=this.length,c._subParams.set(this._subParams),c._subParamsLength=this._subParamsLength,c._subParamsIdx.set(this._subParamsIdx),c._rejectDigits=this._rejectDigits,c._rejectSubDigits=this._rejectSubDigits,c._digitIsSub=this._digitIsSub,c}toArray(){const c=[];for(let n=0;n<this.length;++n){c.push(this.params[n]);const f=this._subParamsIdx[n]>>8,d=255&this._subParamsIdx[n];d-f>0&&c.push(Array.prototype.slice.call(this._subParams,f,d))}return c}reset(){this.length=0,this._subParamsLength=0,this._rejectDigits=!1,this._rejectSubDigits=!1,this._digitIsSub=!1}addParam(c){if(this._digitIsSub=!1,this.length>=this.maxLength)this._rejectDigits=!0;else{if(c<-1)throw new Error("values lesser than -1 are not allowed");this._subParamsIdx[this.length]=this._subParamsLength<<8|this._subParamsLength,this.params[this.length++]=c>l?l:c}}addSubParam(c){if(this._digitIsSub=!0,this.length)if(this._rejectDigits||this._subParamsLength>=this.maxSubParamsLength)this._rejectSubDigits=!0;else{if(c<-1)throw new Error("values lesser than -1 are not allowed");this._subParams[this._subParamsLength++]=c>l?l:c,this._subParamsIdx[this.length-1]++}}hasSubParams(c){return(255&this._subParamsIdx[c])-(this._subParamsIdx[c]>>8)>0}getSubParams(c){const n=this._subParamsIdx[c]>>8,f=255&this._subParamsIdx[c];return f-n>0?this._subParams.subarray(n,f):null}getSubParamsAll(){const c={};for(let n=0;n<this.length;++n){const f=this._subParamsIdx[n]>>8,d=255&this._subParamsIdx[n];d-f>0&&(c[n]=this._subParams.slice(f,d))}return c}addDigit(c){let n;if(this._rejectDigits||!(n=this._digitIsSub?this._subParamsLength:this.length)||this._digitIsSub&&this._rejectSubDigits)return;const f=this._digitIsSub?this._subParams:this.params,d=f[n-1];f[n-1]=~d?Math.min(10*d+c,l):c}}i.Params=_},5741:(A,i)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.AddonManager=void 0,i.AddonManager=class{constructor(){this._addons=[]}dispose(){for(let l=this._addons.length-1;l>=0;l--)this._addons[l].instance.dispose()}loadAddon(l,_){const v={instance:_,dispose:_.dispose,isDisposed:!1};this._addons.push(v),_.dispose=()=>this._wrappedAddonDispose(v),_.activate(l)}_wrappedAddonDispose(l){if(l.isDisposed)return;let _=-1;for(let v=0;v<this._addons.length;v++)if(this._addons[v]===l){_=v;break}if(_===-1)throw new Error("Could not dispose an addon that has not been loaded");l.isDisposed=!0,l.dispose.apply(l.instance),this._addons.splice(_,1)}}},8771:(A,i,l)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.BufferApiView=void 0;const _=l(3785),v=l(511);i.BufferApiView=class{constructor(c,n){this._buffer=c,this.type=n}init(c){return this._buffer=c,this}get cursorY(){return this._buffer.y}get cursorX(){return this._buffer.x}get viewportY(){return this._buffer.ydisp}get baseY(){return this._buffer.ybase}get length(){return this._buffer.lines.length}getLine(c){const n=this._buffer.lines.get(c);if(n)return new _.BufferLineApiView(n)}getNullCell(){return new v.CellData}}},3785:(A,i,l)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.BufferLineApiView=void 0;const _=l(511);i.BufferLineApiView=class{constructor(v){this._line=v}get isWrapped(){return this._line.isWrapped}get length(){return this._line.length}getCell(v,c){if(!(v<0||v>=this._line.length))return c?(this._line.loadCell(v,c),c):this._line.loadCell(v,new _.CellData)}translateToString(v,c,n){return this._line.translateToString(v,c,n)}}},8285:(A,i,l)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.BufferNamespaceApi=void 0;const _=l(8771),v=l(8460);i.BufferNamespaceApi=class{constructor(c){this._core=c,this._onBufferChange=new v.EventEmitter,this.onBufferChange=this._onBufferChange.event,this._normal=new _.BufferApiView(this._core.buffers.normal,"normal"),this._alternate=new _.BufferApiView(this._core.buffers.alt,"alternate"),this._core.buffers.onBufferActivate(()=>this._onBufferChange.fire(this.active))}get active(){if(this._core.buffers.active===this._core.buffers.normal)return this.normal;if(this._core.buffers.active===this._core.buffers.alt)return this.alternate;throw new Error("Active buffer is neither normal nor alternate")}get normal(){return this._normal.init(this._core.buffers.normal)}get alternate(){return this._alternate.init(this._core.buffers.alt)}}},7975:(A,i)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.ParserApi=void 0,i.ParserApi=class{constructor(l){this._core=l}registerCsiHandler(l,_){return this._core.registerCsiHandler(l,v=>_(v.toArray()))}addCsiHandler(l,_){return this.registerCsiHandler(l,_)}registerDcsHandler(l,_){return this._core.registerDcsHandler(l,(v,c)=>_(v,c.toArray()))}addDcsHandler(l,_){return this.registerDcsHandler(l,_)}registerEscHandler(l,_){return this._core.registerEscHandler(l,_)}addEscHandler(l,_){return this.registerEscHandler(l,_)}registerOscHandler(l,_){return this._core.registerOscHandler(l,_)}addOscHandler(l,_){return this.registerOscHandler(l,_)}}},7090:(A,i)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.UnicodeApi=void 0,i.UnicodeApi=class{constructor(l){this._core=l}register(l){this._core.unicodeService.register(l)}get versions(){return this._core.unicodeService.versions}get activeVersion(){return this._core.unicodeService.activeVersion}set activeVersion(l){this._core.unicodeService.activeVersion=l}}},744:function(A,i,l){var _=this&&this.__decorate||function(e,s,r,t){var o,u=arguments.length,g=u<3?s:t===null?t=Object.getOwnPropertyDescriptor(s,r):t;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")g=Reflect.decorate(e,s,r,t);else for(var m=e.length-1;m>=0;m--)(o=e[m])&&(g=(u<3?o(g):u>3?o(s,r,g):o(s,r))||g);return u>3&&g&&Object.defineProperty(s,r,g),g},v=this&&this.__param||function(e,s){return function(r,t){s(r,t,e)}};Object.defineProperty(i,"__esModule",{value:!0}),i.BufferService=i.MINIMUM_ROWS=i.MINIMUM_COLS=void 0;const c=l(2585),n=l(5295),f=l(8460),d=l(844);i.MINIMUM_COLS=2,i.MINIMUM_ROWS=1;let a=class extends d.Disposable{constructor(e){super(),this.isUserScrolling=!1,this._onResize=this.register(new f.EventEmitter),this.onResize=this._onResize.event,this._onScroll=this.register(new f.EventEmitter),this.onScroll=this._onScroll.event,this.cols=Math.max(e.rawOptions.cols||0,i.MINIMUM_COLS),this.rows=Math.max(e.rawOptions.rows||0,i.MINIMUM_ROWS),this.buffers=this.register(new n.BufferSet(e,this))}get buffer(){return this.buffers.active}resize(e,s){this.cols=e,this.rows=s,this.buffers.resize(e,s),this._onResize.fire({cols:e,rows:s})}reset(){this.buffers.reset(),this.isUserScrolling=!1}scroll(e,s=!1){const r=this.buffer;let t;t=this._cachedBlankLine,t&&t.length===this.cols&&t.getFg(0)===e.fg&&t.getBg(0)===e.bg||(t=r.getBlankLine(e,s),this._cachedBlankLine=t),t.isWrapped=s;const o=r.ybase+r.scrollTop,u=r.ybase+r.scrollBottom;if(r.scrollTop===0){const g=r.lines.isFull;u===r.lines.length-1?g?r.lines.recycle().copyFrom(t):r.lines.push(t.clone()):r.lines.splice(u+1,0,t.clone()),g?this.isUserScrolling&&(r.ydisp=Math.max(r.ydisp-1,0)):(r.ybase++,this.isUserScrolling||r.ydisp++)}else{const g=u-o+1;r.lines.shiftElements(o+1,g-1,-1),r.lines.set(u,t.clone())}this.isUserScrolling||(r.ydisp=r.ybase),this._onScroll.fire(r.ydisp)}scrollLines(e,s,r){const t=this.buffer;if(e<0){if(t.ydisp===0)return;this.isUserScrolling=!0}else e+t.ydisp>=t.ybase&&(this.isUserScrolling=!1);const o=t.ydisp;t.ydisp=Math.max(Math.min(t.ydisp+e,t.ybase),0),o!==t.ydisp&&(s||this._onScroll.fire(t.ydisp))}scrollPages(e){this.scrollLines(e*(this.rows-1))}scrollToTop(){this.scrollLines(-this.buffer.ydisp)}scrollToBottom(){this.scrollLines(this.buffer.ybase-this.buffer.ydisp)}scrollToLine(e){const s=e-this.buffer.ydisp;s!==0&&this.scrollLines(s)}};a=_([v(0,c.IOptionsService)],a),i.BufferService=a},7994:(A,i)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.CharsetService=void 0,i.CharsetService=class{constructor(){this.glevel=0,this._charsets=[]}reset(){this.charset=void 0,this._charsets=[],this.glevel=0}setgLevel(l){this.glevel=l,this.charset=this._charsets[l]}setgCharset(l,_){this._charsets[l]=_,this.glevel===l&&(this.charset=_)}}},1753:function(A,i,l){var _=this&&this.__decorate||function(t,o,u,g){var m,h=arguments.length,p=h<3?o:g===null?g=Object.getOwnPropertyDescriptor(o,u):g;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")p=Reflect.decorate(t,o,u,g);else for(var C=t.length-1;C>=0;C--)(m=t[C])&&(p=(h<3?m(p):h>3?m(o,u,p):m(o,u))||p);return h>3&&p&&Object.defineProperty(o,u,p),p},v=this&&this.__param||function(t,o){return function(u,g){o(u,g,t)}};Object.defineProperty(i,"__esModule",{value:!0}),i.CoreMouseService=void 0;const c=l(2585),n=l(8460),f=l(844),d={NONE:{events:0,restrict:()=>!1},X10:{events:1,restrict:t=>t.button!==4&&t.action===1&&(t.ctrl=!1,t.alt=!1,t.shift=!1,!0)},VT200:{events:19,restrict:t=>t.action!==32},DRAG:{events:23,restrict:t=>t.action!==32||t.button!==3},ANY:{events:31,restrict:t=>!0}};function a(t,o){let u=(t.ctrl?16:0)|(t.shift?4:0)|(t.alt?8:0);return t.button===4?(u|=64,u|=t.action):(u|=3&t.button,4&t.button&&(u|=64),8&t.button&&(u|=128),t.action===32?u|=32:t.action!==0||o||(u|=3)),u}const e=String.fromCharCode,s={DEFAULT:t=>{const o=[a(t,!1)+32,t.col+32,t.row+32];return o[0]>255||o[1]>255||o[2]>255?"":`\x1B[M${e(o[0])}${e(o[1])}${e(o[2])}`},SGR:t=>{const o=t.action===0&&t.button!==4?"m":"M";return`\x1B[<${a(t,!0)};${t.col};${t.row}${o}`},SGR_PIXELS:t=>{const o=t.action===0&&t.button!==4?"m":"M";return`\x1B[<${a(t,!0)};${t.x};${t.y}${o}`}};let r=class extends f.Disposable{constructor(t,o){super(),this._bufferService=t,this._coreService=o,this._protocols={},this._encodings={},this._activeProtocol="",this._activeEncoding="",this._lastEvent=null,this._onProtocolChange=this.register(new n.EventEmitter),this.onProtocolChange=this._onProtocolChange.event;for(const u of Object.keys(d))this.addProtocol(u,d[u]);for(const u of Object.keys(s))this.addEncoding(u,s[u]);this.reset()}addProtocol(t,o){this._protocols[t]=o}addEncoding(t,o){this._encodings[t]=o}get activeProtocol(){return this._activeProtocol}get areMouseEventsActive(){return this._protocols[this._activeProtocol].events!==0}set activeProtocol(t){if(!this._protocols[t])throw new Error(`unknown protocol "${t}"`);this._activeProtocol=t,this._onProtocolChange.fire(this._protocols[t].events)}get activeEncoding(){return this._activeEncoding}set activeEncoding(t){if(!this._encodings[t])throw new Error(`unknown encoding "${t}"`);this._activeEncoding=t}reset(){this.activeProtocol="NONE",this.activeEncoding="DEFAULT",this._lastEvent=null}triggerMouseEvent(t){if(t.col<0||t.col>=this._bufferService.cols||t.row<0||t.row>=this._bufferService.rows||t.button===4&&t.action===32||t.button===3&&t.action!==32||t.button!==4&&(t.action===2||t.action===3)||(t.col++,t.row++,t.action===32&&this._lastEvent&&this._equalEvents(this._lastEvent,t,this._activeEncoding==="SGR_PIXELS"))||!this._protocols[this._activeProtocol].restrict(t))return!1;const o=this._encodings[this._activeEncoding](t);return o&&(this._activeEncoding==="DEFAULT"?this._coreService.triggerBinaryEvent(o):this._coreService.triggerDataEvent(o,!0)),this._lastEvent=t,!0}explainEvents(t){return{down:!!(1&t),up:!!(2&t),drag:!!(4&t),move:!!(8&t),wheel:!!(16&t)}}_equalEvents(t,o,u){if(u){if(t.x!==o.x||t.y!==o.y)return!1}else if(t.col!==o.col||t.row!==o.row)return!1;return t.button===o.button&&t.action===o.action&&t.ctrl===o.ctrl&&t.alt===o.alt&&t.shift===o.shift}};r=_([v(0,c.IBufferService),v(1,c.ICoreService)],r),i.CoreMouseService=r},6975:function(A,i,l){var _=this&&this.__decorate||function(r,t,o,u){var g,m=arguments.length,h=m<3?t:u===null?u=Object.getOwnPropertyDescriptor(t,o):u;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")h=Reflect.decorate(r,t,o,u);else for(var p=r.length-1;p>=0;p--)(g=r[p])&&(h=(m<3?g(h):m>3?g(t,o,h):g(t,o))||h);return m>3&&h&&Object.defineProperty(t,o,h),h},v=this&&this.__param||function(r,t){return function(o,u){t(o,u,r)}};Object.defineProperty(i,"__esModule",{value:!0}),i.CoreService=void 0;const c=l(2585),n=l(8460),f=l(1439),d=l(844),a=Object.freeze({insertMode:!1}),e=Object.freeze({applicationCursorKeys:!1,applicationKeypad:!1,bracketedPasteMode:!1,origin:!1,reverseWraparound:!1,sendFocus:!1,wraparound:!0});let s=class extends d.Disposable{constructor(r,t,o){super(),this._bufferService=r,this._logService=t,this._optionsService=o,this.isCursorInitialized=!1,this.isCursorHidden=!1,this._onData=this.register(new n.EventEmitter),this.onData=this._onData.event,this._onUserInput=this.register(new n.EventEmitter),this.onUserInput=this._onUserInput.event,this._onBinary=this.register(new n.EventEmitter),this.onBinary=this._onBinary.event,this._onRequestScrollToBottom=this.register(new n.EventEmitter),this.onRequestScrollToBottom=this._onRequestScrollToBottom.event,this.modes=(0,f.clone)(a),this.decPrivateModes=(0,f.clone)(e)}reset(){this.modes=(0,f.clone)(a),this.decPrivateModes=(0,f.clone)(e)}triggerDataEvent(r,t=!1){if(this._optionsService.rawOptions.disableStdin)return;const o=this._bufferService.buffer;t&&this._optionsService.rawOptions.scrollOnUserInput&&o.ybase!==o.ydisp&&this._onRequestScrollToBottom.fire(),t&&this._onUserInput.fire(),this._logService.debug(`sending data "${r}"`,()=>r.split("").map(u=>u.charCodeAt(0))),this._onData.fire(r)}triggerBinaryEvent(r){this._optionsService.rawOptions.disableStdin||(this._logService.debug(`sending binary "${r}"`,()=>r.split("").map(t=>t.charCodeAt(0))),this._onBinary.fire(r))}};s=_([v(0,c.IBufferService),v(1,c.ILogService),v(2,c.IOptionsService)],s),i.CoreService=s},9074:(A,i,l)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.DecorationService=void 0;const _=l(8055),v=l(8460),c=l(844),n=l(6106);let f=0,d=0;class a extends c.Disposable{constructor(){super(),this._decorations=new n.SortedList(r=>r==null?void 0:r.marker.line),this._onDecorationRegistered=this.register(new v.EventEmitter),this.onDecorationRegistered=this._onDecorationRegistered.event,this._onDecorationRemoved=this.register(new v.EventEmitter),this.onDecorationRemoved=this._onDecorationRemoved.event,this.register((0,c.toDisposable)(()=>{for(const r of this._decorations.values())this._onDecorationRemoved.fire(r);this.reset()}))}get decorations(){return this._decorations.values()}registerDecoration(r){if(r.marker.isDisposed)return;const t=new e(r);if(t){const o=t.marker.onDispose(()=>t.dispose());t.onDispose(()=>{t&&(this._decorations.delete(t)&&this._onDecorationRemoved.fire(t),o.dispose())}),this._decorations.insert(t),this._onDecorationRegistered.fire(t)}return t}reset(){for(const r of this._decorations.values())r.dispose();this._decorations.clear()}*getDecorationsAtCell(r,t,o){var u,g,m;let h=0,p=0;for(const C of this._decorations.getKeyIterator(t))h=(u=C.options.x)!==null&&u!==void 0?u:0,p=h+((g=C.options.width)!==null&&g!==void 0?g:1),r>=h&&r<p&&(!o||((m=C.options.layer)!==null&&m!==void 0?m:"bottom")===o)&&(yield C)}forEachDecorationAtCell(r,t,o,u){this._decorations.forEachByKey(t,g=>{var m,h,p;f=(m=g.options.x)!==null&&m!==void 0?m:0,d=f+((h=g.options.width)!==null&&h!==void 0?h:1),r>=f&&r<d&&(!o||((p=g.options.layer)!==null&&p!==void 0?p:"bottom")===o)&&u(g)})}dispose(){for(const r of this._decorations.values())this._onDecorationRemoved.fire(r);this.reset()}}i.DecorationService=a;class e extends c.Disposable{constructor(r){super(),this.options=r,this.isDisposed=!1,this.onRenderEmitter=this.register(new v.EventEmitter),this.onRender=this.onRenderEmitter.event,this._onDispose=this.register(new v.EventEmitter),this.onDispose=this._onDispose.event,this._cachedBg=null,this._cachedFg=null,this.marker=r.marker,this.options.overviewRulerOptions&&!this.options.overviewRulerOptions.position&&(this.options.overviewRulerOptions.position="full")}get backgroundColorRGB(){return this._cachedBg===null&&(this.options.backgroundColor?this._cachedBg=_.css.toColor(this.options.backgroundColor):this._cachedBg=void 0),this._cachedBg}get foregroundColorRGB(){return this._cachedFg===null&&(this.options.foregroundColor?this._cachedFg=_.css.toColor(this.options.foregroundColor):this._cachedFg=void 0),this._cachedFg}dispose(){this._onDispose.fire(),super.dispose()}}},4348:(A,i,l)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.InstantiationService=i.ServiceCollection=void 0;const _=l(2585),v=l(8343);class c{constructor(...f){this._entries=new Map;for(const[d,a]of f)this.set(d,a)}set(f,d){const a=this._entries.get(f);return this._entries.set(f,d),a}forEach(f){for(const[d,a]of this._entries.entries())f(d,a)}has(f){return this._entries.has(f)}get(f){return this._entries.get(f)}}i.ServiceCollection=c,i.InstantiationService=class{constructor(){this._services=new c,this._services.set(_.IInstantiationService,this)}setService(n,f){this._services.set(n,f)}getService(n){return this._services.get(n)}createInstance(n,...f){const d=(0,v.getServiceDependencies)(n).sort((s,r)=>s.index-r.index),a=[];for(const s of d){const r=this._services.get(s.id);if(!r)throw new Error(`[createInstance] ${n.name} depends on UNKNOWN service ${s.id}.`);a.push(r)}const e=d.length>0?d[0].index:f.length;if(f.length!==e)throw new Error(`[createInstance] First service dependency of ${n.name} at position ${e+1} conflicts with ${f.length} static arguments`);return new n(...f,...a)}}},7866:function(A,i,l){var _=this&&this.__decorate||function(a,e,s,r){var t,o=arguments.length,u=o<3?e:r===null?r=Object.getOwnPropertyDescriptor(e,s):r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")u=Reflect.decorate(a,e,s,r);else for(var g=a.length-1;g>=0;g--)(t=a[g])&&(u=(o<3?t(u):o>3?t(e,s,u):t(e,s))||u);return o>3&&u&&Object.defineProperty(e,s,u),u},v=this&&this.__param||function(a,e){return function(s,r){e(s,r,a)}};Object.defineProperty(i,"__esModule",{value:!0}),i.LogService=void 0;const c=l(844),n=l(2585),f={debug:n.LogLevelEnum.DEBUG,info:n.LogLevelEnum.INFO,warn:n.LogLevelEnum.WARN,error:n.LogLevelEnum.ERROR,off:n.LogLevelEnum.OFF};let d=class extends c.Disposable{constructor(a){super(),this._optionsService=a,this.logLevel=n.LogLevelEnum.OFF,this._updateLogLevel(),this.register(this._optionsService.onSpecificOptionChange("logLevel",()=>this._updateLogLevel()))}_updateLogLevel(){this.logLevel=f[this._optionsService.rawOptions.logLevel]}_evalLazyOptionalParams(a){for(let e=0;e<a.length;e++)typeof a[e]=="function"&&(a[e]=a[e]())}_log(a,e,s){this._evalLazyOptionalParams(s),a.call(console,"xterm.js: "+e,...s)}debug(a,...e){this.logLevel<=n.LogLevelEnum.DEBUG&&this._log(console.log,a,e)}info(a,...e){this.logLevel<=n.LogLevelEnum.INFO&&this._log(console.info,a,e)}warn(a,...e){this.logLevel<=n.LogLevelEnum.WARN&&this._log(console.warn,a,e)}error(a,...e){this.logLevel<=n.LogLevelEnum.ERROR&&this._log(console.error,a,e)}};d=_([v(0,n.IOptionsService)],d),i.LogService=d},7302:(A,i,l)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.OptionsService=i.DEFAULT_OPTIONS=void 0;const _=l(8460),v=l(6114),c=l(844);i.DEFAULT_OPTIONS={cols:80,rows:24,cursorBlink:!1,cursorStyle:"block",cursorWidth:1,customGlyphs:!0,drawBoldTextInBrightColors:!0,fastScrollModifier:"alt",fastScrollSensitivity:5,fontFamily:"courier-new, courier, monospace",fontSize:15,fontWeight:"normal",fontWeightBold:"bold",lineHeight:1,letterSpacing:0,linkHandler:null,logLevel:"info",scrollback:1e3,scrollOnUserInput:!0,scrollSensitivity:1,screenReaderMode:!1,smoothScrollDuration:0,macOptionIsMeta:!1,macOptionClickForcesSelection:!1,minimumContrastRatio:1,disableStdin:!1,allowProposedApi:!1,allowTransparency:!1,tabStopWidth:8,theme:{},rightClickSelectsWord:v.isMac,windowOptions:{},windowsMode:!1,wordSeparator:" ()[]{}',\"`",altClickMovesCursor:!0,convertEol:!1,termName:"xterm",cancelEvents:!1,overviewRulerWidth:0};const n=["normal","bold","100","200","300","400","500","600","700","800","900"];class f extends c.Disposable{constructor(a){super(),this._onOptionChange=this.register(new _.EventEmitter),this.onOptionChange=this._onOptionChange.event;const e=Object.assign({},i.DEFAULT_OPTIONS);for(const s in a)if(s in e)try{const r=a[s];e[s]=this._sanitizeAndValidateOption(s,r)}catch(r){console.error(r)}this.rawOptions=e,this.options=Object.assign({},e),this._setupOptions()}onSpecificOptionChange(a,e){return this.onOptionChange(s=>{s===a&&e(this.rawOptions[a])})}onMultipleOptionChange(a,e){return this.onOptionChange(s=>{a.indexOf(s)!==-1&&e()})}_setupOptions(){const a=s=>{if(!(s in i.DEFAULT_OPTIONS))throw new Error(`No option with key "${s}"`);return this.rawOptions[s]},e=(s,r)=>{if(!(s in i.DEFAULT_OPTIONS))throw new Error(`No option with key "${s}"`);r=this._sanitizeAndValidateOption(s,r),this.rawOptions[s]!==r&&(this.rawOptions[s]=r,this._onOptionChange.fire(s))};for(const s in this.rawOptions){const r={get:a.bind(this,s),set:e.bind(this,s)};Object.defineProperty(this.options,s,r)}}_sanitizeAndValidateOption(a,e){switch(a){case"cursorStyle":if(e||(e=i.DEFAULT_OPTIONS[a]),!function(s){return s==="block"||s==="underline"||s==="bar"}(e))throw new Error(`"${e}" is not a valid value for ${a}`);break;case"wordSeparator":e||(e=i.DEFAULT_OPTIONS[a]);break;case"fontWeight":case"fontWeightBold":if(typeof e=="number"&&1<=e&&e<=1e3)break;e=n.includes(e)?e:i.DEFAULT_OPTIONS[a];break;case"cursorWidth":e=Math.floor(e);case"lineHeight":case"tabStopWidth":if(e<1)throw new Error(`${a} cannot be less than 1, value: ${e}`);break;case"minimumContrastRatio":e=Math.max(1,Math.min(21,Math.round(10*e)/10));break;case"scrollback":if((e=Math.min(e,4294967295))<0)throw new Error(`${a} cannot be less than 0, value: ${e}`);break;case"fastScrollSensitivity":case"scrollSensitivity":if(e<=0)throw new Error(`${a} cannot be less than or equal to 0, value: ${e}`);case"rows":case"cols":if(!e&&e!==0)throw new Error(`${a} must be numeric, value: ${e}`)}return e}}i.OptionsService=f},2660:function(A,i,l){var _=this&&this.__decorate||function(f,d,a,e){var s,r=arguments.length,t=r<3?d:e===null?e=Object.getOwnPropertyDescriptor(d,a):e;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")t=Reflect.decorate(f,d,a,e);else for(var o=f.length-1;o>=0;o--)(s=f[o])&&(t=(r<3?s(t):r>3?s(d,a,t):s(d,a))||t);return r>3&&t&&Object.defineProperty(d,a,t),t},v=this&&this.__param||function(f,d){return function(a,e){d(a,e,f)}};Object.defineProperty(i,"__esModule",{value:!0}),i.OscLinkService=void 0;const c=l(2585);let n=class{constructor(f){this._bufferService=f,this._nextId=1,this._entriesWithId=new Map,this._dataByLinkId=new Map}registerLink(f){const d=this._bufferService.buffer;if(f.id===void 0){const o=d.addMarker(d.ybase+d.y),u={data:f,id:this._nextId++,lines:[o]};return o.onDispose(()=>this._removeMarkerFromLink(u,o)),this._dataByLinkId.set(u.id,u),u.id}const a=f,e=this._getEntryIdKey(a),s=this._entriesWithId.get(e);if(s)return this.addLineToLink(s.id,d.ybase+d.y),s.id;const r=d.addMarker(d.ybase+d.y),t={id:this._nextId++,key:this._getEntryIdKey(a),data:a,lines:[r]};return r.onDispose(()=>this._removeMarkerFromLink(t,r)),this._entriesWithId.set(t.key,t),this._dataByLinkId.set(t.id,t),t.id}addLineToLink(f,d){const a=this._dataByLinkId.get(f);if(a&&a.lines.every(e=>e.line!==d)){const e=this._bufferService.buffer.addMarker(d);a.lines.push(e),e.onDispose(()=>this._removeMarkerFromLink(a,e))}}getLinkData(f){var d;return(d=this._dataByLinkId.get(f))===null||d===void 0?void 0:d.data}_getEntryIdKey(f){return`${f.id};;${f.uri}`}_removeMarkerFromLink(f,d){const a=f.lines.indexOf(d);a!==-1&&(f.lines.splice(a,1),f.lines.length===0&&(f.data.id!==void 0&&this._entriesWithId.delete(f.key),this._dataByLinkId.delete(f.id)))}};n=_([v(0,c.IBufferService)],n),i.OscLinkService=n},8343:(A,i)=>{function l(_,v,c){v.di$target===v?v.di$dependencies.push({id:_,index:c}):(v.di$dependencies=[{id:_,index:c}],v.di$target=v)}Object.defineProperty(i,"__esModule",{value:!0}),i.createDecorator=i.getServiceDependencies=i.serviceRegistry=void 0,i.serviceRegistry=new Map,i.getServiceDependencies=function(_){return _.di$dependencies||[]},i.createDecorator=function(_){if(i.serviceRegistry.has(_))return i.serviceRegistry.get(_);const v=function(c,n,f){if(arguments.length!==3)throw new Error("@IServiceName-decorator can only be used to decorate a parameter");l(v,c,f)};return v.toString=()=>_,i.serviceRegistry.set(_,v),v}},2585:(A,i,l)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.IDecorationService=i.IUnicodeService=i.IOscLinkService=i.IOptionsService=i.ILogService=i.LogLevelEnum=i.IInstantiationService=i.ICharsetService=i.ICoreService=i.ICoreMouseService=i.IBufferService=void 0;const _=l(8343);var v;i.IBufferService=(0,_.createDecorator)("BufferService"),i.ICoreMouseService=(0,_.createDecorator)("CoreMouseService"),i.ICoreService=(0,_.createDecorator)("CoreService"),i.ICharsetService=(0,_.createDecorator)("CharsetService"),i.IInstantiationService=(0,_.createDecorator)("InstantiationService"),(v=i.LogLevelEnum||(i.LogLevelEnum={}))[v.DEBUG=0]="DEBUG",v[v.INFO=1]="INFO",v[v.WARN=2]="WARN",v[v.ERROR=3]="ERROR",v[v.OFF=4]="OFF",i.ILogService=(0,_.createDecorator)("LogService"),i.IOptionsService=(0,_.createDecorator)("OptionsService"),i.IOscLinkService=(0,_.createDecorator)("OscLinkService"),i.IUnicodeService=(0,_.createDecorator)("UnicodeService"),i.IDecorationService=(0,_.createDecorator)("DecorationService")},1480:(A,i,l)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.UnicodeService=void 0;const _=l(8460),v=l(225);i.UnicodeService=class{constructor(){this._providers=Object.create(null),this._active="",this._onChange=new _.EventEmitter,this.onChange=this._onChange.event;const c=new v.UnicodeV6;this.register(c),this._active=c.version,this._activeProvider=c}dispose(){this._onChange.dispose()}get versions(){return Object.keys(this._providers)}get activeVersion(){return this._active}set activeVersion(c){if(!this._providers[c])throw new Error(`unknown Unicode version "${c}"`);this._active=c,this._activeProvider=this._providers[c],this._onChange.fire(c)}register(c){this._providers[c.version]=c}wcwidth(c){return this._activeProvider.wcwidth(c)}getStringCellWidth(c){let n=0;const f=c.length;for(let d=0;d<f;++d){let a=c.charCodeAt(d);if(55296<=a&&a<=56319){if(++d>=f)return n+this.wcwidth(a);const e=c.charCodeAt(d);56320<=e&&e<=57343?a=1024*(a-55296)+e-56320+65536:n+=this.wcwidth(e)}n+=this.wcwidth(a)}return n}}}},j={};function $(A){var i=j[A];if(i!==void 0)return i.exports;var l=j[A]={exports:{}};return K[A].call(l.exports,l,l.exports,$),l.exports}var z={};return(()=>{var A=z;Object.defineProperty(A,"__esModule",{value:!0}),A.Terminal=void 0;const i=$(3236),l=$(9042),_=$(7975),v=$(7090),c=$(5741),n=$(8285),f=["cols","rows"];A.Terminal=class{constructor(d){this._core=new i.Terminal(d),this._addonManager=new c.AddonManager,this._publicOptions=Object.assign({},this._core.options);const a=s=>this._core.options[s],e=(s,r)=>{this._checkReadonlyOptions(s),this._core.options[s]=r};for(const s in this._core.options){const r={get:a.bind(this,s),set:e.bind(this,s)};Object.defineProperty(this._publicOptions,s,r)}}_checkReadonlyOptions(d){if(f.includes(d))throw new Error(`Option "${d}" can only be set in the constructor`)}_checkProposedApi(){if(!this._core.optionsService.rawOptions.allowProposedApi)throw new Error("You must set the allowProposedApi option to true to use proposed API")}get onBell(){return this._core.onBell}get onBinary(){return this._core.onBinary}get onCursorMove(){return this._core.onCursorMove}get onData(){return this._core.onData}get onKey(){return this._core.onKey}get onLineFeed(){return this._core.onLineFeed}get onRender(){return this._core.onRender}get onResize(){return this._core.onResize}get onScroll(){return this._core.onScroll}get onSelectionChange(){return this._core.onSelectionChange}get onTitleChange(){return this._core.onTitleChange}get onWriteParsed(){return this._core.onWriteParsed}get element(){return this._core.element}get parser(){return this._parser||(this._parser=new _.ParserApi(this._core)),this._parser}get unicode(){return this._checkProposedApi(),new v.UnicodeApi(this._core)}get textarea(){return this._core.textarea}get rows(){return this._core.rows}get cols(){return this._core.cols}get buffer(){return this._buffer||(this._buffer=new n.BufferNamespaceApi(this._core)),this._buffer}get markers(){return this._checkProposedApi(),this._core.markers}get modes(){const d=this._core.coreService.decPrivateModes;let a="none";switch(this._core.coreMouseService.activeProtocol){case"X10":a="x10";break;case"VT200":a="vt200";break;case"DRAG":a="drag";break;case"ANY":a="any"}return{applicationCursorKeysMode:d.applicationCursorKeys,applicationKeypadMode:d.applicationKeypad,bracketedPasteMode:d.bracketedPasteMode,insertMode:this._core.coreService.modes.insertMode,mouseTrackingMode:a,originMode:d.origin,reverseWraparoundMode:d.reverseWraparound,sendFocusMode:d.sendFocus,wraparoundMode:d.wraparound}}get options(){return this._publicOptions}set options(d){for(const a in d)this._publicOptions[a]=d[a]}blur(){this._core.blur()}focus(){this._core.focus()}resize(d,a){this._verifyIntegers(d,a),this._core.resize(d,a)}open(d){this._core.open(d)}attachCustomKeyEventHandler(d){this._core.attachCustomKeyEventHandler(d)}registerLinkProvider(d){return this._core.registerLinkProvider(d)}registerCharacterJoiner(d){return this._checkProposedApi(),this._core.registerCharacterJoiner(d)}deregisterCharacterJoiner(d){this._checkProposedApi(),this._core.deregisterCharacterJoiner(d)}registerMarker(d=0){return this._verifyIntegers(d),this._core.addMarker(d)}registerDecoration(d){var a,e,s;return this._checkProposedApi(),this._verifyPositiveIntegers((a=d.x)!==null&&a!==void 0?a:0,(e=d.width)!==null&&e!==void 0?e:0,(s=d.height)!==null&&s!==void 0?s:0),this._core.registerDecoration(d)}hasSelection(){return this._core.hasSelection()}select(d,a,e){this._verifyIntegers(d,a,e),this._core.select(d,a,e)}getSelection(){return this._core.getSelection()}getSelectionPosition(){return this._core.getSelectionPosition()}clearSelection(){this._core.clearSelection()}selectAll(){this._core.selectAll()}selectLines(d,a){this._verifyIntegers(d,a),this._core.selectLines(d,a)}dispose(){this._addonManager.dispose(),this._core.dispose()}scrollLines(d){this._verifyIntegers(d),this._core.scrollLines(d)}scrollPages(d){this._verifyIntegers(d),this._core.scrollPages(d)}scrollToTop(){this._core.scrollToTop()}scrollToBottom(){this._core.scrollToBottom()}scrollToLine(d){this._verifyIntegers(d),this._core.scrollToLine(d)}clear(){this._core.clear()}write(d,a){this._core.write(d,a)}writeln(d,a){this._core.write(d),this._core.write(`\r
`,a)}paste(d){this._core.paste(d)}refresh(d,a){this._verifyIntegers(d,a),this._core.refresh(d,a)}reset(){this._core.reset()}clearTextureAtlas(){this._core.clearTextureAtlas()}loadAddon(d){return this._addonManager.loadAddon(this,d)}static get strings(){return l}_verifyIntegers(...d){for(const a of d)if(a===1/0||isNaN(a)||a%1!=0)throw new Error("This API only accepts integers")}_verifyPositiveIntegers(...d){for(const a of d)if(a&&(a===1/0||isNaN(a)||a%1!=0||a<0))throw new Error("This API only accepts positive integers")}}})(),z})()})})(ee);var fe=ee.exports,ie={exports:{}};(function(J,Z){(function(K,j){J.exports=j()})(self,function(){return(()=>{var K={};return(()=>{var j=K;function $(z,A,i){return z.addEventListener(A,i),{dispose:()=>{i&&z.removeEventListener(A,i)}}}Object.defineProperty(j,"__esModule",{value:!0}),j.AttachAddon=void 0,j.AttachAddon=class{constructor(z,A){this._disposables=[],this._socket=z,this._socket.binaryType="arraybuffer",this._bidirectional=!(A&&A.bidirectional===!1)}activate(z){this._disposables.push($(this._socket,"message",A=>{const i=A.data;z.write(typeof i=="string"?i:new Uint8Array(i))})),this._bidirectional&&(this._disposables.push(z.onData(A=>this._sendData(A))),this._disposables.push(z.onBinary(A=>this._sendBinary(A)))),this._disposables.push($(this._socket,"close",()=>this.dispose())),this._disposables.push($(this._socket,"error",()=>this.dispose()))}dispose(){for(const z of this._disposables)z.dispose()}_sendData(z){this._checkOpenSocket()&&this._socket.send(z)}_sendBinary(z){if(!this._checkOpenSocket())return;const A=new Uint8Array(z.length);for(let i=0;i<z.length;++i)A[i]=255&z.charCodeAt(i);this._socket.send(A)}_checkOpenSocket(){switch(this._socket.readyState){case WebSocket.OPEN:return!0;case WebSocket.CONNECTING:throw new Error("Attach addon was loaded before socket was open");case WebSocket.CLOSING:return console.warn("Attach addon socket is closing"),!1;case WebSocket.CLOSED:throw new Error("Attach addon socket is closed");default:throw new Error("Unexpected socket state")}}}})(),K})()})})(ie);var ve=ie.exports,se={exports:{}};(function(J,Z){(function(K,j){J.exports=j()})(self,function(){return(()=>{var K={};return(()=>{var j=K;Object.defineProperty(j,"__esModule",{value:!0}),j.FitAddon=void 0,j.FitAddon=class{constructor(){}activate($){this._terminal=$}dispose(){}fit(){const $=this.proposeDimensions();if(!$||!this._terminal||isNaN($.cols)||isNaN($.rows))return;const z=this._terminal._core;this._terminal.rows===$.rows&&this._terminal.cols===$.cols||(z._renderService.clear(),this._terminal.resize($.cols,$.rows))}proposeDimensions(){if(!this._terminal||!this._terminal.element||!this._terminal.element.parentElement)return;const $=this._terminal._core,z=$._renderService.dimensions;if(z.css.cell.width===0||z.css.cell.height===0)return;const A=this._terminal.options.scrollback===0?0:$.viewport.scrollBarWidth,i=window.getComputedStyle(this._terminal.element.parentElement),l=parseInt(i.getPropertyValue("height")),_=Math.max(0,parseInt(i.getPropertyValue("width"))),v=window.getComputedStyle(this._terminal.element),c=l-(parseInt(v.getPropertyValue("padding-top"))+parseInt(v.getPropertyValue("padding-bottom"))),n=_-(parseInt(v.getPropertyValue("padding-right"))+parseInt(v.getPropertyValue("padding-left")))-A;return{cols:Math.max(2,Math.floor(n/z.css.cell.width)),rows:Math.max(1,Math.floor(c/z.css.cell.height))}}}})(),K})()})})(se);var ge=se.exports,re={exports:{}};(function(J,Z){(function(K,j){J.exports=j()})(Q,function(){return(()=>{var K={};return(()=>{var j=K;function $(c,n,f){return Math.max(n,Math.min(c,f))}Object.defineProperty(j,"__esModule",{value:!0}),j.HTMLSerializeHandler=j.SerializeAddon=void 0;class z{constructor(n){this._buffer=n}serialize(n){const f=this._buffer.getNullCell(),d=this._buffer.getNullCell();let a=f;const e=n.start.x,s=n.end.x,r=n.start.y,t=n.end.y;this._beforeSerialize(s-e,e,s);for(let o=e;o<=s;o++){const u=this._buffer.getLine(o);if(u){const g=o!==n.start.x?0:r,m=o!==n.end.x?u.length:t;for(let h=g;h<m;h++){const p=u.getCell(h,a===f?d:f);p?(this._nextCell(p,a,o,h),a=p):console.warn(`Can't get cell at row=${o}, col=${h}`)}}this._rowEnd(o,o===s)}return this._afterSerialize(),this._serializeString()}_nextCell(n,f,d,a){}_rowEnd(n,f){}_beforeSerialize(n,f,d){}_afterSerialize(){}_serializeString(){return""}}function A(c,n){return c.getFgColorMode()===n.getFgColorMode()&&c.getFgColor()===n.getFgColor()}function i(c,n){return c.getBgColorMode()===n.getBgColorMode()&&c.getBgColor()===n.getBgColor()}function l(c,n){return c.isInverse()===n.isInverse()&&c.isBold()===n.isBold()&&c.isUnderline()===n.isUnderline()&&c.isBlink()===n.isBlink()&&c.isInvisible()===n.isInvisible()&&c.isItalic()===n.isItalic()&&c.isDim()===n.isDim()&&c.isStrikethrough()===n.isStrikethrough()}class _ extends z{constructor(n,f){super(n),this._terminal=f,this._rowIndex=0,this._allRows=new Array,this._allRowSeparators=new Array,this._currentRow="",this._nullCellCount=0,this._cursorStyle=this._buffer.getNullCell(),this._cursorStyleRow=0,this._cursorStyleCol=0,this._backgroundCell=this._buffer.getNullCell(),this._firstRow=0,this._lastCursorRow=0,this._lastCursorCol=0,this._lastContentCursorRow=0,this._lastContentCursorCol=0,this._thisRowLastChar=this._buffer.getNullCell(),this._thisRowLastSecondChar=this._buffer.getNullCell(),this._nextRowFirstChar=this._buffer.getNullCell()}_beforeSerialize(n,f,d){this._allRows=new Array(n),this._lastContentCursorRow=f,this._lastCursorRow=f,this._firstRow=f}_rowEnd(n,f){var d;this._nullCellCount>0&&!i(this._cursorStyle,this._backgroundCell)&&(this._currentRow+=`\x1B[${this._nullCellCount}X`);let a="";if(!f){n-this._firstRow>=this._terminal.rows&&((d=this._buffer.getLine(this._cursorStyleRow))===null||d===void 0||d.getCell(this._cursorStyleCol,this._backgroundCell));const e=this._buffer.getLine(n),s=this._buffer.getLine(n+1);if(s.isWrapped){a="";const r=e.getCell(e.length-1,this._thisRowLastChar),t=e.getCell(e.length-2,this._thisRowLastSecondChar),o=s.getCell(0,this._nextRowFirstChar),u=o.getWidth()>1;let g=!1;(o.getChars()&&u?this._nullCellCount<=1:this._nullCellCount<=0)&&((r.getChars()||r.getWidth()===0)&&i(r,o)&&(g=!0),u&&(t.getChars()||t.getWidth()===0)&&i(r,o)&&i(t,o)&&(g=!0)),g||(a="-".repeat(this._nullCellCount+1),a+="\x1B[1D\x1B[1X",this._nullCellCount>0&&(a+="\x1B[A",a+=`\x1B[${e.length-this._nullCellCount}C`,a+=`\x1B[${this._nullCellCount}X`,a+=`\x1B[${e.length-this._nullCellCount}D`,a+="\x1B[B"),this._lastContentCursorRow=n+1,this._lastContentCursorCol=0,this._lastCursorRow=n+1,this._lastCursorCol=0)}else a=`\r
`,this._lastCursorRow=n+1,this._lastCursorCol=0}this._allRows[this._rowIndex]=this._currentRow,this._allRowSeparators[this._rowIndex++]=a,this._currentRow="",this._nullCellCount=0}_diffStyle(n,f){const d=[],a=!A(n,f),e=!i(n,f),s=!l(n,f);if(a||e||s)if(n.isAttributeDefault())f.isAttributeDefault()||d.push(0);else{if(a){const r=n.getFgColor();n.isFgRGB()?d.push(38,2,r>>>16&255,r>>>8&255,255&r):n.isFgPalette()?r>=16?d.push(38,5,r):d.push(8&r?90+(7&r):30+(7&r)):d.push(39)}if(e){const r=n.getBgColor();n.isBgRGB()?d.push(48,2,r>>>16&255,r>>>8&255,255&r):n.isBgPalette()?r>=16?d.push(48,5,r):d.push(8&r?100+(7&r):40+(7&r)):d.push(49)}s&&(n.isInverse()!==f.isInverse()&&d.push(n.isInverse()?7:27),n.isBold()!==f.isBold()&&d.push(n.isBold()?1:22),n.isUnderline()!==f.isUnderline()&&d.push(n.isUnderline()?4:24),n.isBlink()!==f.isBlink()&&d.push(n.isBlink()?5:25),n.isInvisible()!==f.isInvisible()&&d.push(n.isInvisible()?8:28),n.isItalic()!==f.isItalic()&&d.push(n.isItalic()?3:23),n.isDim()!==f.isDim()&&d.push(n.isDim()?2:22),n.isStrikethrough()!==f.isStrikethrough()&&d.push(n.isStrikethrough()?9:29))}return d}_nextCell(n,f,d,a){if(n.getWidth()===0)return;const e=n.getChars()==="",s=this._diffStyle(n,this._cursorStyle);if(e?!i(this._cursorStyle,n):s.length>0){this._nullCellCount>0&&(i(this._cursorStyle,this._backgroundCell)||(this._currentRow+=`\x1B[${this._nullCellCount}X`),this._currentRow+=`\x1B[${this._nullCellCount}C`,this._nullCellCount=0),this._lastContentCursorRow=this._lastCursorRow=d,this._lastContentCursorCol=this._lastCursorCol=a,this._currentRow+=`\x1B[${s.join(";")}m`;const r=this._buffer.getLine(d);r!==void 0&&(r.getCell(a,this._cursorStyle),this._cursorStyleRow=d,this._cursorStyleCol=a)}e?this._nullCellCount+=n.getWidth():(this._nullCellCount>0&&(i(this._cursorStyle,this._backgroundCell)||(this._currentRow+=`\x1B[${this._nullCellCount}X`),this._currentRow+=`\x1B[${this._nullCellCount}C`,this._nullCellCount=0),this._currentRow+=n.getChars(),this._lastContentCursorRow=this._lastCursorRow=d,this._lastContentCursorCol=this._lastCursorCol=a+n.getWidth())}_serializeString(){let n=this._allRows.length;this._buffer.length-this._firstRow<=this._terminal.rows&&(n=this._lastContentCursorRow+1-this._firstRow,this._lastCursorCol=this._lastContentCursorCol,this._lastCursorRow=this._lastContentCursorRow);let f="";for(let t=0;t<n;t++)f+=this._allRows[t],t+1<n&&(f+=this._allRowSeparators[t]);const d=this._buffer.baseY+this._buffer.cursorY,a=this._buffer.cursorX;var e;(d!==this._lastCursorRow||a!==this._lastCursorCol)&&((e=d-this._lastCursorRow)>0?f+=`\x1B[${e}B`:e<0&&(f+=`\x1B[${-e}A`),(t=>{t>0?f+=`\x1B[${t}C`:t<0&&(f+=`\x1B[${-t}D`)})(a-this._lastCursorCol));const s=this._terminal._core._inputHandler._curAttrData,r=this._diffStyle(s,this._cursorStyle);return r.length>0&&(f+=`\x1B[${r.join(";")}m`),f}}j.SerializeAddon=class{constructor(){}activate(c){this._terminal=c}_serializeBuffer(c,n,f){const d=n.length,a=new _(n,c),e=f===void 0?d:$(f+c.rows,0,d);return a.serialize({start:{x:d-e,y:0},end:{x:d-1,y:c.cols}})}_serializeBufferAsHTML(c,n){var f,d;const a=c.buffer.active,e=new v(a,c,n);if((f=n.onlySelection)===null||f===void 0||!f){const r=a.length,t=n.scrollback,o=t===void 0?r:$(t+c.rows,0,r);return e.serialize({start:{x:r-o,y:0},end:{x:r-1,y:c.cols}})}const s=(d=this._terminal)===null||d===void 0?void 0:d.getSelectionPosition();return s!==void 0?e.serialize({start:{x:s.start.y,y:s.start.x},end:{x:s.end.y,y:s.end.x}}):""}_serializeModes(c){let n="";const f=c.modes;if(f.applicationCursorKeysMode&&(n+="\x1B[?1h"),f.applicationKeypadMode&&(n+="\x1B[?66h"),f.bracketedPasteMode&&(n+="\x1B[?2004h"),f.insertMode&&(n+="\x1B[4h"),f.originMode&&(n+="\x1B[?6h"),f.reverseWraparoundMode&&(n+="\x1B[?45h"),f.sendFocusMode&&(n+="\x1B[?1004h"),f.wraparoundMode===!1&&(n+="\x1B[?7l"),f.mouseTrackingMode!=="none")switch(f.mouseTrackingMode){case"x10":n+="\x1B[?9h";break;case"vt200":n+="\x1B[?1000h";break;case"drag":n+="\x1B[?1002h";break;case"any":n+="\x1B[?1003h"}return n}serialize(c){if(!this._terminal)throw new Error("Cannot use addon until it has been loaded");let n=this._serializeBuffer(this._terminal,this._terminal.buffer.normal,c==null?void 0:c.scrollback);return c!=null&&c.excludeAltBuffer||this._terminal.buffer.active.type!=="alternate"||(n+=`\x1B[?1049h\x1B[H${this._serializeBuffer(this._terminal,this._terminal.buffer.alternate,void 0)}`),c!=null&&c.excludeModes||(n+=this._serializeModes(this._terminal)),n}serializeAsHTML(c){if(!this._terminal)throw new Error("Cannot use addon until it has been loaded");return this._serializeBufferAsHTML(this._terminal,c||{})}dispose(){}};class v extends z{constructor(n,f,d){super(n),this._terminal=f,this._options=d,this._currentRow="",this._htmlContent="",this._colors=f._core._themeService.colors}_padStart(n,f,d){return f>>=0,d=d??" ",n.length>f?n:((f-=n.length)>d.length&&(d+=d.repeat(f/d.length)),d.slice(0,f)+n)}_beforeSerialize(n,f,d){var a,e,s,r,t;this._htmlContent+="<html><body><!--StartFragment--><pre>";let o="#000000",u="#ffffff";(a=this._options.includeGlobalBackground)!==null&&a!==void 0&&a&&(o=(s=(e=this._terminal.options.theme)===null||e===void 0?void 0:e.foreground)!==null&&s!==void 0?s:"#ffffff",u=(t=(r=this._terminal.options.theme)===null||r===void 0?void 0:r.background)!==null&&t!==void 0?t:"#000000");const g=[];g.push("color: "+o+";"),g.push("background-color: "+u+";"),g.push("font-family: "+this._terminal.options.fontFamily+";"),g.push("font-size: "+this._terminal.options.fontSize+"px;"),this._htmlContent+="<div style='"+g.join(" ")+"'>"}_afterSerialize(){this._htmlContent+="</div>",this._htmlContent+="</pre><!--EndFragment--></body></html>"}_rowEnd(n,f){this._htmlContent+="<div><span>"+this._currentRow+"</span></div>",this._currentRow=""}_getHexColor(n,f){const d=f?n.getFgColor():n.getBgColor();return(f?n.isFgRGB():n.isBgRGB())?[d>>16&255,d>>8&255,255&d].map(a=>this._padStart(a.toString(16),2,"0")).join(""):(f?n.isFgPalette():n.isBgPalette())?this._colors.ansi[d].css:void 0}_diffStyle(n,f){const d=[],a=!A(n,f),e=!i(n,f),s=!l(n,f);if(a||e||s){const r=this._getHexColor(n,!0);r&&d.push("color: "+r+";");const t=this._getHexColor(n,!1);return t&&d.push("background-color: "+t+";"),n.isInverse()&&d.push("color: #000000; background-color: #BFBFBF;"),n.isBold()&&d.push("font-weight: bold;"),n.isUnderline()&&d.push("text-decoration: underline;"),n.isBlink()&&d.push("text-decoration: blink;"),n.isInvisible()&&d.push("visibility: hidden;"),n.isItalic()&&d.push("font-style: italic;"),n.isDim()&&d.push("opacity: 0.5;"),n.isStrikethrough()&&d.push("text-decoration: line-through;"),d}}_nextCell(n,f,d,a){if(n.getWidth()===0)return;const e=n.getChars()==="",s=this._diffStyle(n,f);s&&(this._currentRow+=s.length===0?"</span><span>":"</span><span style='"+s.join(" ")+"'>"),this._currentRow+=e?" ":n.getChars()}_serializeString(){return this._htmlContent}}j.HTMLSerializeHandler=v})(),K})()})})(re);var pe=re.exports,ne={exports:{}};(function(J,Z){(function(K,j){J.exports=j()})(Q,function(){return(()=>{var K={433:(A,i)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.UnicodeV11=void 0;const l=[[768,879],[1155,1161],[1425,1469],[1471,1471],[1473,1474],[1476,1477],[1479,1479],[1536,1541],[1552,1562],[1564,1564],[1611,1631],[1648,1648],[1750,1757],[1759,1764],[1767,1768],[1770,1773],[1807,1807],[1809,1809],[1840,1866],[1958,1968],[2027,2035],[2045,2045],[2070,2073],[2075,2083],[2085,2087],[2089,2093],[2137,2139],[2259,2306],[2362,2362],[2364,2364],[2369,2376],[2381,2381],[2385,2391],[2402,2403],[2433,2433],[2492,2492],[2497,2500],[2509,2509],[2530,2531],[2558,2558],[2561,2562],[2620,2620],[2625,2626],[2631,2632],[2635,2637],[2641,2641],[2672,2673],[2677,2677],[2689,2690],[2748,2748],[2753,2757],[2759,2760],[2765,2765],[2786,2787],[2810,2815],[2817,2817],[2876,2876],[2879,2879],[2881,2884],[2893,2893],[2902,2902],[2914,2915],[2946,2946],[3008,3008],[3021,3021],[3072,3072],[3076,3076],[3134,3136],[3142,3144],[3146,3149],[3157,3158],[3170,3171],[3201,3201],[3260,3260],[3263,3263],[3270,3270],[3276,3277],[3298,3299],[3328,3329],[3387,3388],[3393,3396],[3405,3405],[3426,3427],[3530,3530],[3538,3540],[3542,3542],[3633,3633],[3636,3642],[3655,3662],[3761,3761],[3764,3772],[3784,3789],[3864,3865],[3893,3893],[3895,3895],[3897,3897],[3953,3966],[3968,3972],[3974,3975],[3981,3991],[3993,4028],[4038,4038],[4141,4144],[4146,4151],[4153,4154],[4157,4158],[4184,4185],[4190,4192],[4209,4212],[4226,4226],[4229,4230],[4237,4237],[4253,4253],[4448,4607],[4957,4959],[5906,5908],[5938,5940],[5970,5971],[6002,6003],[6068,6069],[6071,6077],[6086,6086],[6089,6099],[6109,6109],[6155,6158],[6277,6278],[6313,6313],[6432,6434],[6439,6440],[6450,6450],[6457,6459],[6679,6680],[6683,6683],[6742,6742],[6744,6750],[6752,6752],[6754,6754],[6757,6764],[6771,6780],[6783,6783],[6832,6846],[6912,6915],[6964,6964],[6966,6970],[6972,6972],[6978,6978],[7019,7027],[7040,7041],[7074,7077],[7080,7081],[7083,7085],[7142,7142],[7144,7145],[7149,7149],[7151,7153],[7212,7219],[7222,7223],[7376,7378],[7380,7392],[7394,7400],[7405,7405],[7412,7412],[7416,7417],[7616,7673],[7675,7679],[8203,8207],[8234,8238],[8288,8292],[8294,8303],[8400,8432],[11503,11505],[11647,11647],[11744,11775],[12330,12333],[12441,12442],[42607,42610],[42612,42621],[42654,42655],[42736,42737],[43010,43010],[43014,43014],[43019,43019],[43045,43046],[43204,43205],[43232,43249],[43263,43263],[43302,43309],[43335,43345],[43392,43394],[43443,43443],[43446,43449],[43452,43453],[43493,43493],[43561,43566],[43569,43570],[43573,43574],[43587,43587],[43596,43596],[43644,43644],[43696,43696],[43698,43700],[43703,43704],[43710,43711],[43713,43713],[43756,43757],[43766,43766],[44005,44005],[44008,44008],[44013,44013],[64286,64286],[65024,65039],[65056,65071],[65279,65279],[65529,65531]],_=[[66045,66045],[66272,66272],[66422,66426],[68097,68099],[68101,68102],[68108,68111],[68152,68154],[68159,68159],[68325,68326],[68900,68903],[69446,69456],[69633,69633],[69688,69702],[69759,69761],[69811,69814],[69817,69818],[69821,69821],[69837,69837],[69888,69890],[69927,69931],[69933,69940],[70003,70003],[70016,70017],[70070,70078],[70089,70092],[70191,70193],[70196,70196],[70198,70199],[70206,70206],[70367,70367],[70371,70378],[70400,70401],[70459,70460],[70464,70464],[70502,70508],[70512,70516],[70712,70719],[70722,70724],[70726,70726],[70750,70750],[70835,70840],[70842,70842],[70847,70848],[70850,70851],[71090,71093],[71100,71101],[71103,71104],[71132,71133],[71219,71226],[71229,71229],[71231,71232],[71339,71339],[71341,71341],[71344,71349],[71351,71351],[71453,71455],[71458,71461],[71463,71467],[71727,71735],[71737,71738],[72148,72151],[72154,72155],[72160,72160],[72193,72202],[72243,72248],[72251,72254],[72263,72263],[72273,72278],[72281,72283],[72330,72342],[72344,72345],[72752,72758],[72760,72765],[72767,72767],[72850,72871],[72874,72880],[72882,72883],[72885,72886],[73009,73014],[73018,73018],[73020,73021],[73023,73029],[73031,73031],[73104,73105],[73109,73109],[73111,73111],[73459,73460],[78896,78904],[92912,92916],[92976,92982],[94031,94031],[94095,94098],[113821,113822],[113824,113827],[119143,119145],[119155,119170],[119173,119179],[119210,119213],[119362,119364],[121344,121398],[121403,121452],[121461,121461],[121476,121476],[121499,121503],[121505,121519],[122880,122886],[122888,122904],[122907,122913],[122915,122916],[122918,122922],[123184,123190],[123628,123631],[125136,125142],[125252,125258],[917505,917505],[917536,917631],[917760,917999]],v=[[4352,4447],[8986,8987],[9001,9002],[9193,9196],[9200,9200],[9203,9203],[9725,9726],[9748,9749],[9800,9811],[9855,9855],[9875,9875],[9889,9889],[9898,9899],[9917,9918],[9924,9925],[9934,9934],[9940,9940],[9962,9962],[9970,9971],[9973,9973],[9978,9978],[9981,9981],[9989,9989],[9994,9995],[10024,10024],[10060,10060],[10062,10062],[10067,10069],[10071,10071],[10133,10135],[10160,10160],[10175,10175],[11035,11036],[11088,11088],[11093,11093],[11904,11929],[11931,12019],[12032,12245],[12272,12283],[12288,12329],[12334,12350],[12353,12438],[12443,12543],[12549,12591],[12593,12686],[12688,12730],[12736,12771],[12784,12830],[12832,12871],[12880,19903],[19968,42124],[42128,42182],[43360,43388],[44032,55203],[63744,64255],[65040,65049],[65072,65106],[65108,65126],[65128,65131],[65281,65376],[65504,65510]],c=[[94176,94179],[94208,100343],[100352,101106],[110592,110878],[110928,110930],[110948,110951],[110960,111355],[126980,126980],[127183,127183],[127374,127374],[127377,127386],[127488,127490],[127504,127547],[127552,127560],[127568,127569],[127584,127589],[127744,127776],[127789,127797],[127799,127868],[127870,127891],[127904,127946],[127951,127955],[127968,127984],[127988,127988],[127992,128062],[128064,128064],[128066,128252],[128255,128317],[128331,128334],[128336,128359],[128378,128378],[128405,128406],[128420,128420],[128507,128591],[128640,128709],[128716,128716],[128720,128722],[128725,128725],[128747,128748],[128756,128762],[128992,129003],[129293,129393],[129395,129398],[129402,129442],[129445,129450],[129454,129482],[129485,129535],[129648,129651],[129656,129658],[129664,129666],[129680,129685],[131072,196605],[196608,262141]];let n;function f(d,a){let e,s=0,r=a.length-1;if(d<a[0][0]||d>a[r][1])return!1;for(;r>=s;)if(e=s+r>>1,d>a[e][1])s=e+1;else{if(!(d<a[e][0]))return!0;r=e-1}return!1}i.UnicodeV11=class{constructor(){if(this.version="11",!n){n=new Uint8Array(65536),n.fill(1),n[0]=0,n.fill(0,1,32),n.fill(0,127,160);for(let d=0;d<l.length;++d)n.fill(0,l[d][0],l[d][1]+1);for(let d=0;d<v.length;++d)n.fill(2,v[d][0],v[d][1]+1)}}wcwidth(d){return d<32?0:d<127?1:d<65536?n[d]:f(d,_)?0:f(d,c)?2:1}}}},j={};function $(A){var i=j[A];if(i!==void 0)return i.exports;var l=j[A]={exports:{}};return K[A](l,l.exports,$),l.exports}var z={};return(()=>{var A=z;Object.defineProperty(A,"__esModule",{value:!0}),A.Unicode11Addon=void 0;const i=$(433);A.Unicode11Addon=class{activate(l){l.unicode.register(new i.UnicodeV11)}dispose(){}}})(),z})()})})(ne);var Se=ne.exports,oe={exports:{}};(function(J,Z){(function(K,j){J.exports=j()})(self,function(){return(()=>{var K={6:(A,i)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.LinkComputer=i.WebLinkProvider=void 0,i.WebLinkProvider=class{constructor(_,v,c,n={}){this._terminal=_,this._regex=v,this._handler=c,this._options=n}provideLinks(_,v){const c=l.computeLink(_,this._regex,this._terminal,this._handler);v(this._addCallbacks(c))}_addCallbacks(_){return _.map(v=>(v.leave=this._options.leave,v.hover=(c,n)=>{if(this._options.hover){const{range:f}=v;this._options.hover(c,n,f)}},v))}};class l{static computeLink(v,c,n,f){const d=new RegExp(c.source,(c.flags||"")+"g"),[a,e]=l._getWindowedLineStrings(v-1,n),s=a.join("");let r;const t=[];for(;r=d.exec(s);){const o=r[0];try{const C=new URL(o),w=decodeURI(C.toString());if(o!==w&&o+"/"!==w)continue}catch{continue}const[u,g]=l._mapStrIdx(n,e,0,r.index),[m,h]=l._mapStrIdx(n,u,g,o.length);if(u===-1||g===-1||m===-1||h===-1)continue;const p={start:{x:g+1,y:u+1},end:{x:h,y:m+1}};t.push({range:p,text:o,activate:f})}return t}static _getWindowedLineStrings(v,c){let n,f=v,d=v,a=0,e="";const s=[];if(n=c.buffer.active.getLine(v)){const r=n.translateToString(!0);if(n.isWrapped&&r[0]!==" "){for(a=0;(n=c.buffer.active.getLine(--f))&&a<2048&&(e=n.translateToString(!0),a+=e.length,s.push(e),n.isWrapped&&e.indexOf(" ")===-1););s.reverse()}for(s.push(r),a=0;(n=c.buffer.active.getLine(++d))&&n.isWrapped&&a<2048&&(e=n.translateToString(!0),a+=e.length,s.push(e),e.indexOf(" ")===-1););}return[s,f]}static _mapStrIdx(v,c,n,f){const d=v.buffer.active,a=d.getNullCell();let e=n;for(;f;){const s=d.getLine(c);if(!s)return[-1,-1];for(let r=e;r<s.length;++r){s.getCell(r,a);const t=a.getChars();if(a.getWidth()&&(f-=t.length||1,r===s.length-1&&t==="")){const o=d.getLine(c+1);o&&o.isWrapped&&(o.getCell(0,a),a.getWidth()===2&&(f+=1))}if(f<0)return[c,r]}c++,e=0}return[c,e]}}i.LinkComputer=l}},j={};function $(A){var i=j[A];if(i!==void 0)return i.exports;var l=j[A]={exports:{}};return K[A](l,l.exports,$),l.exports}var z={};return(()=>{var A=z;Object.defineProperty(A,"__esModule",{value:!0}),A.WebLinksAddon=void 0;const i=$(6),l=/https?:[/]{2}[^\s"'!*(){}|\\\^<>`]*[^\s"':,.!?{}|\\\^~\[\]`()<>]/;function _(v,c){const n=window.open();if(n){try{n.opener=null}catch{}n.location.href=c}else console.warn("Opening link blocked as opener could not be cleared")}A.WebLinksAddon=class{constructor(v=_,c={}){this._handler=v,this._options=c}activate(v){this._terminal=v;const c=this._options,n=c.urlRegex||l;this._linkProvider=this._terminal.registerLinkProvider(new i.WebLinkProvider(this._terminal,n,this._handler,c))}dispose(){var v;(v=this._linkProvider)===null||v===void 0||v.dispose()}}})(),z})()})})(oe);var me=oe.exports;const Ce={class:"h-full w-full bg",id:"terminal"},be={__name:"Terminal",props:{type:String,uri:String,method:String},setup(J){const Z=J;le();const K=new fe.Terminal({screenKeys:!0,useStyle:!0,cursorBlink:!0,fontFamily:"monospace",fullscreenWin:!0,maximizeWin:!0,screenReaderMode:!0,fontSize:14,allowProposedApi:!0}),j=new ge.FitAddon;let $=null;const z=()=>{const i=new ve.AttachAddon($),l=new pe.SerializeAddon,_=new Se.Unicode11Addon,v=new me.WebLinksAddon;K.loadAddon(i),K.loadAddon(j),K.loadAddon(l),K.loadAddon(_),K.loadAddon(v),K.open(document.getElementById("terminal")),j.fit(),K.focus()};return ce(()=>{const i=`ws://${window.location.hostname}:${window.location.port}${Z.uri}`;$=new WebSocket(i),$.onopen=()=>{z()},$.onclose=()=>{K&&K.dispose(),console.log("close socket")},$.onerror=l=>{K&&K.dispose(),console.log("socket err: ",l)}}),de(()=>{$||$.close(),K.dispose()}),(i,l)=>(_e(),ue("div",Ce))}},Ee=he(be,[["__scopeId","data-v-73d55da8"]]);export{Ee as T};
